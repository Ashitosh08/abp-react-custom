{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _objectSpread = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nvar _objectWithoutProperties = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectWithoutProperties.js\").default;\nvar _asyncToGenerator = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nvar _toConsumableArray = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray.js\").default;\nvar _wrapNativeSuper = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/wrapNativeSuper.js\").default;\nvar _assertThisInitialized = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/assertThisInitialized.js\").default;\nvar _inherits = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits.js\").default;\nvar _createSuper = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper.js\").default;\nvar _get = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get.js\").default;\nvar _getPrototypeOf = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf.js\").default;\nvar _slicedToArray = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nvar _objectDestructuringEmpty = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectDestructuringEmpty.js\").default;\nvar _classCallCheck = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar _createForOfIteratorHelper = require(\"C:/Users/Ashitosh Kamble/Downloads/l76s5x/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\nvar _excluded = [\"timeoutInSeconds\"],\n  _excluded2 = [\"grant_type\", \"redirect_uri\", \"client_id\", \"client_secret\"],\n  _excluded3 = [\"grant_type\", \"client_id\", \"client_secret\", \"scope\"],\n  _excluded4 = [\"grant_type\", \"client_id\", \"client_secret\", \"timeoutInSeconds\"],\n  _excluded5 = [\"url\", \"authority\", \"client_id\", \"redirect_uri\", \"response_type\", \"scope\", \"state_data\", \"response_mode\", \"request_type\", \"client_secret\", \"nonce\", \"resource\", \"skipUserInfo\", \"extraQueryParams\", \"extraTokenParams\"],\n  _excluded6 = [\"redirectMethod\"],\n  _excluded7 = [\"popupWindowFeatures\", \"popupWindowTarget\"],\n  _excluded8 = [\"silentRequestTimeoutInSeconds\"],\n  _excluded9 = [\"silentRequestTimeoutInSeconds\"],\n  _excluded10 = [\"redirectMethod\"],\n  _excluded11 = [\"popupWindowFeatures\", \"popupWindowTarget\"],\n  _excluded12 = [\"silentRequestTimeoutInSeconds\"];\nvar __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = function __export(target, all) {\n  for (var name in all) __defProp(target, name, {\n    get: all[name],\n    enumerable: true\n  });\n};\nvar __copyProps = function __copyProps(to, from, except, desc) {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    var _iterator = _createForOfIteratorHelper(__getOwnPropNames(from)),\n      _step;\n    try {\n      var _loop = function _loop() {\n        var key = _step.value;\n        if (!__hasOwnProp.call(to, key) && key !== except) __defProp(to, key, {\n          get: function get() {\n            return from[key];\n          },\n          enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable\n        });\n      };\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        _loop();\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }\n  return to;\n};\nvar __toESM = function __toESM(mod, isNodeMode, target) {\n  return target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(\n  // If the importer is in node compatibility mode or this is not an ESM\n  // file that has been converted to a CommonJS file using a Babel-\n  // compatible transform (i.e. \"__esModule\" has not been set), then set\n  // \"default\" to the CommonJS \"module.exports\" for node compatibility.\n  isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", {\n    value: mod,\n    enumerable: true\n  }) : target, mod);\n};\nvar __toCommonJS = function __toCommonJS(mod) {\n  return __copyProps(__defProp({}, \"__esModule\", {\n    value: true\n  }), mod);\n};\n\n// src/index.ts\nvar src_exports = {};\n__export(src_exports, {\n  AccessTokenEvents: function AccessTokenEvents() {\n    return _AccessTokenEvents;\n  },\n  CheckSessionIFrame: function CheckSessionIFrame() {\n    return _CheckSessionIFrame;\n  },\n  ErrorResponse: function ErrorResponse() {\n    return _ErrorResponse;\n  },\n  ErrorTimeout: function ErrorTimeout() {\n    return _ErrorTimeout;\n  },\n  InMemoryWebStorage: function InMemoryWebStorage() {\n    return _InMemoryWebStorage;\n  },\n  Log: function Log() {\n    return _Log;\n  },\n  Logger: function Logger() {\n    return _Logger;\n  },\n  MetadataService: function MetadataService() {\n    return _MetadataService;\n  },\n  OidcClient: function OidcClient() {\n    return _OidcClient;\n  },\n  OidcClientSettingsStore: function OidcClientSettingsStore() {\n    return _OidcClientSettingsStore;\n  },\n  SessionMonitor: function SessionMonitor() {\n    return _SessionMonitor;\n  },\n  SigninResponse: function SigninResponse() {\n    return _SigninResponse;\n  },\n  SigninState: function SigninState() {\n    return _SigninState;\n  },\n  SignoutResponse: function SignoutResponse() {\n    return _SignoutResponse;\n  },\n  State: function State() {\n    return _State;\n  },\n  User: function User() {\n    return _User;\n  },\n  UserManager: function UserManager() {\n    return _UserManager;\n  },\n  UserManagerSettingsStore: function UserManagerSettingsStore() {\n    return _UserManagerSettingsStore;\n  },\n  Version: function Version() {\n    return _Version;\n  },\n  WebStorageStateStore: function WebStorageStateStore() {\n    return _WebStorageStateStore;\n  }\n});\nmodule.exports = __toCommonJS(src_exports);\n\n// src/utils/CryptoUtils.ts\nvar import_core = __toESM(require(\"crypto-js/core.js\"));\nvar import_sha256 = __toESM(require(\"crypto-js/sha256.js\"));\nvar import_enc_base64 = __toESM(require(\"crypto-js/enc-base64.js\"));\nvar import_enc_utf8 = __toESM(require(\"crypto-js/enc-utf8.js\"));\n\n// src/utils/Logger.ts\nvar nopLogger = {\n  debug: function debug() {\n    return void 0;\n  },\n  info: function info() {\n    return void 0;\n  },\n  warn: function warn() {\n    return void 0;\n  },\n  error: function error() {\n    return void 0;\n  }\n};\nvar level;\nvar logger;\nvar _Log = /* @__PURE__ */function (Log2) {\n  Log2[Log2[\"NONE\"] = 0] = \"NONE\";\n  Log2[Log2[\"ERROR\"] = 1] = \"ERROR\";\n  Log2[Log2[\"WARN\"] = 2] = \"WARN\";\n  Log2[Log2[\"INFO\"] = 3] = \"INFO\";\n  Log2[Log2[\"DEBUG\"] = 4] = \"DEBUG\";\n  return Log2;\n}(_Log || {});\n(function (Log2) {\n  function reset() {\n    level = 3 /* INFO */;\n    logger = nopLogger;\n  }\n  Log2.reset = reset;\n  function setLevel(value) {\n    if (!(0 /* NONE */ <= value && value <= 4 /* DEBUG */)) {\n      throw new Error(\"Invalid log level\");\n    }\n    level = value;\n  }\n  Log2.setLevel = setLevel;\n  function setLogger(value) {\n    logger = value;\n  }\n  Log2.setLogger = setLogger;\n})(_Log || (_Log = {}));\nvar _Logger = /*#__PURE__*/function () {\n  function _Logger(_name) {\n    _classCallCheck(this, _Logger);\n    this._name = _name;\n  }\n  _createClass(_Logger, [{\n    key: \"debug\",\n    value: function debug() {\n      if (level >= 4 /* DEBUG */) {\n        var _logger;\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n        (_logger = logger).debug.apply(_logger, [_Logger._format(this._name, this._method)].concat(args));\n      }\n    }\n  }, {\n    key: \"info\",\n    value: function info() {\n      if (level >= 3 /* INFO */) {\n        var _logger2;\n        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          args[_key2] = arguments[_key2];\n        }\n        (_logger2 = logger).info.apply(_logger2, [_Logger._format(this._name, this._method)].concat(args));\n      }\n    }\n  }, {\n    key: \"warn\",\n    value: function warn() {\n      if (level >= 2 /* WARN */) {\n        var _logger3;\n        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n          args[_key3] = arguments[_key3];\n        }\n        (_logger3 = logger).warn.apply(_logger3, [_Logger._format(this._name, this._method)].concat(args));\n      }\n    }\n  }, {\n    key: \"error\",\n    value: function error() {\n      if (level >= 1 /* ERROR */) {\n        var _logger4;\n        for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n          args[_key4] = arguments[_key4];\n        }\n        (_logger4 = logger).error.apply(_logger4, [_Logger._format(this._name, this._method)].concat(args));\n      }\n    }\n  }, {\n    key: \"throw\",\n    value: function _throw(err) {\n      this.error(err);\n      throw err;\n    }\n  }, {\n    key: \"create\",\n    value: function create(method) {\n      var methodLogger = Object.create(this);\n      methodLogger._method = method;\n      methodLogger.debug(\"begin\");\n      return methodLogger;\n    }\n  }], [{\n    key: \"createStatic\",\n    value: function createStatic(name, staticMethod) {\n      var staticLogger = new _Logger(\"\".concat(name, \".\").concat(staticMethod));\n      staticLogger.debug(\"begin\");\n      return staticLogger;\n    }\n  }, {\n    key: \"_format\",\n    value: function _format(name, method) {\n      var prefix = \"[\".concat(name, \"]\");\n      return method ? \"\".concat(prefix, \" \").concat(method, \":\") : prefix;\n    }\n    // helpers for static class methods\n  }, {\n    key: \"debug\",\n    value: function debug(name) {\n      if (level >= 4 /* DEBUG */) {\n        var _logger5;\n        for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n          args[_key5 - 1] = arguments[_key5];\n        }\n        (_logger5 = logger).debug.apply(_logger5, [_Logger._format(name)].concat(args));\n      }\n    }\n  }, {\n    key: \"info\",\n    value: function info(name) {\n      if (level >= 3 /* INFO */) {\n        var _logger6;\n        for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n          args[_key6 - 1] = arguments[_key6];\n        }\n        (_logger6 = logger).info.apply(_logger6, [_Logger._format(name)].concat(args));\n      }\n    }\n  }, {\n    key: \"warn\",\n    value: function warn(name) {\n      if (level >= 2 /* WARN */) {\n        var _logger7;\n        for (var _len7 = arguments.length, args = new Array(_len7 > 1 ? _len7 - 1 : 0), _key7 = 1; _key7 < _len7; _key7++) {\n          args[_key7 - 1] = arguments[_key7];\n        }\n        (_logger7 = logger).warn.apply(_logger7, [_Logger._format(name)].concat(args));\n      }\n    }\n  }, {\n    key: \"error\",\n    value: function error(name) {\n      if (level >= 1 /* ERROR */) {\n        var _logger8;\n        for (var _len8 = arguments.length, args = new Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {\n          args[_key8 - 1] = arguments[_key8];\n        }\n        (_logger8 = logger).error.apply(_logger8, [_Logger._format(name)].concat(args));\n      }\n    }\n  }]);\n  return _Logger;\n}();\n_Log.reset();\n\n// src/utils/CryptoUtils.ts\nvar UUID_V4_TEMPLATE = \"10000000-1000-4000-8000-100000000000\";\nvar CryptoUtils = /*#__PURE__*/function () {\n  function CryptoUtils() {\n    _classCallCheck(this, CryptoUtils);\n  }\n  _createClass(CryptoUtils, null, [{\n    key: \"_randomWord\",\n    value: function _randomWord() {\n      return import_core.default.lib.WordArray.random(1).words[0];\n    }\n    /**\n     * Generates RFC4122 version 4 guid\n     */\n  }, {\n    key: \"generateUUIDv4\",\n    value: function generateUUIDv4() {\n      var uuid = UUID_V4_TEMPLATE.replace(/[018]/g, function (c) {\n        return (+c ^ CryptoUtils._randomWord() & 15 >> +c / 4).toString(16);\n      });\n      return uuid.replace(/-/g, \"\");\n    }\n    /**\n     * PKCE: Generate a code verifier\n     */\n  }, {\n    key: \"generateCodeVerifier\",\n    value: function generateCodeVerifier() {\n      return CryptoUtils.generateUUIDv4() + CryptoUtils.generateUUIDv4() + CryptoUtils.generateUUIDv4();\n    }\n    /**\n     * PKCE: Generate a code challenge\n     */\n  }, {\n    key: \"generateCodeChallenge\",\n    value: function generateCodeChallenge(code_verifier) {\n      try {\n        var hashed = (0, import_sha256.default)(code_verifier);\n        return import_enc_base64.default.stringify(hashed).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n      } catch (err) {\n        _Logger.error(\"CryptoUtils.generateCodeChallenge\", err);\n        throw err;\n      }\n    }\n    /**\n     * Generates a base64-encoded string for a basic auth header\n     */\n  }, {\n    key: \"generateBasicAuth\",\n    value: function generateBasicAuth(client_id, client_secret) {\n      var basicAuth = import_enc_utf8.default.parse([client_id, client_secret].join(\":\"));\n      return import_enc_base64.default.stringify(basicAuth);\n    }\n  }]);\n  return CryptoUtils;\n}();\n\n// src/utils/Event.ts\nvar Event = /*#__PURE__*/function () {\n  function Event(_name) {\n    _classCallCheck(this, Event);\n    this._name = _name;\n    this._logger = new _Logger(\"Event('\".concat(this._name, \"')\"));\n    this._callbacks = [];\n  }\n  _createClass(Event, [{\n    key: \"addHandler\",\n    value: function addHandler(cb) {\n      var _this = this;\n      this._callbacks.push(cb);\n      return function () {\n        return _this.removeHandler(cb);\n      };\n    }\n  }, {\n    key: \"removeHandler\",\n    value: function removeHandler(cb) {\n      var idx = this._callbacks.lastIndexOf(cb);\n      if (idx >= 0) {\n        this._callbacks.splice(idx, 1);\n      }\n    }\n  }, {\n    key: \"raise\",\n    value: function raise() {\n      var _this$_logger;\n      for (var _len9 = arguments.length, ev = new Array(_len9), _key9 = 0; _key9 < _len9; _key9++) {\n        ev[_key9] = arguments[_key9];\n      }\n      (_this$_logger = this._logger).debug.apply(_this$_logger, [\"raise:\"].concat(ev));\n      var _iterator2 = _createForOfIteratorHelper(this._callbacks),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var cb = _step2.value;\n          void cb.apply(void 0, ev);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    }\n  }]);\n  return Event;\n}();\n\n// src/utils/JwtUtils.ts\nvar import_jwt_decode = __toESM(require(\"jwt-decode\"));\nvar JwtUtils = /*#__PURE__*/function () {\n  function JwtUtils() {\n    _classCallCheck(this, JwtUtils);\n  }\n  _createClass(JwtUtils, null, [{\n    key: \"decode\",\n    value:\n    // IMPORTANT: doesn't validate the token\n    function decode(token) {\n      try {\n        return (0, import_jwt_decode.default)(token);\n      } catch (err) {\n        _Logger.error(\"JwtUtils.decode\", err);\n        throw err;\n      }\n    }\n  }]);\n  return JwtUtils;\n}();\n\n// src/utils/PopupUtils.ts\nvar PopupUtils = /*#__PURE__*/function () {\n  function PopupUtils() {\n    _classCallCheck(this, PopupUtils);\n  }\n  _createClass(PopupUtils, null, [{\n    key: \"center\",\n    value:\n    /**\n     * Populates a map of window features with a placement centered in front of\n     * the current window. If no explicit width is given, a default value is\n     * binned into [800, 720, 600, 480, 360] based on the current window's width.\n     */\n    function center(_ref) {\n      var features = Object.assign({}, (_objectDestructuringEmpty(_ref), _ref));\n      var _a, _b, _c;\n      if (features.width == null) features.width = (_a = [800, 720, 600, 480].find(function (width) {\n        return width <= window.outerWidth / 1.618;\n      })) != null ? _a : 360;\n      (_b = features.left) != null ? _b : features.left = Math.max(0, Math.round(window.screenX + (window.outerWidth - features.width) / 2));\n      if (features.height != null) (_c = features.top) != null ? _c : features.top = Math.max(0, Math.round(window.screenY + (window.outerHeight - features.height) / 2));\n      return features;\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize(features) {\n      return Object.entries(features).filter(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n          value = _ref3[1];\n        return value != null;\n      }).map(function (_ref4) {\n        var _ref5 = _slicedToArray(_ref4, 2),\n          key = _ref5[0],\n          value = _ref5[1];\n        return \"\".concat(key, \"=\").concat(typeof value !== \"boolean\" ? value : value ? \"yes\" : \"no\");\n      }).join(\",\");\n    }\n  }]);\n  return PopupUtils;\n}();\n\n// src/utils/Timer.ts\nvar Timer = /*#__PURE__*/function (_Event) {\n  _inherits(Timer, _Event);\n  var _super = _createSuper(Timer);\n  function Timer() {\n    var _thisSuper, _this2;\n    _classCallCheck(this, Timer);\n    _this2 = _super.apply(this, arguments);\n    _this2._logger = new _Logger(\"Timer('\".concat(_this2._name, \"')\"));\n    _this2._timerHandle = null;\n    _this2._expiration = 0;\n    _this2._callback = function () {\n      var diff = _this2._expiration - Timer.getEpochTime();\n      _this2._logger.debug(\"timer completes in\", diff);\n      if (_this2._expiration <= Timer.getEpochTime()) {\n        _this2.cancel();\n        _get((_thisSuper = _assertThisInitialized(_this2), _getPrototypeOf(Timer.prototype)), \"raise\", _thisSuper).call(_thisSuper);\n      }\n    };\n    return _this2;\n  }\n  // get the time\n  _createClass(Timer, [{\n    key: \"init\",\n    value: function init(durationInSeconds) {\n      var logger2 = this._logger.create(\"init\");\n      durationInSeconds = Math.max(Math.floor(durationInSeconds), 1);\n      var expiration = Timer.getEpochTime() + durationInSeconds;\n      if (this.expiration === expiration && this._timerHandle) {\n        logger2.debug(\"skipping since already initialized for expiration at\", this.expiration);\n        return;\n      }\n      this.cancel();\n      logger2.debug(\"using duration\", durationInSeconds);\n      this._expiration = expiration;\n      var timerDurationInSeconds = Math.min(durationInSeconds, 5);\n      this._timerHandle = setInterval(this._callback, timerDurationInSeconds * 1e3);\n    }\n  }, {\n    key: \"expiration\",\n    get: function get() {\n      return this._expiration;\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      this._logger.create(\"cancel\");\n      if (this._timerHandle) {\n        clearInterval(this._timerHandle);\n        this._timerHandle = null;\n      }\n    }\n  }], [{\n    key: \"getEpochTime\",\n    value: function getEpochTime() {\n      return Math.floor(Date.now() / 1e3);\n    }\n  }]);\n  return Timer;\n}(Event);\n\n// src/utils/UrlUtils.ts\nvar UrlUtils = /*#__PURE__*/function () {\n  function UrlUtils() {\n    _classCallCheck(this, UrlUtils);\n  }\n  _createClass(UrlUtils, null, [{\n    key: \"readParams\",\n    value: function readParams(url) {\n      var responseMode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"query\";\n      if (!url) throw new TypeError(\"Invalid URL\");\n      var parsedUrl = new URL(url, window.location.origin);\n      var params = parsedUrl[responseMode === \"fragment\" ? \"hash\" : \"search\"];\n      return new URLSearchParams(params.slice(1));\n    }\n  }]);\n  return UrlUtils;\n}();\n\n// src/errors/ErrorResponse.ts\nvar _ErrorResponse = /*#__PURE__*/function (_Error) {\n  _inherits(_ErrorResponse, _Error);\n  var _super2 = _createSuper(_ErrorResponse);\n  function _ErrorResponse(args, form) {\n    var _this3;\n    _classCallCheck(this, _ErrorResponse);\n    var _a, _b, _c;\n    _this3 = _super2.call(this, args.error_description || args.error || \"\");\n    _this3.form = form;\n    /** Marker to detect class: \"ErrorResponse\" */\n    _this3.name = \"ErrorResponse\";\n    if (!args.error) {\n      _Logger.error(\"ErrorResponse\", \"No error passed\");\n      throw new Error(\"No error passed\");\n    }\n    _this3.error = args.error;\n    _this3.error_description = (_a = args.error_description) != null ? _a : null;\n    _this3.error_uri = (_b = args.error_uri) != null ? _b : null;\n    _this3.state = args.userState;\n    _this3.session_state = (_c = args.session_state) != null ? _c : null;\n    return _this3;\n  }\n  return _createClass(_ErrorResponse);\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\n// src/errors/ErrorTimeout.ts\nvar _ErrorTimeout = /*#__PURE__*/function (_Error2) {\n  _inherits(_ErrorTimeout, _Error2);\n  var _super3 = _createSuper(_ErrorTimeout);\n  function _ErrorTimeout(message) {\n    var _this4;\n    _classCallCheck(this, _ErrorTimeout);\n    _this4 = _super3.call(this, message);\n    /** Marker to detect class: \"ErrorTimeout\" */\n    _this4.name = \"ErrorTimeout\";\n    return _this4;\n  }\n  return _createClass(_ErrorTimeout);\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\n// src/AccessTokenEvents.ts\nvar _AccessTokenEvents = /*#__PURE__*/function () {\n  function _AccessTokenEvents(args) {\n    _classCallCheck(this, _AccessTokenEvents);\n    this._logger = new _Logger(\"AccessTokenEvents\");\n    this._expiringTimer = new Timer(\"Access token expiring\");\n    this._expiredTimer = new Timer(\"Access token expired\");\n    this._expiringNotificationTimeInSeconds = args.expiringNotificationTimeInSeconds;\n  }\n  _createClass(_AccessTokenEvents, [{\n    key: \"load\",\n    value: function load(container) {\n      var logger2 = this._logger.create(\"load\");\n      if (container.access_token && container.expires_in !== void 0) {\n        var duration = container.expires_in;\n        logger2.debug(\"access token present, remaining duration:\", duration);\n        if (duration > 0) {\n          var expiring = duration - this._expiringNotificationTimeInSeconds;\n          if (expiring <= 0) {\n            expiring = 1;\n          }\n          logger2.debug(\"registering expiring timer, raising in\", expiring, \"seconds\");\n          this._expiringTimer.init(expiring);\n        } else {\n          logger2.debug(\"canceling existing expiring timer because we're past expiration.\");\n          this._expiringTimer.cancel();\n        }\n        var expired = duration + 1;\n        logger2.debug(\"registering expired timer, raising in\", expired, \"seconds\");\n        this._expiredTimer.init(expired);\n      } else {\n        this._expiringTimer.cancel();\n        this._expiredTimer.cancel();\n      }\n    }\n  }, {\n    key: \"unload\",\n    value: function unload() {\n      this._logger.debug(\"unload: canceling existing access token timers\");\n      this._expiringTimer.cancel();\n      this._expiredTimer.cancel();\n    }\n    /**\n     * Add callback: Raised prior to the access token expiring.\n     */\n  }, {\n    key: \"addAccessTokenExpiring\",\n    value: function addAccessTokenExpiring(cb) {\n      return this._expiringTimer.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised prior to the access token expiring.\n     */\n  }, {\n    key: \"removeAccessTokenExpiring\",\n    value: function removeAccessTokenExpiring(cb) {\n      this._expiringTimer.removeHandler(cb);\n    }\n    /**\n     * Add callback: Raised after the access token has expired.\n     */\n  }, {\n    key: \"addAccessTokenExpired\",\n    value: function addAccessTokenExpired(cb) {\n      return this._expiredTimer.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised after the access token has expired.\n     */\n  }, {\n    key: \"removeAccessTokenExpired\",\n    value: function removeAccessTokenExpired(cb) {\n      this._expiredTimer.removeHandler(cb);\n    }\n  }]);\n  return _AccessTokenEvents;\n}();\n\n// src/CheckSessionIFrame.ts\nvar _CheckSessionIFrame = /*#__PURE__*/function () {\n  function _CheckSessionIFrame(_callback, _client_id, url, _intervalInSeconds, _stopOnError) {\n    var _this5 = this;\n    _classCallCheck(this, _CheckSessionIFrame);\n    this._callback = _callback;\n    this._client_id = _client_id;\n    this._intervalInSeconds = _intervalInSeconds;\n    this._stopOnError = _stopOnError;\n    this._logger = new _Logger(\"CheckSessionIFrame\");\n    this._timer = null;\n    this._session_state = null;\n    this._message = function (e) {\n      if (e.origin === _this5._frame_origin && e.source === _this5._frame.contentWindow) {\n        if (e.data === \"error\") {\n          _this5._logger.error(\"error message from check session op iframe\");\n          if (_this5._stopOnError) {\n            _this5.stop();\n          }\n        } else if (e.data === \"changed\") {\n          _this5._logger.debug(\"changed message from check session op iframe\");\n          _this5.stop();\n          void _this5._callback();\n        } else {\n          _this5._logger.debug(e.data + \" message from check session op iframe\");\n        }\n      }\n    };\n    var parsedUrl = new URL(url);\n    this._frame_origin = parsedUrl.origin;\n    this._frame = window.document.createElement(\"iframe\");\n    this._frame.style.visibility = \"hidden\";\n    this._frame.style.position = \"fixed\";\n    this._frame.style.left = \"-1000px\";\n    this._frame.style.top = \"0\";\n    this._frame.width = \"0\";\n    this._frame.height = \"0\";\n    this._frame.src = parsedUrl.href;\n  }\n  _createClass(_CheckSessionIFrame, [{\n    key: \"load\",\n    value: function load() {\n      var _this6 = this;\n      return new Promise(function (resolve) {\n        _this6._frame.onload = function () {\n          resolve();\n        };\n        window.document.body.appendChild(_this6._frame);\n        window.addEventListener(\"message\", _this6._message, false);\n      });\n    }\n  }, {\n    key: \"start\",\n    value: function start(session_state) {\n      var _this7 = this;\n      if (this._session_state === session_state) {\n        return;\n      }\n      this._logger.create(\"start\");\n      this.stop();\n      this._session_state = session_state;\n      var send = function send() {\n        if (!_this7._frame.contentWindow || !_this7._session_state) {\n          return;\n        }\n        _this7._frame.contentWindow.postMessage(_this7._client_id + \" \" + _this7._session_state, _this7._frame_origin);\n      };\n      send();\n      this._timer = setInterval(send, this._intervalInSeconds * 1e3);\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      this._logger.create(\"stop\");\n      this._session_state = null;\n      if (this._timer) {\n        clearInterval(this._timer);\n        this._timer = null;\n      }\n    }\n  }]);\n  return _CheckSessionIFrame;\n}();\n\n// src/InMemoryWebStorage.ts\nvar _InMemoryWebStorage = /*#__PURE__*/function () {\n  function _InMemoryWebStorage() {\n    _classCallCheck(this, _InMemoryWebStorage);\n    this._logger = new _Logger(\"InMemoryWebStorage\");\n    this._data = {};\n  }\n  _createClass(_InMemoryWebStorage, [{\n    key: \"clear\",\n    value: function clear() {\n      this._logger.create(\"clear\");\n      this._data = {};\n    }\n  }, {\n    key: \"getItem\",\n    value: function getItem(key) {\n      this._logger.create(\"getItem('\".concat(key, \"')\"));\n      return this._data[key];\n    }\n  }, {\n    key: \"setItem\",\n    value: function setItem(key, value) {\n      this._logger.create(\"setItem('\".concat(key, \"')\"));\n      this._data[key] = value;\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(key) {\n      this._logger.create(\"removeItem('\".concat(key, \"')\"));\n      delete this._data[key];\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return Object.getOwnPropertyNames(this._data).length;\n    }\n  }, {\n    key: \"key\",\n    value: function key(index) {\n      return Object.getOwnPropertyNames(this._data)[index];\n    }\n  }]);\n  return _InMemoryWebStorage;\n}();\n\n// src/JsonService.ts\nvar JsonService = /*#__PURE__*/function () {\n  function JsonService() {\n    var _this$_contentTypes;\n    var additionalContentTypes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var _jwtHandler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    _classCallCheck(this, JsonService);\n    this._jwtHandler = _jwtHandler;\n    this._logger = new _Logger(\"JsonService\");\n    this._contentTypes = [];\n    (_this$_contentTypes = this._contentTypes).push.apply(_this$_contentTypes, _toConsumableArray(additionalContentTypes).concat([\"application/json\"]));\n    if (_jwtHandler) {\n      this._contentTypes.push(\"application/jwt\");\n    }\n  }\n  _createClass(JsonService, [{\n    key: \"fetchWithTimeout\",\n    value: function () {\n      var _fetchWithTimeout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(input) {\n        var init,\n          timeoutInSeconds,\n          initFetch,\n          controller,\n          timeoutId,\n          response,\n          _args = arguments;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              init = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n              timeoutInSeconds = init.timeoutInSeconds, initFetch = _objectWithoutProperties(init, _excluded);\n              if (timeoutInSeconds) {\n                _context.next = 6;\n                break;\n              }\n              _context.next = 5;\n              return fetch(input, initFetch);\n            case 5:\n              return _context.abrupt(\"return\", _context.sent);\n            case 6:\n              controller = new AbortController();\n              timeoutId = setTimeout(function () {\n                return controller.abort();\n              }, timeoutInSeconds * 1e3);\n              _context.prev = 8;\n              _context.next = 11;\n              return fetch(input, _objectSpread(_objectSpread({}, init), {}, {\n                signal: controller.signal\n              }));\n            case 11:\n              response = _context.sent;\n              return _context.abrupt(\"return\", response);\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](8);\n              if (!(_context.t0 instanceof DOMException && _context.t0.name === \"AbortError\")) {\n                _context.next = 19;\n                break;\n              }\n              throw new _ErrorTimeout(\"Network timed out\");\n            case 19:\n              throw _context.t0;\n            case 20:\n              _context.prev = 20;\n              clearTimeout(timeoutId);\n              return _context.finish(20);\n            case 23:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[8, 15, 20, 23]]);\n      }));\n      function fetchWithTimeout(_x) {\n        return _fetchWithTimeout.apply(this, arguments);\n      }\n      return fetchWithTimeout;\n    }()\n  }, {\n    key: \"getJson\",\n    value: function () {\n      var _getJson = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(url) {\n        var _ref6,\n          token,\n          credentials,\n          logger2,\n          headers,\n          response,\n          contentType,\n          json,\n          _args2 = arguments;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _ref6 = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {}, token = _ref6.token, credentials = _ref6.credentials;\n              logger2 = this._logger.create(\"getJson\");\n              headers = {\n                \"Accept\": this._contentTypes.join(\", \")\n              };\n              if (token) {\n                logger2.debug(\"token passed, setting Authorization header\");\n                headers[\"Authorization\"] = \"Bearer \" + token;\n              }\n              _context2.prev = 4;\n              logger2.debug(\"url:\", url);\n              _context2.next = 8;\n              return this.fetchWithTimeout(url, {\n                method: \"GET\",\n                headers: headers,\n                credentials: credentials\n              });\n            case 8:\n              response = _context2.sent;\n              _context2.next = 15;\n              break;\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](4);\n              logger2.error(\"Network Error\");\n              throw _context2.t0;\n            case 15:\n              logger2.debug(\"HTTP response received, status\", response.status);\n              contentType = response.headers.get(\"Content-Type\");\n              if (contentType && !this._contentTypes.find(function (item) {\n                return contentType.startsWith(item);\n              })) {\n                logger2.throw(new Error(\"Invalid response Content-Type: \".concat(contentType != null ? contentType : \"undefined\", \", from URL: \").concat(url)));\n              }\n              if (!(response.ok && this._jwtHandler && (contentType == null ? void 0 : contentType.startsWith(\"application/jwt\")))) {\n                _context2.next = 26;\n                break;\n              }\n              _context2.t1 = this;\n              _context2.next = 22;\n              return response.text();\n            case 22:\n              _context2.t2 = _context2.sent;\n              _context2.next = 25;\n              return _context2.t1._jwtHandler.call(_context2.t1, _context2.t2);\n            case 25:\n              return _context2.abrupt(\"return\", _context2.sent);\n            case 26:\n              _context2.prev = 26;\n              _context2.next = 29;\n              return response.json();\n            case 29:\n              json = _context2.sent;\n              _context2.next = 38;\n              break;\n            case 32:\n              _context2.prev = 32;\n              _context2.t3 = _context2[\"catch\"](26);\n              logger2.error(\"Error parsing JSON response\", _context2.t3);\n              if (!response.ok) {\n                _context2.next = 37;\n                break;\n              }\n              throw _context2.t3;\n            case 37:\n              throw new Error(\"\".concat(response.statusText, \" (\").concat(response.status, \")\"));\n            case 38:\n              if (response.ok) {\n                _context2.next = 43;\n                break;\n              }\n              logger2.error(\"Error from server:\", json);\n              if (!json.error) {\n                _context2.next = 42;\n                break;\n              }\n              throw new _ErrorResponse(json);\n            case 42:\n              throw new Error(\"\".concat(response.statusText, \" (\").concat(response.status, \"): \").concat(JSON.stringify(json)));\n            case 43:\n              return _context2.abrupt(\"return\", json);\n            case 44:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[4, 11], [26, 32]]);\n      }));\n      function getJson(_x2) {\n        return _getJson.apply(this, arguments);\n      }\n      return getJson;\n    }()\n  }, {\n    key: \"postForm\",\n    value: function () {\n      var _postForm = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(url, _ref7) {\n        var body, basicAuth, timeoutInSeconds, initCredentials, logger2, headers, response, contentType, responseText, json;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              body = _ref7.body, basicAuth = _ref7.basicAuth, timeoutInSeconds = _ref7.timeoutInSeconds, initCredentials = _ref7.initCredentials;\n              logger2 = this._logger.create(\"postForm\");\n              headers = {\n                \"Accept\": this._contentTypes.join(\", \"),\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n              };\n              if (basicAuth !== void 0) {\n                headers[\"Authorization\"] = \"Basic \" + basicAuth;\n              }\n              _context3.prev = 4;\n              logger2.debug(\"url:\", url);\n              _context3.next = 8;\n              return this.fetchWithTimeout(url, {\n                method: \"POST\",\n                headers: headers,\n                body: body,\n                timeoutInSeconds: timeoutInSeconds,\n                credentials: initCredentials\n              });\n            case 8:\n              response = _context3.sent;\n              _context3.next = 15;\n              break;\n            case 11:\n              _context3.prev = 11;\n              _context3.t0 = _context3[\"catch\"](4);\n              logger2.error(\"Network error\");\n              throw _context3.t0;\n            case 15:\n              logger2.debug(\"HTTP response received, status\", response.status);\n              contentType = response.headers.get(\"Content-Type\");\n              if (!(contentType && !this._contentTypes.find(function (item) {\n                return contentType.startsWith(item);\n              }))) {\n                _context3.next = 19;\n                break;\n              }\n              throw new Error(\"Invalid response Content-Type: \".concat(contentType != null ? contentType : \"undefined\", \", from URL: \").concat(url));\n            case 19:\n              _context3.next = 21;\n              return response.text();\n            case 21:\n              responseText = _context3.sent;\n              json = {};\n              if (!responseText) {\n                _context3.next = 34;\n                break;\n              }\n              _context3.prev = 24;\n              json = JSON.parse(responseText);\n              _context3.next = 34;\n              break;\n            case 28:\n              _context3.prev = 28;\n              _context3.t1 = _context3[\"catch\"](24);\n              logger2.error(\"Error parsing JSON response\", _context3.t1);\n              if (!response.ok) {\n                _context3.next = 33;\n                break;\n              }\n              throw _context3.t1;\n            case 33:\n              throw new Error(\"\".concat(response.statusText, \" (\").concat(response.status, \")\"));\n            case 34:\n              if (response.ok) {\n                _context3.next = 39;\n                break;\n              }\n              logger2.error(\"Error from server:\", json);\n              if (!json.error) {\n                _context3.next = 38;\n                break;\n              }\n              throw new _ErrorResponse(json, body);\n            case 38:\n              throw new Error(\"\".concat(response.statusText, \" (\").concat(response.status, \"): \").concat(JSON.stringify(json)));\n            case 39:\n              return _context3.abrupt(\"return\", json);\n            case 40:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[4, 11], [24, 28]]);\n      }));\n      function postForm(_x3, _x4) {\n        return _postForm.apply(this, arguments);\n      }\n      return postForm;\n    }()\n  }]);\n  return JsonService;\n}();\n\n// src/MetadataService.ts\nvar _MetadataService = /*#__PURE__*/function () {\n  function _MetadataService(_settings) {\n    _classCallCheck(this, _MetadataService);\n    this._settings = _settings;\n    this._logger = new _Logger(\"MetadataService\");\n    this._jsonService = new JsonService([\"application/jwk-set+json\"]);\n    this._signingKeys = null;\n    this._metadata = null;\n    this._metadataUrl = this._settings.metadataUrl;\n    if (this._settings.signingKeys) {\n      this._logger.debug(\"using signingKeys from settings\");\n      this._signingKeys = this._settings.signingKeys;\n    }\n    if (this._settings.metadata) {\n      this._logger.debug(\"using metadata from settings\");\n      this._metadata = this._settings.metadata;\n    }\n    if (this._settings.fetchRequestCredentials) {\n      this._logger.debug(\"using fetchRequestCredentials from settings\");\n      this._fetchRequestCredentials = this._settings.fetchRequestCredentials;\n    }\n  }\n  _createClass(_MetadataService, [{\n    key: \"resetSigningKeys\",\n    value: function resetSigningKeys() {\n      this._signingKeys = null;\n    }\n  }, {\n    key: \"getMetadata\",\n    value: function () {\n      var _getMetadata = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var logger2, metadata;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              logger2 = this._logger.create(\"getMetadata\");\n              if (!this._metadata) {\n                _context4.next = 4;\n                break;\n              }\n              logger2.debug(\"using cached values\");\n              return _context4.abrupt(\"return\", this._metadata);\n            case 4:\n              if (this._metadataUrl) {\n                _context4.next = 7;\n                break;\n              }\n              logger2.throw(new Error(\"No authority or metadataUrl configured on settings\"));\n              throw null;\n            case 7:\n              logger2.debug(\"getting metadata from\", this._metadataUrl);\n              _context4.next = 10;\n              return this._jsonService.getJson(this._metadataUrl, {\n                credentials: this._fetchRequestCredentials\n              });\n            case 10:\n              metadata = _context4.sent;\n              logger2.debug(\"merging remote JSON with seed metadata\");\n              this._metadata = Object.assign({}, this._settings.metadataSeed, metadata);\n              return _context4.abrupt(\"return\", this._metadata);\n            case 14:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function getMetadata() {\n        return _getMetadata.apply(this, arguments);\n      }\n      return getMetadata;\n    }()\n  }, {\n    key: \"getIssuer\",\n    value: function getIssuer() {\n      return this._getMetadataProperty(\"issuer\");\n    }\n  }, {\n    key: \"getAuthorizationEndpoint\",\n    value: function getAuthorizationEndpoint() {\n      return this._getMetadataProperty(\"authorization_endpoint\");\n    }\n  }, {\n    key: \"getUserInfoEndpoint\",\n    value: function getUserInfoEndpoint() {\n      return this._getMetadataProperty(\"userinfo_endpoint\");\n    }\n  }, {\n    key: \"getTokenEndpoint\",\n    value: function getTokenEndpoint() {\n      var optional = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      return this._getMetadataProperty(\"token_endpoint\", optional);\n    }\n  }, {\n    key: \"getCheckSessionIframe\",\n    value: function getCheckSessionIframe() {\n      return this._getMetadataProperty(\"check_session_iframe\", true);\n    }\n  }, {\n    key: \"getEndSessionEndpoint\",\n    value: function getEndSessionEndpoint() {\n      return this._getMetadataProperty(\"end_session_endpoint\", true);\n    }\n  }, {\n    key: \"getRevocationEndpoint\",\n    value: function getRevocationEndpoint() {\n      var optional = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      return this._getMetadataProperty(\"revocation_endpoint\", optional);\n    }\n  }, {\n    key: \"getKeysEndpoint\",\n    value: function getKeysEndpoint() {\n      var optional = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      return this._getMetadataProperty(\"jwks_uri\", optional);\n    }\n  }, {\n    key: \"_getMetadataProperty\",\n    value: function () {\n      var _getMetadataProperty2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(name) {\n        var optional,\n          logger2,\n          metadata,\n          _args5 = arguments;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              optional = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : false;\n              logger2 = this._logger.create(\"_getMetadataProperty('\".concat(name, \"')\"));\n              _context5.next = 4;\n              return this.getMetadata();\n            case 4:\n              metadata = _context5.sent;\n              logger2.debug(\"resolved\");\n              if (!(metadata[name] === void 0)) {\n                _context5.next = 11;\n                break;\n              }\n              if (!(optional === true)) {\n                _context5.next = 10;\n                break;\n              }\n              logger2.warn(\"Metadata does not contain optional property\");\n              return _context5.abrupt(\"return\", void 0);\n            case 10:\n              logger2.throw(new Error(\"Metadata does not contain property \" + name));\n            case 11:\n              return _context5.abrupt(\"return\", metadata[name]);\n            case 12:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function _getMetadataProperty(_x5) {\n        return _getMetadataProperty2.apply(this, arguments);\n      }\n      return _getMetadataProperty;\n    }()\n  }, {\n    key: \"getSigningKeys\",\n    value: function () {\n      var _getSigningKeys = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var logger2, jwks_uri, keySet;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              logger2 = this._logger.create(\"getSigningKeys\");\n              if (!this._signingKeys) {\n                _context6.next = 4;\n                break;\n              }\n              logger2.debug(\"returning signingKeys from cache\");\n              return _context6.abrupt(\"return\", this._signingKeys);\n            case 4:\n              _context6.next = 6;\n              return this.getKeysEndpoint(false);\n            case 6:\n              jwks_uri = _context6.sent;\n              logger2.debug(\"got jwks_uri\", jwks_uri);\n              _context6.next = 10;\n              return this._jsonService.getJson(jwks_uri);\n            case 10:\n              keySet = _context6.sent;\n              logger2.debug(\"got key set\", keySet);\n              if (Array.isArray(keySet.keys)) {\n                _context6.next = 15;\n                break;\n              }\n              logger2.throw(new Error(\"Missing keys on keyset\"));\n              throw null;\n            case 15:\n              this._signingKeys = keySet.keys;\n              return _context6.abrupt(\"return\", this._signingKeys);\n            case 17:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function getSigningKeys() {\n        return _getSigningKeys.apply(this, arguments);\n      }\n      return getSigningKeys;\n    }()\n  }]);\n  return _MetadataService;\n}();\n\n// src/WebStorageStateStore.ts\nvar _WebStorageStateStore = /*#__PURE__*/function () {\n  function _WebStorageStateStore() {\n    var _ref8 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref8$prefix = _ref8.prefix,\n      prefix = _ref8$prefix === void 0 ? \"oidc.\" : _ref8$prefix,\n      _ref8$store = _ref8.store,\n      store = _ref8$store === void 0 ? localStorage : _ref8$store;\n    _classCallCheck(this, _WebStorageStateStore);\n    this._logger = new _Logger(\"WebStorageStateStore\");\n    this._store = store;\n    this._prefix = prefix;\n  }\n  _createClass(_WebStorageStateStore, [{\n    key: \"set\",\n    value: function () {\n      var _set = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(key, value) {\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              this._logger.create(\"set('\".concat(key, \"')\"));\n              key = this._prefix + key;\n              _context7.next = 4;\n              return this._store.setItem(key, value);\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function set(_x6, _x7) {\n        return _set.apply(this, arguments);\n      }\n      return set;\n    }()\n  }, {\n    key: \"get\",\n    value: function () {\n      var _get2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(key) {\n        var item;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              this._logger.create(\"get('\".concat(key, \"')\"));\n              key = this._prefix + key;\n              _context8.next = 4;\n              return this._store.getItem(key);\n            case 4:\n              item = _context8.sent;\n              return _context8.abrupt(\"return\", item);\n            case 6:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function get(_x8) {\n        return _get2.apply(this, arguments);\n      }\n      return get;\n    }()\n  }, {\n    key: \"remove\",\n    value: function () {\n      var _remove = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(key) {\n        var item;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              this._logger.create(\"remove('\".concat(key, \"')\"));\n              key = this._prefix + key;\n              _context9.next = 4;\n              return this._store.getItem(key);\n            case 4:\n              item = _context9.sent;\n              _context9.next = 7;\n              return this._store.removeItem(key);\n            case 7:\n              return _context9.abrupt(\"return\", item);\n            case 8:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this);\n      }));\n      function remove(_x9) {\n        return _remove.apply(this, arguments);\n      }\n      return remove;\n    }()\n  }, {\n    key: \"getAllKeys\",\n    value: function () {\n      var _getAllKeys = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n        var len, keys, index, key;\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              this._logger.create(\"getAllKeys\");\n              _context10.next = 3;\n              return this._store.length;\n            case 3:\n              len = _context10.sent;\n              keys = [];\n              index = 0;\n            case 6:\n              if (!(index < len)) {\n                _context10.next = 14;\n                break;\n              }\n              _context10.next = 9;\n              return this._store.key(index);\n            case 9:\n              key = _context10.sent;\n              if (key && key.indexOf(this._prefix) === 0) {\n                keys.push(key.substr(this._prefix.length));\n              }\n            case 11:\n              index++;\n              _context10.next = 6;\n              break;\n            case 14:\n              return _context10.abrupt(\"return\", keys);\n            case 15:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function getAllKeys() {\n        return _getAllKeys.apply(this, arguments);\n      }\n      return getAllKeys;\n    }()\n  }]);\n  return _WebStorageStateStore;\n}();\n\n// src/OidcClientSettings.ts\nvar DefaultResponseType = \"code\";\nvar DefaultScope = \"openid\";\nvar DefaultClientAuthentication = \"client_secret_post\";\nvar DefaultResponseMode = \"query\";\nvar DefaultStaleStateAgeInSeconds = 60 * 15;\nvar DefaultClockSkewInSeconds = 60 * 5;\nvar _OidcClientSettingsStore = /*#__PURE__*/_createClass(function _OidcClientSettingsStore(_ref9) {\n  var authority = _ref9.authority,\n    metadataUrl = _ref9.metadataUrl,\n    metadata = _ref9.metadata,\n    signingKeys = _ref9.signingKeys,\n    metadataSeed = _ref9.metadataSeed,\n    client_id = _ref9.client_id,\n    client_secret = _ref9.client_secret,\n    _ref9$response_type = _ref9.response_type,\n    response_type = _ref9$response_type === void 0 ? DefaultResponseType : _ref9$response_type,\n    _ref9$scope = _ref9.scope,\n    scope = _ref9$scope === void 0 ? DefaultScope : _ref9$scope,\n    redirect_uri = _ref9.redirect_uri,\n    post_logout_redirect_uri = _ref9.post_logout_redirect_uri,\n    _ref9$client_authenti = _ref9.client_authentication,\n    client_authentication = _ref9$client_authenti === void 0 ? DefaultClientAuthentication : _ref9$client_authenti,\n    prompt = _ref9.prompt,\n    display = _ref9.display,\n    max_age = _ref9.max_age,\n    ui_locales = _ref9.ui_locales,\n    acr_values = _ref9.acr_values,\n    resource = _ref9.resource,\n    _ref9$response_mode = _ref9.response_mode,\n    response_mode = _ref9$response_mode === void 0 ? DefaultResponseMode : _ref9$response_mode,\n    _ref9$filterProtocolC = _ref9.filterProtocolClaims,\n    filterProtocolClaims = _ref9$filterProtocolC === void 0 ? true : _ref9$filterProtocolC,\n    _ref9$loadUserInfo = _ref9.loadUserInfo,\n    loadUserInfo = _ref9$loadUserInfo === void 0 ? false : _ref9$loadUserInfo,\n    _ref9$staleStateAgeIn = _ref9.staleStateAgeInSeconds,\n    staleStateAgeInSeconds = _ref9$staleStateAgeIn === void 0 ? DefaultStaleStateAgeInSeconds : _ref9$staleStateAgeIn,\n    _ref9$clockSkewInSeco = _ref9.clockSkewInSeconds,\n    clockSkewInSeconds = _ref9$clockSkewInSeco === void 0 ? DefaultClockSkewInSeconds : _ref9$clockSkewInSeco,\n    _ref9$userInfoJwtIssu = _ref9.userInfoJwtIssuer,\n    userInfoJwtIssuer = _ref9$userInfoJwtIssu === void 0 ? \"OP\" : _ref9$userInfoJwtIssu,\n    _ref9$mergeClaims = _ref9.mergeClaims,\n    mergeClaims = _ref9$mergeClaims === void 0 ? false : _ref9$mergeClaims,\n    stateStore = _ref9.stateStore,\n    refreshTokenCredentials = _ref9.refreshTokenCredentials,\n    revokeTokenAdditionalContentTypes = _ref9.revokeTokenAdditionalContentTypes,\n    fetchRequestCredentials = _ref9.fetchRequestCredentials,\n    refreshTokenAllowedScope = _ref9.refreshTokenAllowedScope,\n    _ref9$extraQueryParam = _ref9.extraQueryParams,\n    extraQueryParams = _ref9$extraQueryParam === void 0 ? {} : _ref9$extraQueryParam,\n    _ref9$extraTokenParam = _ref9.extraTokenParams,\n    extraTokenParams = _ref9$extraTokenParam === void 0 ? {} : _ref9$extraTokenParam;\n  _classCallCheck(this, _OidcClientSettingsStore);\n  this.authority = authority;\n  if (metadataUrl) {\n    this.metadataUrl = metadataUrl;\n  } else {\n    this.metadataUrl = authority;\n    if (authority) {\n      if (!this.metadataUrl.endsWith(\"/\")) {\n        this.metadataUrl += \"/\";\n      }\n      this.metadataUrl += \".well-known/openid-configuration\";\n    }\n  }\n  this.metadata = metadata;\n  this.metadataSeed = metadataSeed;\n  this.signingKeys = signingKeys;\n  this.client_id = client_id;\n  this.client_secret = client_secret;\n  this.response_type = response_type;\n  this.scope = scope;\n  this.redirect_uri = redirect_uri;\n  this.post_logout_redirect_uri = post_logout_redirect_uri;\n  this.client_authentication = client_authentication;\n  this.prompt = prompt;\n  this.display = display;\n  this.max_age = max_age;\n  this.ui_locales = ui_locales;\n  this.acr_values = acr_values;\n  this.resource = resource;\n  this.response_mode = response_mode;\n  this.filterProtocolClaims = filterProtocolClaims != null ? filterProtocolClaims : true;\n  this.loadUserInfo = !!loadUserInfo;\n  this.staleStateAgeInSeconds = staleStateAgeInSeconds;\n  this.clockSkewInSeconds = clockSkewInSeconds;\n  this.userInfoJwtIssuer = userInfoJwtIssuer;\n  this.mergeClaims = !!mergeClaims;\n  this.revokeTokenAdditionalContentTypes = revokeTokenAdditionalContentTypes;\n  if (fetchRequestCredentials && refreshTokenCredentials) {\n    console.warn(\"Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used.\");\n  }\n  this.fetchRequestCredentials = fetchRequestCredentials ? fetchRequestCredentials : refreshTokenCredentials ? refreshTokenCredentials : \"same-origin\";\n  if (stateStore) {\n    this.stateStore = stateStore;\n  } else {\n    var store = typeof window !== \"undefined\" ? window.localStorage : new _InMemoryWebStorage();\n    this.stateStore = new _WebStorageStateStore({\n      store: store\n    });\n  }\n  this.refreshTokenAllowedScope = refreshTokenAllowedScope;\n  this.extraQueryParams = extraQueryParams;\n  this.extraTokenParams = extraTokenParams;\n});\n\n// src/UserInfoService.ts\nvar UserInfoService = /*#__PURE__*/function () {\n  function UserInfoService(_settings, _metadataService) {\n    var _this8 = this;\n    _classCallCheck(this, UserInfoService);\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new _Logger(\"UserInfoService\");\n    this._getClaimsFromJwt = /*#__PURE__*/function () {\n      var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(responseText) {\n        var logger2, payload;\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) switch (_context11.prev = _context11.next) {\n            case 0:\n              logger2 = _this8._logger.create(\"_getClaimsFromJwt\");\n              _context11.prev = 1;\n              payload = JwtUtils.decode(responseText);\n              logger2.debug(\"JWT decoding successful\");\n              return _context11.abrupt(\"return\", payload);\n            case 7:\n              _context11.prev = 7;\n              _context11.t0 = _context11[\"catch\"](1);\n              logger2.error(\"Error parsing JWT response\");\n              throw _context11.t0;\n            case 11:\n            case \"end\":\n              return _context11.stop();\n          }\n        }, _callee11, null, [[1, 7]]);\n      }));\n      return function (_x10) {\n        return _ref10.apply(this, arguments);\n      };\n    }();\n    this._jsonService = new JsonService(void 0, this._getClaimsFromJwt);\n  }\n  _createClass(UserInfoService, [{\n    key: \"getClaims\",\n    value: function () {\n      var _getClaims = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(token) {\n        var logger2, url, claims;\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              logger2 = this._logger.create(\"getClaims\");\n              if (!token) {\n                this._logger.throw(new Error(\"No token passed\"));\n              }\n              _context12.next = 4;\n              return this._metadataService.getUserInfoEndpoint();\n            case 4:\n              url = _context12.sent;\n              logger2.debug(\"got userinfo url\", url);\n              _context12.next = 8;\n              return this._jsonService.getJson(url, {\n                token: token,\n                credentials: this._settings.fetchRequestCredentials\n              });\n            case 8:\n              claims = _context12.sent;\n              logger2.debug(\"got claims\", claims);\n              return _context12.abrupt(\"return\", claims);\n            case 11:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this);\n      }));\n      function getClaims(_x11) {\n        return _getClaims.apply(this, arguments);\n      }\n      return getClaims;\n    }()\n  }]);\n  return UserInfoService;\n}();\n\n// src/TokenClient.ts\nvar TokenClient = /*#__PURE__*/function () {\n  function TokenClient(_settings, _metadataService) {\n    _classCallCheck(this, TokenClient);\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new _Logger(\"TokenClient\");\n    this._jsonService = new JsonService(this._settings.revokeTokenAdditionalContentTypes);\n  }\n  _createClass(TokenClient, [{\n    key: \"exchangeCode\",\n    value: function () {\n      var _exchangeCode = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(_ref11) {\n        var _ref11$grant_type, grant_type, _ref11$redirect_uri, redirect_uri, _ref11$client_id, client_id, _ref11$client_secret, client_secret, args, logger2, params, _i, _Object$entries, _Object$entries$_i, key, value, basicAuth, url, response;\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              _ref11$grant_type = _ref11.grant_type, grant_type = _ref11$grant_type === void 0 ? \"authorization_code\" : _ref11$grant_type, _ref11$redirect_uri = _ref11.redirect_uri, redirect_uri = _ref11$redirect_uri === void 0 ? this._settings.redirect_uri : _ref11$redirect_uri, _ref11$client_id = _ref11.client_id, client_id = _ref11$client_id === void 0 ? this._settings.client_id : _ref11$client_id, _ref11$client_secret = _ref11.client_secret, client_secret = _ref11$client_secret === void 0 ? this._settings.client_secret : _ref11$client_secret, args = _objectWithoutProperties(_ref11, _excluded2);\n              logger2 = this._logger.create(\"exchangeCode\");\n              if (!client_id) {\n                logger2.throw(new Error(\"A client_id is required\"));\n              }\n              if (!redirect_uri) {\n                logger2.throw(new Error(\"A redirect_uri is required\"));\n              }\n              if (!args.code) {\n                logger2.throw(new Error(\"A code is required\"));\n              }\n              if (!args.code_verifier) {\n                logger2.throw(new Error(\"A code_verifier is required\"));\n              }\n              params = new URLSearchParams({\n                grant_type: grant_type,\n                redirect_uri: redirect_uri\n              });\n              for (_i = 0, _Object$entries = Object.entries(args); _i < _Object$entries.length; _i++) {\n                _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2), key = _Object$entries$_i[0], value = _Object$entries$_i[1];\n                if (value != null) {\n                  params.set(key, value);\n                }\n              }\n              _context13.t0 = this._settings.client_authentication;\n              _context13.next = _context13.t0 === \"client_secret_basic\" ? 11 : _context13.t0 === \"client_secret_post\" ? 16 : 19;\n              break;\n            case 11:\n              if (client_secret) {\n                _context13.next = 14;\n                break;\n              }\n              logger2.throw(new Error(\"A client_secret is required\"));\n              throw null;\n            case 14:\n              basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n              return _context13.abrupt(\"break\", 19);\n            case 16:\n              params.append(\"client_id\", client_id);\n              if (client_secret) {\n                params.append(\"client_secret\", client_secret);\n              }\n              return _context13.abrupt(\"break\", 19);\n            case 19:\n              _context13.next = 21;\n              return this._metadataService.getTokenEndpoint(false);\n            case 21:\n              url = _context13.sent;\n              logger2.debug(\"got token endpoint\");\n              _context13.next = 25;\n              return this._jsonService.postForm(url, {\n                body: params,\n                basicAuth: basicAuth,\n                initCredentials: this._settings.fetchRequestCredentials\n              });\n            case 25:\n              response = _context13.sent;\n              logger2.debug(\"got response\");\n              return _context13.abrupt(\"return\", response);\n            case 28:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this);\n      }));\n      function exchangeCode(_x12) {\n        return _exchangeCode.apply(this, arguments);\n      }\n      return exchangeCode;\n    }()\n  }, {\n    key: \"exchangeCredentials\",\n    value: function () {\n      var _exchangeCredentials = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(_ref12) {\n        var _ref12$grant_type, grant_type, _ref12$client_id, client_id, _ref12$client_secret, client_secret, _ref12$scope, scope, args, logger2, params, _i2, _Object$entries2, _Object$entries2$_i, key, value, basicAuth, url, response;\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) switch (_context14.prev = _context14.next) {\n            case 0:\n              _ref12$grant_type = _ref12.grant_type, grant_type = _ref12$grant_type === void 0 ? \"password\" : _ref12$grant_type, _ref12$client_id = _ref12.client_id, client_id = _ref12$client_id === void 0 ? this._settings.client_id : _ref12$client_id, _ref12$client_secret = _ref12.client_secret, client_secret = _ref12$client_secret === void 0 ? this._settings.client_secret : _ref12$client_secret, _ref12$scope = _ref12.scope, scope = _ref12$scope === void 0 ? this._settings.scope : _ref12$scope, args = _objectWithoutProperties(_ref12, _excluded3);\n              logger2 = this._logger.create(\"exchangeCredentials\");\n              if (!client_id) {\n                logger2.throw(new Error(\"A client_id is required\"));\n              }\n              params = new URLSearchParams({\n                grant_type: grant_type,\n                scope: scope\n              });\n              for (_i2 = 0, _Object$entries2 = Object.entries(args); _i2 < _Object$entries2.length; _i2++) {\n                _Object$entries2$_i = _slicedToArray(_Object$entries2[_i2], 2), key = _Object$entries2$_i[0], value = _Object$entries2$_i[1];\n                if (value != null) {\n                  params.set(key, value);\n                }\n              }\n              _context14.t0 = this._settings.client_authentication;\n              _context14.next = _context14.t0 === \"client_secret_basic\" ? 8 : _context14.t0 === \"client_secret_post\" ? 13 : 16;\n              break;\n            case 8:\n              if (client_secret) {\n                _context14.next = 11;\n                break;\n              }\n              logger2.throw(new Error(\"A client_secret is required\"));\n              throw null;\n            case 11:\n              basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n              return _context14.abrupt(\"break\", 16);\n            case 13:\n              params.append(\"client_id\", client_id);\n              if (client_secret) {\n                params.append(\"client_secret\", client_secret);\n              }\n              return _context14.abrupt(\"break\", 16);\n            case 16:\n              _context14.next = 18;\n              return this._metadataService.getTokenEndpoint(false);\n            case 18:\n              url = _context14.sent;\n              logger2.debug(\"got token endpoint\");\n              _context14.next = 22;\n              return this._jsonService.postForm(url, {\n                body: params,\n                basicAuth: basicAuth,\n                initCredentials: this._settings.fetchRequestCredentials\n              });\n            case 22:\n              response = _context14.sent;\n              logger2.debug(\"got response\");\n              return _context14.abrupt(\"return\", response);\n            case 25:\n            case \"end\":\n              return _context14.stop();\n          }\n        }, _callee14, this);\n      }));\n      function exchangeCredentials(_x13) {\n        return _exchangeCredentials.apply(this, arguments);\n      }\n      return exchangeCredentials;\n    }()\n  }, {\n    key: \"exchangeRefreshToken\",\n    value: function () {\n      var _exchangeRefreshToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(_ref13) {\n        var _ref13$grant_type, grant_type, _ref13$client_id, client_id, _ref13$client_secret, client_secret, timeoutInSeconds, args, logger2, params, _i3, _Object$entries3, _Object$entries3$_i, key, value, basicAuth, url, response;\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) switch (_context15.prev = _context15.next) {\n            case 0:\n              _ref13$grant_type = _ref13.grant_type, grant_type = _ref13$grant_type === void 0 ? \"refresh_token\" : _ref13$grant_type, _ref13$client_id = _ref13.client_id, client_id = _ref13$client_id === void 0 ? this._settings.client_id : _ref13$client_id, _ref13$client_secret = _ref13.client_secret, client_secret = _ref13$client_secret === void 0 ? this._settings.client_secret : _ref13$client_secret, timeoutInSeconds = _ref13.timeoutInSeconds, args = _objectWithoutProperties(_ref13, _excluded4);\n              logger2 = this._logger.create(\"exchangeRefreshToken\");\n              if (!client_id) {\n                logger2.throw(new Error(\"A client_id is required\"));\n              }\n              if (!args.refresh_token) {\n                logger2.throw(new Error(\"A refresh_token is required\"));\n              }\n              params = new URLSearchParams({\n                grant_type: grant_type\n              });\n              for (_i3 = 0, _Object$entries3 = Object.entries(args); _i3 < _Object$entries3.length; _i3++) {\n                _Object$entries3$_i = _slicedToArray(_Object$entries3[_i3], 2), key = _Object$entries3$_i[0], value = _Object$entries3$_i[1];\n                if (value != null) {\n                  params.set(key, value);\n                }\n              }\n              _context15.t0 = this._settings.client_authentication;\n              _context15.next = _context15.t0 === \"client_secret_basic\" ? 9 : _context15.t0 === \"client_secret_post\" ? 14 : 17;\n              break;\n            case 9:\n              if (client_secret) {\n                _context15.next = 12;\n                break;\n              }\n              logger2.throw(new Error(\"A client_secret is required\"));\n              throw null;\n            case 12:\n              basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n              return _context15.abrupt(\"break\", 17);\n            case 14:\n              params.append(\"client_id\", client_id);\n              if (client_secret) {\n                params.append(\"client_secret\", client_secret);\n              }\n              return _context15.abrupt(\"break\", 17);\n            case 17:\n              _context15.next = 19;\n              return this._metadataService.getTokenEndpoint(false);\n            case 19:\n              url = _context15.sent;\n              logger2.debug(\"got token endpoint\");\n              _context15.next = 23;\n              return this._jsonService.postForm(url, {\n                body: params,\n                basicAuth: basicAuth,\n                timeoutInSeconds: timeoutInSeconds,\n                initCredentials: this._settings.fetchRequestCredentials\n              });\n            case 23:\n              response = _context15.sent;\n              logger2.debug(\"got response\");\n              return _context15.abrupt(\"return\", response);\n            case 26:\n            case \"end\":\n              return _context15.stop();\n          }\n        }, _callee15, this);\n      }));\n      function exchangeRefreshToken(_x14) {\n        return _exchangeRefreshToken.apply(this, arguments);\n      }\n      return exchangeRefreshToken;\n    }()\n    /**\n     * Revoke an access or refresh token.\n     *\n     * @see https://datatracker.ietf.org/doc/html/rfc7009#section-2.1\n     */\n  }, {\n    key: \"revoke\",\n    value: function () {\n      var _revoke = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16(args) {\n        var _a, logger2, url, params, _i4, _Object$entries4, _Object$entries4$_i, key, value;\n        return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n          while (1) switch (_context16.prev = _context16.next) {\n            case 0:\n              logger2 = this._logger.create(\"revoke\");\n              if (!args.token) {\n                logger2.throw(new Error(\"A token is required\"));\n              }\n              _context16.next = 4;\n              return this._metadataService.getRevocationEndpoint(false);\n            case 4:\n              url = _context16.sent;\n              logger2.debug(\"got revocation endpoint, revoking \".concat((_a = args.token_type_hint) != null ? _a : \"default token type\"));\n              params = new URLSearchParams();\n              for (_i4 = 0, _Object$entries4 = Object.entries(args); _i4 < _Object$entries4.length; _i4++) {\n                _Object$entries4$_i = _slicedToArray(_Object$entries4[_i4], 2), key = _Object$entries4$_i[0], value = _Object$entries4$_i[1];\n                if (value != null) {\n                  params.set(key, value);\n                }\n              }\n              params.set(\"client_id\", this._settings.client_id);\n              if (this._settings.client_secret) {\n                params.set(\"client_secret\", this._settings.client_secret);\n              }\n              _context16.next = 12;\n              return this._jsonService.postForm(url, {\n                body: params\n              });\n            case 12:\n              logger2.debug(\"got response\");\n            case 13:\n            case \"end\":\n              return _context16.stop();\n          }\n        }, _callee16, this);\n      }));\n      function revoke(_x15) {\n        return _revoke.apply(this, arguments);\n      }\n      return revoke;\n    }()\n  }]);\n  return TokenClient;\n}();\n\n// src/ResponseValidator.ts\nvar DefaultProtocolClaims = [\"nbf\", \"jti\", \"auth_time\", \"nonce\", \"acr\", \"amr\", \"azp\", \"at_hash\"\n// https://openid.net/specs/openid-connect-core-1_0.html#CodeIDToken\n];\n\nvar InternalRequiredProtocolClaims = [\"sub\", \"iss\", \"aud\", \"exp\", \"iat\"];\nvar ResponseValidator = /*#__PURE__*/function () {\n  function ResponseValidator(_settings, _metadataService) {\n    _classCallCheck(this, ResponseValidator);\n    this._settings = _settings;\n    this._metadataService = _metadataService;\n    this._logger = new _Logger(\"ResponseValidator\");\n    this._userInfoService = new UserInfoService(this._settings, this._metadataService);\n    this._tokenClient = new TokenClient(this._settings, this._metadataService);\n  }\n  _createClass(ResponseValidator, [{\n    key: \"validateSigninResponse\",\n    value: function () {\n      var _validateSigninResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17(response, state) {\n        var logger2;\n        return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n          while (1) switch (_context17.prev = _context17.next) {\n            case 0:\n              logger2 = this._logger.create(\"validateSigninResponse\");\n              this._processSigninState(response, state);\n              logger2.debug(\"state processed\");\n              _context17.next = 5;\n              return this._processCode(response, state);\n            case 5:\n              logger2.debug(\"code processed\");\n              if (response.isOpenId) {\n                this._validateIdTokenAttributes(response);\n              }\n              logger2.debug(\"tokens validated\");\n              _context17.next = 10;\n              return this._processClaims(response, state == null ? void 0 : state.skipUserInfo, response.isOpenId);\n            case 10:\n              logger2.debug(\"claims processed\");\n            case 11:\n            case \"end\":\n              return _context17.stop();\n          }\n        }, _callee17, this);\n      }));\n      function validateSigninResponse(_x16, _x17) {\n        return _validateSigninResponse.apply(this, arguments);\n      }\n      return validateSigninResponse;\n    }()\n  }, {\n    key: \"validateCredentialsResponse\",\n    value: function () {\n      var _validateCredentialsResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18(response, skipUserInfo) {\n        var logger2;\n        return _regeneratorRuntime().wrap(function _callee18$(_context18) {\n          while (1) switch (_context18.prev = _context18.next) {\n            case 0:\n              logger2 = this._logger.create(\"validateCredentialsResponse\");\n              if (response.isOpenId) {\n                this._validateIdTokenAttributes(response);\n              }\n              logger2.debug(\"tokens validated\");\n              _context18.next = 5;\n              return this._processClaims(response, skipUserInfo, response.isOpenId);\n            case 5:\n              logger2.debug(\"claims processed\");\n            case 6:\n            case \"end\":\n              return _context18.stop();\n          }\n        }, _callee18, this);\n      }));\n      function validateCredentialsResponse(_x18, _x19) {\n        return _validateCredentialsResponse.apply(this, arguments);\n      }\n      return validateCredentialsResponse;\n    }()\n  }, {\n    key: \"validateRefreshResponse\",\n    value: function () {\n      var _validateRefreshResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19(response, state) {\n        var _a, _b, logger2, hasIdToken;\n        return _regeneratorRuntime().wrap(function _callee19$(_context19) {\n          while (1) switch (_context19.prev = _context19.next) {\n            case 0:\n              logger2 = this._logger.create(\"validateRefreshResponse\");\n              response.userState = state.data;\n              (_a = response.session_state) != null ? _a : response.session_state = state.session_state;\n              (_b = response.scope) != null ? _b : response.scope = state.scope;\n              if (response.isOpenId && !!response.id_token) {\n                this._validateIdTokenAttributes(response, state.id_token);\n                logger2.debug(\"ID Token validated\");\n              }\n              if (!response.id_token) {\n                response.id_token = state.id_token;\n                response.profile = state.profile;\n              }\n              hasIdToken = response.isOpenId && !!response.id_token;\n              _context19.next = 9;\n              return this._processClaims(response, false, hasIdToken);\n            case 9:\n              logger2.debug(\"claims processed\");\n            case 10:\n            case \"end\":\n              return _context19.stop();\n          }\n        }, _callee19, this);\n      }));\n      function validateRefreshResponse(_x20, _x21) {\n        return _validateRefreshResponse.apply(this, arguments);\n      }\n      return validateRefreshResponse;\n    }()\n  }, {\n    key: \"validateSignoutResponse\",\n    value: function validateSignoutResponse(response, state) {\n      var logger2 = this._logger.create(\"validateSignoutResponse\");\n      if (state.id !== response.state) {\n        logger2.throw(new Error(\"State does not match\"));\n      }\n      logger2.debug(\"state validated\");\n      response.userState = state.data;\n      if (response.error) {\n        logger2.warn(\"Response was error\", response.error);\n        throw new _ErrorResponse(response);\n      }\n    }\n  }, {\n    key: \"_processSigninState\",\n    value: function _processSigninState(response, state) {\n      var _a;\n      var logger2 = this._logger.create(\"_processSigninState\");\n      if (state.id !== response.state) {\n        logger2.throw(new Error(\"State does not match\"));\n      }\n      if (!state.client_id) {\n        logger2.throw(new Error(\"No client_id on state\"));\n      }\n      if (!state.authority) {\n        logger2.throw(new Error(\"No authority on state\"));\n      }\n      if (this._settings.authority !== state.authority) {\n        logger2.throw(new Error(\"authority mismatch on settings vs. signin state\"));\n      }\n      if (this._settings.client_id && this._settings.client_id !== state.client_id) {\n        logger2.throw(new Error(\"client_id mismatch on settings vs. signin state\"));\n      }\n      logger2.debug(\"state validated\");\n      response.userState = state.data;\n      (_a = response.scope) != null ? _a : response.scope = state.scope;\n      if (response.error) {\n        logger2.warn(\"Response was error\", response.error);\n        throw new _ErrorResponse(response);\n      }\n      if (state.code_verifier && !response.code) {\n        logger2.throw(new Error(\"Expected code in response\"));\n      }\n      if (!state.code_verifier && response.code) {\n        logger2.throw(new Error(\"Unexpected code in response\"));\n      }\n    }\n  }, {\n    key: \"_processClaims\",\n    value: function () {\n      var _processClaims2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20(response) {\n        var skipUserInfo,\n          validateSub,\n          logger2,\n          claims,\n          _args20 = arguments;\n        return _regeneratorRuntime().wrap(function _callee20$(_context20) {\n          while (1) switch (_context20.prev = _context20.next) {\n            case 0:\n              skipUserInfo = _args20.length > 1 && _args20[1] !== undefined ? _args20[1] : false;\n              validateSub = _args20.length > 2 && _args20[2] !== undefined ? _args20[2] : true;\n              logger2 = this._logger.create(\"_processClaims\");\n              response.profile = this._filterProtocolClaims(response.profile);\n              if (!(skipUserInfo || !this._settings.loadUserInfo || !response.access_token)) {\n                _context20.next = 7;\n                break;\n              }\n              logger2.debug(\"not loading user info\");\n              return _context20.abrupt(\"return\");\n            case 7:\n              logger2.debug(\"loading user info\");\n              _context20.next = 10;\n              return this._userInfoService.getClaims(response.access_token);\n            case 10:\n              claims = _context20.sent;\n              logger2.debug(\"user info claims received from user info endpoint\");\n              if (validateSub && claims.sub !== response.profile.sub) {\n                logger2.throw(new Error(\"subject from UserInfo response does not match subject in ID Token\"));\n              }\n              response.profile = this._mergeClaims(response.profile, this._filterProtocolClaims(claims));\n              logger2.debug(\"user info claims received, updated profile:\", response.profile);\n            case 15:\n            case \"end\":\n              return _context20.stop();\n          }\n        }, _callee20, this);\n      }));\n      function _processClaims(_x22) {\n        return _processClaims2.apply(this, arguments);\n      }\n      return _processClaims;\n    }()\n  }, {\n    key: \"_mergeClaims\",\n    value: function _mergeClaims(claims1, claims2) {\n      var result = _objectSpread({}, claims1);\n      for (var _i5 = 0, _Object$entries5 = Object.entries(claims2); _i5 < _Object$entries5.length; _i5++) {\n        var _Object$entries5$_i = _slicedToArray(_Object$entries5[_i5], 2),\n          claim = _Object$entries5$_i[0],\n          values = _Object$entries5$_i[1];\n        var _iterator3 = _createForOfIteratorHelper(Array.isArray(values) ? values : [values]),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var value = _step3.value;\n            var previousValue = result[claim];\n            if (!previousValue) {\n              result[claim] = value;\n            } else if (Array.isArray(previousValue)) {\n              if (!previousValue.includes(value)) {\n                previousValue.push(value);\n              }\n            } else if (result[claim] !== value) {\n              if (typeof value === \"object\" && this._settings.mergeClaims) {\n                result[claim] = this._mergeClaims(previousValue, value);\n              } else {\n                result[claim] = [previousValue, value];\n              }\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"_filterProtocolClaims\",\n    value: function _filterProtocolClaims(claims) {\n      var result = _objectSpread({}, claims);\n      if (this._settings.filterProtocolClaims) {\n        var protocolClaims;\n        if (Array.isArray(this._settings.filterProtocolClaims)) {\n          protocolClaims = this._settings.filterProtocolClaims;\n        } else {\n          protocolClaims = DefaultProtocolClaims;\n        }\n        var _iterator4 = _createForOfIteratorHelper(protocolClaims),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var claim = _step4.value;\n            if (!InternalRequiredProtocolClaims.includes(claim)) {\n              delete result[claim];\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"_processCode\",\n    value: function () {\n      var _processCode2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee21(response, state) {\n        var logger2, tokenResponse;\n        return _regeneratorRuntime().wrap(function _callee21$(_context21) {\n          while (1) switch (_context21.prev = _context21.next) {\n            case 0:\n              logger2 = this._logger.create(\"_processCode\");\n              if (!response.code) {\n                _context21.next = 9;\n                break;\n              }\n              logger2.debug(\"Validating code\");\n              _context21.next = 5;\n              return this._tokenClient.exchangeCode(_objectSpread({\n                client_id: state.client_id,\n                client_secret: state.client_secret,\n                code: response.code,\n                redirect_uri: state.redirect_uri,\n                code_verifier: state.code_verifier\n              }, state.extraTokenParams));\n            case 5:\n              tokenResponse = _context21.sent;\n              Object.assign(response, tokenResponse);\n              _context21.next = 10;\n              break;\n            case 9:\n              logger2.debug(\"No code to process\");\n            case 10:\n            case \"end\":\n              return _context21.stop();\n          }\n        }, _callee21, this);\n      }));\n      function _processCode(_x23, _x24) {\n        return _processCode2.apply(this, arguments);\n      }\n      return _processCode;\n    }()\n  }, {\n    key: \"_validateIdTokenAttributes\",\n    value: function _validateIdTokenAttributes(response, currentToken) {\n      var _a;\n      var logger2 = this._logger.create(\"_validateIdTokenAttributes\");\n      logger2.debug(\"decoding ID Token JWT\");\n      var profile = JwtUtils.decode((_a = response.id_token) != null ? _a : \"\");\n      if (!profile.sub) {\n        logger2.throw(new Error(\"ID Token is missing a subject claim\"));\n      }\n      if (currentToken) {\n        var current = JwtUtils.decode(currentToken);\n        if (current.sub !== profile.sub) {\n          logger2.throw(new Error(\"sub in id_token does not match current sub\"));\n        }\n        if (current.auth_time && current.auth_time !== profile.auth_time) {\n          logger2.throw(new Error(\"auth_time in id_token does not match original auth_time\"));\n        }\n        if (current.azp && current.azp !== profile.azp) {\n          logger2.throw(new Error(\"azp in id_token does not match original azp\"));\n        }\n        if (!current.azp && profile.azp) {\n          logger2.throw(new Error(\"azp not in id_token, but present in original id_token\"));\n        }\n      }\n      response.profile = profile;\n    }\n  }]);\n  return ResponseValidator;\n}();\n\n// src/State.ts\nvar _State = /*#__PURE__*/function () {\n  function _State(args) {\n    _classCallCheck(this, _State);\n    this.id = args.id || CryptoUtils.generateUUIDv4();\n    this.data = args.data;\n    if (args.created && args.created > 0) {\n      this.created = args.created;\n    } else {\n      this.created = Timer.getEpochTime();\n    }\n    this.request_type = args.request_type;\n  }\n  _createClass(_State, [{\n    key: \"toStorageString\",\n    value: function toStorageString() {\n      new _Logger(\"State\").create(\"toStorageString\");\n      return JSON.stringify({\n        id: this.id,\n        data: this.data,\n        created: this.created,\n        request_type: this.request_type\n      });\n    }\n  }], [{\n    key: \"fromStorageString\",\n    value: function fromStorageString(storageString) {\n      _Logger.createStatic(\"State\", \"fromStorageString\");\n      return new _State(JSON.parse(storageString));\n    }\n  }, {\n    key: \"clearStaleState\",\n    value: function () {\n      var _clearStaleState = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee22(storage, age) {\n        var logger2, cutoff, keys, i, key, item, remove, state;\n        return _regeneratorRuntime().wrap(function _callee22$(_context22) {\n          while (1) switch (_context22.prev = _context22.next) {\n            case 0:\n              logger2 = _Logger.createStatic(\"State\", \"clearStaleState\");\n              cutoff = Timer.getEpochTime() - age;\n              _context22.next = 4;\n              return storage.getAllKeys();\n            case 4:\n              keys = _context22.sent;\n              logger2.debug(\"got keys\", keys);\n              i = 0;\n            case 7:\n              if (!(i < keys.length)) {\n                _context22.next = 18;\n                break;\n              }\n              key = keys[i];\n              _context22.next = 11;\n              return storage.get(key);\n            case 11:\n              item = _context22.sent;\n              remove = false;\n              if (item) {\n                try {\n                  state = _State.fromStorageString(item);\n                  logger2.debug(\"got item from key:\", key, state.created);\n                  if (state.created <= cutoff) {\n                    remove = true;\n                  }\n                } catch (err) {\n                  logger2.error(\"Error parsing state for key:\", key, err);\n                  remove = true;\n                }\n              } else {\n                logger2.debug(\"no item in storage for key:\", key);\n                remove = true;\n              }\n              if (remove) {\n                logger2.debug(\"removed item for key:\", key);\n                void storage.remove(key);\n              }\n            case 15:\n              i++;\n              _context22.next = 7;\n              break;\n            case 18:\n            case \"end\":\n              return _context22.stop();\n          }\n        }, _callee22);\n      }));\n      function clearStaleState(_x25, _x26) {\n        return _clearStaleState.apply(this, arguments);\n      }\n      return clearStaleState;\n    }()\n  }]);\n  return _State;\n}();\n\n// src/SigninState.ts\nvar _SigninState = /*#__PURE__*/function (_State2) {\n  _inherits(_SigninState, _State2);\n  var _super4 = _createSuper(_SigninState);\n  function _SigninState(args) {\n    var _this9;\n    _classCallCheck(this, _SigninState);\n    _this9 = _super4.call(this, args);\n    if (args.code_verifier === true) {\n      _this9.code_verifier = CryptoUtils.generateCodeVerifier();\n    } else if (args.code_verifier) {\n      _this9.code_verifier = args.code_verifier;\n    }\n    if (_this9.code_verifier) {\n      _this9.code_challenge = CryptoUtils.generateCodeChallenge(_this9.code_verifier);\n    }\n    _this9.authority = args.authority;\n    _this9.client_id = args.client_id;\n    _this9.redirect_uri = args.redirect_uri;\n    _this9.scope = args.scope;\n    _this9.client_secret = args.client_secret;\n    _this9.extraTokenParams = args.extraTokenParams;\n    _this9.response_mode = args.response_mode;\n    _this9.skipUserInfo = args.skipUserInfo;\n    return _this9;\n  }\n  _createClass(_SigninState, [{\n    key: \"toStorageString\",\n    value: function toStorageString() {\n      new _Logger(\"SigninState\").create(\"toStorageString\");\n      return JSON.stringify({\n        id: this.id,\n        data: this.data,\n        created: this.created,\n        request_type: this.request_type,\n        code_verifier: this.code_verifier,\n        authority: this.authority,\n        client_id: this.client_id,\n        redirect_uri: this.redirect_uri,\n        scope: this.scope,\n        client_secret: this.client_secret,\n        extraTokenParams: this.extraTokenParams,\n        response_mode: this.response_mode,\n        skipUserInfo: this.skipUserInfo\n      });\n    }\n  }], [{\n    key: \"fromStorageString\",\n    value: function fromStorageString(storageString) {\n      _Logger.createStatic(\"SigninState\", \"fromStorageString\");\n      var data = JSON.parse(storageString);\n      return new _SigninState(data);\n    }\n  }]);\n  return _SigninState;\n}(_State);\n\n// src/SigninRequest.ts\nvar SigninRequest = /*#__PURE__*/_createClass(function SigninRequest(_ref14) {\n  var url = _ref14.url,\n    authority = _ref14.authority,\n    client_id = _ref14.client_id,\n    redirect_uri = _ref14.redirect_uri,\n    response_type = _ref14.response_type,\n    scope = _ref14.scope,\n    state_data = _ref14.state_data,\n    response_mode = _ref14.response_mode,\n    request_type = _ref14.request_type,\n    client_secret = _ref14.client_secret,\n    nonce = _ref14.nonce,\n    resource = _ref14.resource,\n    skipUserInfo = _ref14.skipUserInfo,\n    extraQueryParams = _ref14.extraQueryParams,\n    extraTokenParams = _ref14.extraTokenParams,\n    optionalParams = _objectWithoutProperties(_ref14, _excluded5);\n  _classCallCheck(this, SigninRequest);\n  this._logger = new _Logger(\"SigninRequest\");\n  if (!url) {\n    this._logger.error(\"ctor: No url passed\");\n    throw new Error(\"url\");\n  }\n  if (!client_id) {\n    this._logger.error(\"ctor: No client_id passed\");\n    throw new Error(\"client_id\");\n  }\n  if (!redirect_uri) {\n    this._logger.error(\"ctor: No redirect_uri passed\");\n    throw new Error(\"redirect_uri\");\n  }\n  if (!response_type) {\n    this._logger.error(\"ctor: No response_type passed\");\n    throw new Error(\"response_type\");\n  }\n  if (!scope) {\n    this._logger.error(\"ctor: No scope passed\");\n    throw new Error(\"scope\");\n  }\n  if (!authority) {\n    this._logger.error(\"ctor: No authority passed\");\n    throw new Error(\"authority\");\n  }\n  this.state = new _SigninState({\n    data: state_data,\n    request_type: request_type,\n    code_verifier: true,\n    client_id: client_id,\n    authority: authority,\n    redirect_uri: redirect_uri,\n    response_mode: response_mode,\n    client_secret: client_secret,\n    scope: scope,\n    extraTokenParams: extraTokenParams,\n    skipUserInfo: skipUserInfo\n  });\n  var parsedUrl = new URL(url);\n  parsedUrl.searchParams.append(\"client_id\", client_id);\n  parsedUrl.searchParams.append(\"redirect_uri\", redirect_uri);\n  parsedUrl.searchParams.append(\"response_type\", response_type);\n  parsedUrl.searchParams.append(\"scope\", scope);\n  if (nonce) {\n    parsedUrl.searchParams.append(\"nonce\", nonce);\n  }\n  parsedUrl.searchParams.append(\"state\", this.state.id);\n  if (this.state.code_challenge) {\n    parsedUrl.searchParams.append(\"code_challenge\", this.state.code_challenge);\n    parsedUrl.searchParams.append(\"code_challenge_method\", \"S256\");\n  }\n  if (resource) {\n    var resources = Array.isArray(resource) ? resource : [resource];\n    resources.forEach(function (r) {\n      return parsedUrl.searchParams.append(\"resource\", r);\n    });\n  }\n  for (var _i6 = 0, _Object$entries6 = Object.entries(_objectSpread(_objectSpread({\n      response_mode: response_mode\n    }, optionalParams), extraQueryParams)); _i6 < _Object$entries6.length; _i6++) {\n    var _Object$entries6$_i = _slicedToArray(_Object$entries6[_i6], 2),\n      key = _Object$entries6$_i[0],\n      value = _Object$entries6$_i[1];\n    if (value != null) {\n      parsedUrl.searchParams.append(key, value.toString());\n    }\n  }\n  this.url = parsedUrl.href;\n});\n\n// src/SigninResponse.ts\nvar OidcScope = \"openid\";\nvar _SigninResponse = /*#__PURE__*/function () {\n  function _SigninResponse(params) {\n    _classCallCheck(this, _SigninResponse);\n    /** @see {@link User.access_token} */\n    this.access_token = \"\";\n    /** @see {@link User.token_type} */\n    this.token_type = \"\";\n    /** @see {@link User.profile} */\n    this.profile = {};\n    this.state = params.get(\"state\");\n    this.session_state = params.get(\"session_state\");\n    this.error = params.get(\"error\");\n    this.error_description = params.get(\"error_description\");\n    this.error_uri = params.get(\"error_uri\");\n    this.code = params.get(\"code\");\n  }\n  _createClass(_SigninResponse, [{\n    key: \"expires_in\",\n    get: function get() {\n      if (this.expires_at === void 0) {\n        return void 0;\n      }\n      return this.expires_at - Timer.getEpochTime();\n    },\n    set: function set(value) {\n      if (typeof value === \"string\") value = Number(value);\n      if (value !== void 0 && value >= 0) {\n        this.expires_at = Math.floor(value) + Timer.getEpochTime();\n      }\n    }\n  }, {\n    key: \"isOpenId\",\n    get: function get() {\n      var _a;\n      return ((_a = this.scope) == null ? void 0 : _a.split(\" \").includes(OidcScope)) || !!this.id_token;\n    }\n  }]);\n  return _SigninResponse;\n}();\n\n// src/SignoutRequest.ts\nvar SignoutRequest = /*#__PURE__*/_createClass(function SignoutRequest(_ref15) {\n  var url = _ref15.url,\n    state_data = _ref15.state_data,\n    id_token_hint = _ref15.id_token_hint,\n    post_logout_redirect_uri = _ref15.post_logout_redirect_uri,\n    extraQueryParams = _ref15.extraQueryParams,\n    request_type = _ref15.request_type;\n  _classCallCheck(this, SignoutRequest);\n  this._logger = new _Logger(\"SignoutRequest\");\n  if (!url) {\n    this._logger.error(\"ctor: No url passed\");\n    throw new Error(\"url\");\n  }\n  var parsedUrl = new URL(url);\n  if (id_token_hint) {\n    parsedUrl.searchParams.append(\"id_token_hint\", id_token_hint);\n  }\n  if (post_logout_redirect_uri) {\n    parsedUrl.searchParams.append(\"post_logout_redirect_uri\", post_logout_redirect_uri);\n    if (state_data) {\n      this.state = new _State({\n        data: state_data,\n        request_type: request_type\n      });\n      parsedUrl.searchParams.append(\"state\", this.state.id);\n    }\n  }\n  for (var _i7 = 0, _Object$entries7 = Object.entries(_objectSpread({}, extraQueryParams)); _i7 < _Object$entries7.length; _i7++) {\n    var _Object$entries7$_i = _slicedToArray(_Object$entries7[_i7], 2),\n      key = _Object$entries7$_i[0],\n      value = _Object$entries7$_i[1];\n    if (value != null) {\n      parsedUrl.searchParams.append(key, value.toString());\n    }\n  }\n  this.url = parsedUrl.href;\n});\n\n// src/SignoutResponse.ts\nvar _SignoutResponse = /*#__PURE__*/_createClass(function _SignoutResponse(params) {\n  _classCallCheck(this, _SignoutResponse);\n  this.state = params.get(\"state\");\n  this.error = params.get(\"error\");\n  this.error_description = params.get(\"error_description\");\n  this.error_uri = params.get(\"error_uri\");\n});\n\n// src/OidcClient.ts\nvar _OidcClient = /*#__PURE__*/function () {\n  function _OidcClient(settings) {\n    _classCallCheck(this, _OidcClient);\n    this._logger = new _Logger(\"OidcClient\");\n    this.settings = new _OidcClientSettingsStore(settings);\n    this.metadataService = new _MetadataService(this.settings);\n    this._validator = new ResponseValidator(this.settings, this.metadataService);\n    this._tokenClient = new TokenClient(this.settings, this.metadataService);\n  }\n  _createClass(_OidcClient, [{\n    key: \"createSigninRequest\",\n    value: function () {\n      var _createSigninRequest = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee23(_ref16) {\n        var state, request, request_uri, request_type, id_token_hint, login_hint, skipUserInfo, nonce, _ref16$response_type, response_type, _ref16$scope, scope, _ref16$redirect_uri, redirect_uri, _ref16$prompt, prompt, _ref16$display, display, _ref16$max_age, max_age, _ref16$ui_locales, ui_locales, _ref16$acr_values, acr_values, _ref16$resource, resource, _ref16$response_mode, response_mode, _ref16$extraQueryPara, extraQueryParams, _ref16$extraTokenPara, extraTokenParams, logger2, url, signinRequest, signinState;\n        return _regeneratorRuntime().wrap(function _callee23$(_context23) {\n          while (1) switch (_context23.prev = _context23.next) {\n            case 0:\n              state = _ref16.state, request = _ref16.request, request_uri = _ref16.request_uri, request_type = _ref16.request_type, id_token_hint = _ref16.id_token_hint, login_hint = _ref16.login_hint, skipUserInfo = _ref16.skipUserInfo, nonce = _ref16.nonce, _ref16$response_type = _ref16.response_type, response_type = _ref16$response_type === void 0 ? this.settings.response_type : _ref16$response_type, _ref16$scope = _ref16.scope, scope = _ref16$scope === void 0 ? this.settings.scope : _ref16$scope, _ref16$redirect_uri = _ref16.redirect_uri, redirect_uri = _ref16$redirect_uri === void 0 ? this.settings.redirect_uri : _ref16$redirect_uri, _ref16$prompt = _ref16.prompt, prompt = _ref16$prompt === void 0 ? this.settings.prompt : _ref16$prompt, _ref16$display = _ref16.display, display = _ref16$display === void 0 ? this.settings.display : _ref16$display, _ref16$max_age = _ref16.max_age, max_age = _ref16$max_age === void 0 ? this.settings.max_age : _ref16$max_age, _ref16$ui_locales = _ref16.ui_locales, ui_locales = _ref16$ui_locales === void 0 ? this.settings.ui_locales : _ref16$ui_locales, _ref16$acr_values = _ref16.acr_values, acr_values = _ref16$acr_values === void 0 ? this.settings.acr_values : _ref16$acr_values, _ref16$resource = _ref16.resource, resource = _ref16$resource === void 0 ? this.settings.resource : _ref16$resource, _ref16$response_mode = _ref16.response_mode, response_mode = _ref16$response_mode === void 0 ? this.settings.response_mode : _ref16$response_mode, _ref16$extraQueryPara = _ref16.extraQueryParams, extraQueryParams = _ref16$extraQueryPara === void 0 ? this.settings.extraQueryParams : _ref16$extraQueryPara, _ref16$extraTokenPara = _ref16.extraTokenParams, extraTokenParams = _ref16$extraTokenPara === void 0 ? this.settings.extraTokenParams : _ref16$extraTokenPara;\n              logger2 = this._logger.create(\"createSigninRequest\");\n              if (!(response_type !== \"code\")) {\n                _context23.next = 4;\n                break;\n              }\n              throw new Error(\"Only the Authorization Code flow (with PKCE) is supported\");\n            case 4:\n              _context23.next = 6;\n              return this.metadataService.getAuthorizationEndpoint();\n            case 6:\n              url = _context23.sent;\n              logger2.debug(\"Received authorization endpoint\", url);\n              signinRequest = new SigninRequest({\n                url: url,\n                authority: this.settings.authority,\n                client_id: this.settings.client_id,\n                redirect_uri: redirect_uri,\n                response_type: response_type,\n                scope: scope,\n                state_data: state,\n                prompt: prompt,\n                display: display,\n                max_age: max_age,\n                ui_locales: ui_locales,\n                id_token_hint: id_token_hint,\n                login_hint: login_hint,\n                acr_values: acr_values,\n                resource: resource,\n                request: request,\n                request_uri: request_uri,\n                extraQueryParams: extraQueryParams,\n                extraTokenParams: extraTokenParams,\n                request_type: request_type,\n                response_mode: response_mode,\n                client_secret: this.settings.client_secret,\n                skipUserInfo: skipUserInfo,\n                nonce: nonce\n              });\n              _context23.next = 11;\n              return this.clearStaleState();\n            case 11:\n              signinState = signinRequest.state;\n              _context23.next = 14;\n              return this.settings.stateStore.set(signinState.id, signinState.toStorageString());\n            case 14:\n              return _context23.abrupt(\"return\", signinRequest);\n            case 15:\n            case \"end\":\n              return _context23.stop();\n          }\n        }, _callee23, this);\n      }));\n      function createSigninRequest(_x27) {\n        return _createSigninRequest.apply(this, arguments);\n      }\n      return createSigninRequest;\n    }()\n  }, {\n    key: \"readSigninResponseState\",\n    value: function () {\n      var _readSigninResponseState = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee24(url) {\n        var removeState,\n          logger2,\n          response,\n          storedStateString,\n          state,\n          _args24 = arguments;\n        return _regeneratorRuntime().wrap(function _callee24$(_context24) {\n          while (1) switch (_context24.prev = _context24.next) {\n            case 0:\n              removeState = _args24.length > 1 && _args24[1] !== undefined ? _args24[1] : false;\n              logger2 = this._logger.create(\"readSigninResponseState\");\n              response = new _SigninResponse(UrlUtils.readParams(url, this.settings.response_mode));\n              if (response.state) {\n                _context24.next = 6;\n                break;\n              }\n              logger2.throw(new Error(\"No state in response\"));\n              throw null;\n            case 6:\n              _context24.next = 8;\n              return this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n            case 8:\n              storedStateString = _context24.sent;\n              if (storedStateString) {\n                _context24.next = 12;\n                break;\n              }\n              logger2.throw(new Error(\"No matching state found in storage\"));\n              throw null;\n            case 12:\n              state = _SigninState.fromStorageString(storedStateString);\n              return _context24.abrupt(\"return\", {\n                state: state,\n                response: response\n              });\n            case 14:\n            case \"end\":\n              return _context24.stop();\n          }\n        }, _callee24, this);\n      }));\n      function readSigninResponseState(_x28) {\n        return _readSigninResponseState.apply(this, arguments);\n      }\n      return readSigninResponseState;\n    }()\n  }, {\n    key: \"processSigninResponse\",\n    value: function () {\n      var _processSigninResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee25(url) {\n        var logger2, _yield$this$readSigni, state, response;\n        return _regeneratorRuntime().wrap(function _callee25$(_context25) {\n          while (1) switch (_context25.prev = _context25.next) {\n            case 0:\n              logger2 = this._logger.create(\"processSigninResponse\");\n              _context25.next = 3;\n              return this.readSigninResponseState(url, true);\n            case 3:\n              _yield$this$readSigni = _context25.sent;\n              state = _yield$this$readSigni.state;\n              response = _yield$this$readSigni.response;\n              logger2.debug(\"received state from storage; validating response\");\n              _context25.next = 9;\n              return this._validator.validateSigninResponse(response, state);\n            case 9:\n              return _context25.abrupt(\"return\", response);\n            case 10:\n            case \"end\":\n              return _context25.stop();\n          }\n        }, _callee25, this);\n      }));\n      function processSigninResponse(_x29) {\n        return _processSigninResponse.apply(this, arguments);\n      }\n      return processSigninResponse;\n    }()\n  }, {\n    key: \"processResourceOwnerPasswordCredentials\",\n    value: function () {\n      var _processResourceOwnerPasswordCredentials = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee26(_ref17) {\n        var username, password, _ref17$skipUserInfo, skipUserInfo, _ref17$extraTokenPara, extraTokenParams, tokenResponse, signinResponse;\n        return _regeneratorRuntime().wrap(function _callee26$(_context26) {\n          while (1) switch (_context26.prev = _context26.next) {\n            case 0:\n              username = _ref17.username, password = _ref17.password, _ref17$skipUserInfo = _ref17.skipUserInfo, skipUserInfo = _ref17$skipUserInfo === void 0 ? false : _ref17$skipUserInfo, _ref17$extraTokenPara = _ref17.extraTokenParams, extraTokenParams = _ref17$extraTokenPara === void 0 ? {} : _ref17$extraTokenPara;\n              _context26.next = 3;\n              return this._tokenClient.exchangeCredentials(_objectSpread({\n                username: username,\n                password: password\n              }, extraTokenParams));\n            case 3:\n              tokenResponse = _context26.sent;\n              signinResponse = new _SigninResponse(new URLSearchParams());\n              Object.assign(signinResponse, tokenResponse);\n              _context26.next = 8;\n              return this._validator.validateCredentialsResponse(signinResponse, skipUserInfo);\n            case 8:\n              return _context26.abrupt(\"return\", signinResponse);\n            case 9:\n            case \"end\":\n              return _context26.stop();\n          }\n        }, _callee26, this);\n      }));\n      function processResourceOwnerPasswordCredentials(_x30) {\n        return _processResourceOwnerPasswordCredentials.apply(this, arguments);\n      }\n      return processResourceOwnerPasswordCredentials;\n    }()\n  }, {\n    key: \"useRefreshToken\",\n    value: function () {\n      var _useRefreshToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee27(_ref18) {\n        var state, timeoutInSeconds, _a, logger2, scope, allowableScopes, providedScopes, result, response;\n        return _regeneratorRuntime().wrap(function _callee27$(_context27) {\n          while (1) switch (_context27.prev = _context27.next) {\n            case 0:\n              state = _ref18.state, timeoutInSeconds = _ref18.timeoutInSeconds;\n              logger2 = this._logger.create(\"useRefreshToken\");\n              if (this.settings.refreshTokenAllowedScope === void 0) {\n                scope = state.scope;\n              } else {\n                allowableScopes = this.settings.refreshTokenAllowedScope.split(\" \");\n                providedScopes = ((_a = state.scope) == null ? void 0 : _a.split(\" \")) || [];\n                scope = providedScopes.filter(function (s) {\n                  return allowableScopes.includes(s);\n                }).join(\" \");\n              }\n              _context27.next = 5;\n              return this._tokenClient.exchangeRefreshToken({\n                refresh_token: state.refresh_token,\n                // provide the (possible filtered) scope list\n                scope: scope,\n                timeoutInSeconds: timeoutInSeconds\n              });\n            case 5:\n              result = _context27.sent;\n              response = new _SigninResponse(new URLSearchParams());\n              Object.assign(response, result);\n              logger2.debug(\"validating response\", response);\n              _context27.next = 11;\n              return this._validator.validateRefreshResponse(response, _objectSpread(_objectSpread({}, state), {}, {\n                // overide the scope in the state handed over to the validator\n                // so it can set the granted scope to the requested scope in case none is included in the response\n                scope: scope\n              }));\n            case 11:\n              return _context27.abrupt(\"return\", response);\n            case 12:\n            case \"end\":\n              return _context27.stop();\n          }\n        }, _callee27, this);\n      }));\n      function useRefreshToken(_x31) {\n        return _useRefreshToken.apply(this, arguments);\n      }\n      return useRefreshToken;\n    }()\n  }, {\n    key: \"createSignoutRequest\",\n    value: function () {\n      var _createSignoutRequest = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee28() {\n        var _ref19,\n          state,\n          id_token_hint,\n          request_type,\n          _ref19$post_logout_re,\n          post_logout_redirect_uri,\n          _ref19$extraQueryPara,\n          extraQueryParams,\n          logger2,\n          url,\n          request,\n          signoutState,\n          _args28 = arguments;\n        return _regeneratorRuntime().wrap(function _callee28$(_context28) {\n          while (1) switch (_context28.prev = _context28.next) {\n            case 0:\n              _ref19 = _args28.length > 0 && _args28[0] !== undefined ? _args28[0] : {}, state = _ref19.state, id_token_hint = _ref19.id_token_hint, request_type = _ref19.request_type, _ref19$post_logout_re = _ref19.post_logout_redirect_uri, post_logout_redirect_uri = _ref19$post_logout_re === void 0 ? this.settings.post_logout_redirect_uri : _ref19$post_logout_re, _ref19$extraQueryPara = _ref19.extraQueryParams, extraQueryParams = _ref19$extraQueryPara === void 0 ? this.settings.extraQueryParams : _ref19$extraQueryPara;\n              logger2 = this._logger.create(\"createSignoutRequest\");\n              _context28.next = 4;\n              return this.metadataService.getEndSessionEndpoint();\n            case 4:\n              url = _context28.sent;\n              if (url) {\n                _context28.next = 8;\n                break;\n              }\n              logger2.throw(new Error(\"No end session endpoint\"));\n              throw null;\n            case 8:\n              logger2.debug(\"Received end session endpoint\", url);\n              request = new SignoutRequest({\n                url: url,\n                id_token_hint: id_token_hint,\n                post_logout_redirect_uri: post_logout_redirect_uri,\n                state_data: state,\n                extraQueryParams: extraQueryParams,\n                request_type: request_type\n              });\n              _context28.next = 12;\n              return this.clearStaleState();\n            case 12:\n              signoutState = request.state;\n              if (!signoutState) {\n                _context28.next = 17;\n                break;\n              }\n              logger2.debug(\"Signout request has state to persist\");\n              _context28.next = 17;\n              return this.settings.stateStore.set(signoutState.id, signoutState.toStorageString());\n            case 17:\n              return _context28.abrupt(\"return\", request);\n            case 18:\n            case \"end\":\n              return _context28.stop();\n          }\n        }, _callee28, this);\n      }));\n      function createSignoutRequest() {\n        return _createSignoutRequest.apply(this, arguments);\n      }\n      return createSignoutRequest;\n    }()\n  }, {\n    key: \"readSignoutResponseState\",\n    value: function () {\n      var _readSignoutResponseState = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee29(url) {\n        var removeState,\n          logger2,\n          response,\n          storedStateString,\n          state,\n          _args29 = arguments;\n        return _regeneratorRuntime().wrap(function _callee29$(_context29) {\n          while (1) switch (_context29.prev = _context29.next) {\n            case 0:\n              removeState = _args29.length > 1 && _args29[1] !== undefined ? _args29[1] : false;\n              logger2 = this._logger.create(\"readSignoutResponseState\");\n              response = new _SignoutResponse(UrlUtils.readParams(url, this.settings.response_mode));\n              if (response.state) {\n                _context29.next = 9;\n                break;\n              }\n              logger2.debug(\"No state in response\");\n              if (!response.error) {\n                _context29.next = 8;\n                break;\n              }\n              logger2.warn(\"Response was error:\", response.error);\n              throw new _ErrorResponse(response);\n            case 8:\n              return _context29.abrupt(\"return\", {\n                state: void 0,\n                response: response\n              });\n            case 9:\n              _context29.next = 11;\n              return this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n            case 11:\n              storedStateString = _context29.sent;\n              if (storedStateString) {\n                _context29.next = 15;\n                break;\n              }\n              logger2.throw(new Error(\"No matching state found in storage\"));\n              throw null;\n            case 15:\n              state = _State.fromStorageString(storedStateString);\n              return _context29.abrupt(\"return\", {\n                state: state,\n                response: response\n              });\n            case 17:\n            case \"end\":\n              return _context29.stop();\n          }\n        }, _callee29, this);\n      }));\n      function readSignoutResponseState(_x32) {\n        return _readSignoutResponseState.apply(this, arguments);\n      }\n      return readSignoutResponseState;\n    }()\n  }, {\n    key: \"processSignoutResponse\",\n    value: function () {\n      var _processSignoutResponse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee30(url) {\n        var logger2, _yield$this$readSigno, state, response;\n        return _regeneratorRuntime().wrap(function _callee30$(_context30) {\n          while (1) switch (_context30.prev = _context30.next) {\n            case 0:\n              logger2 = this._logger.create(\"processSignoutResponse\");\n              _context30.next = 3;\n              return this.readSignoutResponseState(url, true);\n            case 3:\n              _yield$this$readSigno = _context30.sent;\n              state = _yield$this$readSigno.state;\n              response = _yield$this$readSigno.response;\n              if (state) {\n                logger2.debug(\"Received state from storage; validating response\");\n                this._validator.validateSignoutResponse(response, state);\n              } else {\n                logger2.debug(\"No state from storage; skipping response validation\");\n              }\n              return _context30.abrupt(\"return\", response);\n            case 8:\n            case \"end\":\n              return _context30.stop();\n          }\n        }, _callee30, this);\n      }));\n      function processSignoutResponse(_x33) {\n        return _processSignoutResponse.apply(this, arguments);\n      }\n      return processSignoutResponse;\n    }()\n  }, {\n    key: \"clearStaleState\",\n    value: function clearStaleState() {\n      this._logger.create(\"clearStaleState\");\n      return _State.clearStaleState(this.settings.stateStore, this.settings.staleStateAgeInSeconds);\n    }\n  }, {\n    key: \"revokeToken\",\n    value: function () {\n      var _revokeToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee31(token, type) {\n        return _regeneratorRuntime().wrap(function _callee31$(_context31) {\n          while (1) switch (_context31.prev = _context31.next) {\n            case 0:\n              this._logger.create(\"revokeToken\");\n              _context31.next = 3;\n              return this._tokenClient.revoke({\n                token: token,\n                token_type_hint: type\n              });\n            case 3:\n              return _context31.abrupt(\"return\", _context31.sent);\n            case 4:\n            case \"end\":\n              return _context31.stop();\n          }\n        }, _callee31, this);\n      }));\n      function revokeToken(_x34, _x35) {\n        return _revokeToken.apply(this, arguments);\n      }\n      return revokeToken;\n    }()\n  }]);\n  return _OidcClient;\n}();\n\n// src/SessionMonitor.ts\nvar _SessionMonitor = /*#__PURE__*/function () {\n  function _SessionMonitor(_userManager) {\n    var _this10 = this;\n    _classCallCheck(this, _SessionMonitor);\n    this._userManager = _userManager;\n    this._logger = new _Logger(\"SessionMonitor\");\n    this._start = /*#__PURE__*/function () {\n      var _ref20 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee32(user) {\n        var session_state, logger2, url, client_id, intervalInSeconds, stopOnError, checkSessionIFrame;\n        return _regeneratorRuntime().wrap(function _callee32$(_context32) {\n          while (1) switch (_context32.prev = _context32.next) {\n            case 0:\n              session_state = user.session_state;\n              if (session_state) {\n                _context32.next = 3;\n                break;\n              }\n              return _context32.abrupt(\"return\");\n            case 3:\n              logger2 = _this10._logger.create(\"_start\");\n              if (user.profile) {\n                _this10._sub = user.profile.sub;\n                _this10._sid = user.profile.sid;\n                logger2.debug(\"session_state\", session_state, \", sub\", _this10._sub);\n              } else {\n                _this10._sub = void 0;\n                _this10._sid = void 0;\n                logger2.debug(\"session_state\", session_state, \", anonymous user\");\n              }\n              if (!_this10._checkSessionIFrame) {\n                _context32.next = 8;\n                break;\n              }\n              _this10._checkSessionIFrame.start(session_state);\n              return _context32.abrupt(\"return\");\n            case 8:\n              _context32.prev = 8;\n              _context32.next = 11;\n              return _this10._userManager.metadataService.getCheckSessionIframe();\n            case 11:\n              url = _context32.sent;\n              if (!url) {\n                _context32.next = 24;\n                break;\n              }\n              logger2.debug(\"initializing check session iframe\");\n              client_id = _this10._userManager.settings.client_id;\n              intervalInSeconds = _this10._userManager.settings.checkSessionIntervalInSeconds;\n              stopOnError = _this10._userManager.settings.stopCheckSessionOnError;\n              checkSessionIFrame = new _CheckSessionIFrame(_this10._callback, client_id, url, intervalInSeconds, stopOnError);\n              _context32.next = 20;\n              return checkSessionIFrame.load();\n            case 20:\n              _this10._checkSessionIFrame = checkSessionIFrame;\n              checkSessionIFrame.start(session_state);\n              _context32.next = 25;\n              break;\n            case 24:\n              logger2.warn(\"no check session iframe found in the metadata\");\n            case 25:\n              _context32.next = 30;\n              break;\n            case 27:\n              _context32.prev = 27;\n              _context32.t0 = _context32[\"catch\"](8);\n              logger2.error(\"Error from getCheckSessionIframe:\", _context32.t0 instanceof Error ? _context32.t0.message : _context32.t0);\n            case 30:\n            case \"end\":\n              return _context32.stop();\n          }\n        }, _callee32, null, [[8, 27]]);\n      }));\n      return function (_x36) {\n        return _ref20.apply(this, arguments);\n      };\n    }();\n    this._stop = function () {\n      var logger2 = _this10._logger.create(\"_stop\");\n      _this10._sub = void 0;\n      _this10._sid = void 0;\n      if (_this10._checkSessionIFrame) {\n        _this10._checkSessionIFrame.stop();\n      }\n      if (_this10._userManager.settings.monitorAnonymousSession) {\n        var timerHandle = setInterval( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee33() {\n          var session, tmpUser;\n          return _regeneratorRuntime().wrap(function _callee33$(_context33) {\n            while (1) switch (_context33.prev = _context33.next) {\n              case 0:\n                clearInterval(timerHandle);\n                _context33.prev = 1;\n                _context33.next = 4;\n                return _this10._userManager.querySessionStatus();\n              case 4:\n                session = _context33.sent;\n                if (session) {\n                  tmpUser = {\n                    session_state: session.session_state,\n                    profile: session.sub && session.sid ? {\n                      sub: session.sub,\n                      sid: session.sid\n                    } : null\n                  };\n                  void _this10._start(tmpUser);\n                }\n                _context33.next = 11;\n                break;\n              case 8:\n                _context33.prev = 8;\n                _context33.t0 = _context33[\"catch\"](1);\n                logger2.error(\"error from querySessionStatus\", _context33.t0 instanceof Error ? _context33.t0.message : _context33.t0);\n              case 11:\n              case \"end\":\n                return _context33.stop();\n            }\n          }, _callee33, null, [[1, 8]]);\n        })), 1e3);\n      }\n    };\n    this._callback = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee34() {\n      var logger2, session, raiseEvent;\n      return _regeneratorRuntime().wrap(function _callee34$(_context34) {\n        while (1) switch (_context34.prev = _context34.next) {\n          case 0:\n            logger2 = _this10._logger.create(\"_callback\");\n            _context34.prev = 1;\n            _context34.next = 4;\n            return _this10._userManager.querySessionStatus();\n          case 4:\n            session = _context34.sent;\n            raiseEvent = true;\n            if (session && _this10._checkSessionIFrame) {\n              if (session.sub === _this10._sub) {\n                raiseEvent = false;\n                _this10._checkSessionIFrame.start(session.session_state);\n                if (session.sid === _this10._sid) {\n                  logger2.debug(\"same sub still logged in at OP, restarting check session iframe; session_state\", session.session_state);\n                } else {\n                  logger2.debug(\"same sub still logged in at OP, session state has changed, restarting check session iframe; session_state\", session.session_state);\n                  _this10._userManager.events._raiseUserSessionChanged();\n                }\n              } else {\n                logger2.debug(\"different subject signed into OP\", session.sub);\n              }\n            } else {\n              logger2.debug(\"subject no longer signed into OP\");\n            }\n            if (raiseEvent) {\n              if (_this10._sub) {\n                _this10._userManager.events._raiseUserSignedOut();\n              } else {\n                _this10._userManager.events._raiseUserSignedIn();\n              }\n            } else {\n              logger2.debug(\"no change in session detected, no event to raise\");\n            }\n            _context34.next = 13;\n            break;\n          case 10:\n            _context34.prev = 10;\n            _context34.t0 = _context34[\"catch\"](1);\n            if (_this10._sub) {\n              logger2.debug(\"Error calling queryCurrentSigninSession; raising signed out event\", _context34.t0);\n              _this10._userManager.events._raiseUserSignedOut();\n            }\n          case 13:\n          case \"end\":\n            return _context34.stop();\n        }\n      }, _callee34, null, [[1, 10]]);\n    }));\n    if (!_userManager) {\n      this._logger.throw(new Error(\"No user manager passed\"));\n    }\n    this._userManager.events.addUserLoaded(this._start);\n    this._userManager.events.addUserUnloaded(this._stop);\n    this._init().catch(function (err) {\n      _this10._logger.error(err);\n    });\n  }\n  _createClass(_SessionMonitor, [{\n    key: \"_init\",\n    value: function () {\n      var _init2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee35() {\n        var user, session, tmpUser;\n        return _regeneratorRuntime().wrap(function _callee35$(_context35) {\n          while (1) switch (_context35.prev = _context35.next) {\n            case 0:\n              this._logger.create(\"_init\");\n              _context35.next = 3;\n              return this._userManager.getUser();\n            case 3:\n              user = _context35.sent;\n              if (!user) {\n                _context35.next = 8;\n                break;\n              }\n              void this._start(user);\n              _context35.next = 13;\n              break;\n            case 8:\n              if (!this._userManager.settings.monitorAnonymousSession) {\n                _context35.next = 13;\n                break;\n              }\n              _context35.next = 11;\n              return this._userManager.querySessionStatus();\n            case 11:\n              session = _context35.sent;\n              if (session) {\n                tmpUser = {\n                  session_state: session.session_state,\n                  profile: session.sub && session.sid ? {\n                    sub: session.sub,\n                    sid: session.sid\n                  } : null\n                };\n                void this._start(tmpUser);\n              }\n            case 13:\n            case \"end\":\n              return _context35.stop();\n          }\n        }, _callee35, this);\n      }));\n      function _init() {\n        return _init2.apply(this, arguments);\n      }\n      return _init;\n    }()\n  }]);\n  return _SessionMonitor;\n}();\n\n// src/User.ts\nvar _User = /*#__PURE__*/function () {\n  function _User(args) {\n    _classCallCheck(this, _User);\n    var _a;\n    this.id_token = args.id_token;\n    this.session_state = (_a = args.session_state) != null ? _a : null;\n    this.access_token = args.access_token;\n    this.refresh_token = args.refresh_token;\n    this.token_type = args.token_type;\n    this.scope = args.scope;\n    this.profile = args.profile;\n    this.expires_at = args.expires_at;\n    this.state = args.userState;\n  }\n  /** Computed number of seconds the access token has remaining. */\n  _createClass(_User, [{\n    key: \"expires_in\",\n    get: function get() {\n      if (this.expires_at === void 0) {\n        return void 0;\n      }\n      return this.expires_at - Timer.getEpochTime();\n    },\n    set: function set(value) {\n      if (value !== void 0) {\n        this.expires_at = Math.floor(value) + Timer.getEpochTime();\n      }\n    }\n    /** Computed value indicating if the access token is expired. */\n  }, {\n    key: \"expired\",\n    get: function get() {\n      var expires_in = this.expires_in;\n      if (expires_in === void 0) {\n        return void 0;\n      }\n      return expires_in <= 0;\n    }\n    /** Array representing the parsed values from the `scope`. */\n  }, {\n    key: \"scopes\",\n    get: function get() {\n      var _a, _b;\n      return (_b = (_a = this.scope) == null ? void 0 : _a.split(\" \")) != null ? _b : [];\n    }\n  }, {\n    key: \"toStorageString\",\n    value: function toStorageString() {\n      new _Logger(\"User\").create(\"toStorageString\");\n      return JSON.stringify({\n        id_token: this.id_token,\n        session_state: this.session_state,\n        access_token: this.access_token,\n        refresh_token: this.refresh_token,\n        token_type: this.token_type,\n        scope: this.scope,\n        profile: this.profile,\n        expires_at: this.expires_at\n      });\n    }\n  }], [{\n    key: \"fromStorageString\",\n    value: function fromStorageString(storageString) {\n      _Logger.createStatic(\"User\", \"fromStorageString\");\n      return new _User(JSON.parse(storageString));\n    }\n  }]);\n  return _User;\n}();\n\n// src/navigators/AbstractChildWindow.ts\nvar messageSource = \"oidc-client\";\nvar AbstractChildWindow = /*#__PURE__*/function () {\n  function AbstractChildWindow() {\n    _classCallCheck(this, AbstractChildWindow);\n    this._abort = new Event(\"Window navigation aborted\");\n    this._disposeHandlers = /* @__PURE__ */new Set();\n    this._window = null;\n  }\n  _createClass(AbstractChildWindow, [{\n    key: \"navigate\",\n    value: function () {\n      var _navigate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee36(params) {\n        var _this11 = this;\n        var logger2, _yield$Promise, url, keepOpen;\n        return _regeneratorRuntime().wrap(function _callee36$(_context36) {\n          while (1) switch (_context36.prev = _context36.next) {\n            case 0:\n              logger2 = this._logger.create(\"navigate\");\n              if (this._window) {\n                _context36.next = 3;\n                break;\n              }\n              throw new Error(\"Attempted to navigate on a disposed window\");\n            case 3:\n              logger2.debug(\"setting URL in window\");\n              this._window.location.replace(params.url);\n              _context36.next = 7;\n              return new Promise(function (resolve, reject) {\n                var listener = function listener(e) {\n                  var _a;\n                  var data = e.data;\n                  var origin = (_a = params.scriptOrigin) != null ? _a : window.location.origin;\n                  if (e.origin !== origin || (data == null ? void 0 : data.source) !== messageSource) {\n                    return;\n                  }\n                  try {\n                    var state = UrlUtils.readParams(data.url, params.response_mode).get(\"state\");\n                    if (!state) {\n                      logger2.warn(\"no state found in response url\");\n                    }\n                    if (e.source !== _this11._window && state !== params.state) {\n                      return;\n                    }\n                  } catch (err) {\n                    _this11._dispose();\n                    reject(new Error(\"Invalid response from window\"));\n                  }\n                  resolve(data);\n                };\n                window.addEventListener(\"message\", listener, false);\n                _this11._disposeHandlers.add(function () {\n                  return window.removeEventListener(\"message\", listener, false);\n                });\n                _this11._disposeHandlers.add(_this11._abort.addHandler(function (reason) {\n                  _this11._dispose();\n                  reject(reason);\n                }));\n              });\n            case 7:\n              _yield$Promise = _context36.sent;\n              url = _yield$Promise.url;\n              keepOpen = _yield$Promise.keepOpen;\n              logger2.debug(\"got response from window\");\n              this._dispose();\n              if (!keepOpen) {\n                this.close();\n              }\n              return _context36.abrupt(\"return\", {\n                url: url\n              });\n            case 14:\n            case \"end\":\n              return _context36.stop();\n          }\n        }, _callee36, this);\n      }));\n      function navigate(_x37) {\n        return _navigate.apply(this, arguments);\n      }\n      return navigate;\n    }()\n  }, {\n    key: \"_dispose\",\n    value: function _dispose() {\n      this._logger.create(\"_dispose\");\n      var _iterator5 = _createForOfIteratorHelper(this._disposeHandlers),\n        _step5;\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var dispose = _step5.value;\n          dispose();\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n      this._disposeHandlers.clear();\n    }\n  }], [{\n    key: \"_notifyParent\",\n    value: function _notifyParent(parent, url) {\n      var keepOpen = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var targetOrigin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : window.location.origin;\n      parent.postMessage({\n        source: messageSource,\n        url: url,\n        keepOpen: keepOpen\n      }, targetOrigin);\n    }\n  }]);\n  return AbstractChildWindow;\n}();\n\n// src/UserManagerSettings.ts\nvar DefaultPopupWindowFeatures = {\n  location: false,\n  toolbar: false,\n  height: 640\n};\nvar DefaultPopupTarget = \"_blank\";\nvar DefaultAccessTokenExpiringNotificationTimeInSeconds = 60;\nvar DefaultCheckSessionIntervalInSeconds = 2;\nvar DefaultSilentRequestTimeoutInSeconds = 10;\nvar _UserManagerSettingsStore = /*#__PURE__*/function (_OidcClientSettingsSt) {\n  _inherits(_UserManagerSettingsStore, _OidcClientSettingsSt);\n  var _super5 = _createSuper(_UserManagerSettingsStore);\n  function _UserManagerSettingsStore(args) {\n    var _this12;\n    _classCallCheck(this, _UserManagerSettingsStore);\n    var _args$popup_redirect_ = args.popup_redirect_uri,\n      popup_redirect_uri = _args$popup_redirect_ === void 0 ? args.redirect_uri : _args$popup_redirect_,\n      _args$popup_post_logo = args.popup_post_logout_redirect_uri,\n      popup_post_logout_redirect_uri = _args$popup_post_logo === void 0 ? args.post_logout_redirect_uri : _args$popup_post_logo,\n      _args$popupWindowFeat = args.popupWindowFeatures,\n      popupWindowFeatures = _args$popupWindowFeat === void 0 ? DefaultPopupWindowFeatures : _args$popupWindowFeat,\n      _args$popupWindowTarg = args.popupWindowTarget,\n      popupWindowTarget = _args$popupWindowTarg === void 0 ? DefaultPopupTarget : _args$popupWindowTarg,\n      _args$redirectMethod = args.redirectMethod,\n      redirectMethod = _args$redirectMethod === void 0 ? \"assign\" : _args$redirectMethod,\n      _args$redirectTarget = args.redirectTarget,\n      redirectTarget = _args$redirectTarget === void 0 ? \"self\" : _args$redirectTarget,\n      _args$iframeNotifyPar = args.iframeNotifyParentOrigin,\n      iframeNotifyParentOrigin = _args$iframeNotifyPar === void 0 ? args.iframeNotifyParentOrigin : _args$iframeNotifyPar,\n      _args$iframeScriptOri = args.iframeScriptOrigin,\n      iframeScriptOrigin = _args$iframeScriptOri === void 0 ? args.iframeScriptOrigin : _args$iframeScriptOri,\n      _args$silent_redirect = args.silent_redirect_uri,\n      silent_redirect_uri = _args$silent_redirect === void 0 ? args.redirect_uri : _args$silent_redirect,\n      _args$silentRequestTi = args.silentRequestTimeoutInSeconds,\n      silentRequestTimeoutInSeconds = _args$silentRequestTi === void 0 ? DefaultSilentRequestTimeoutInSeconds : _args$silentRequestTi,\n      _args$automaticSilent = args.automaticSilentRenew,\n      automaticSilentRenew = _args$automaticSilent === void 0 ? true : _args$automaticSilent,\n      _args$validateSubOnSi = args.validateSubOnSilentRenew,\n      validateSubOnSilentRenew = _args$validateSubOnSi === void 0 ? true : _args$validateSubOnSi,\n      _args$includeIdTokenI = args.includeIdTokenInSilentRenew,\n      includeIdTokenInSilentRenew = _args$includeIdTokenI === void 0 ? false : _args$includeIdTokenI,\n      _args$monitorSession = args.monitorSession,\n      monitorSession = _args$monitorSession === void 0 ? false : _args$monitorSession,\n      _args$monitorAnonymou = args.monitorAnonymousSession,\n      monitorAnonymousSession = _args$monitorAnonymou === void 0 ? false : _args$monitorAnonymou,\n      _args$checkSessionInt = args.checkSessionIntervalInSeconds,\n      checkSessionIntervalInSeconds = _args$checkSessionInt === void 0 ? DefaultCheckSessionIntervalInSeconds : _args$checkSessionInt,\n      _args$query_status_re = args.query_status_response_type,\n      query_status_response_type = _args$query_status_re === void 0 ? \"code\" : _args$query_status_re,\n      _args$stopCheckSessio = args.stopCheckSessionOnError,\n      stopCheckSessionOnError = _args$stopCheckSessio === void 0 ? true : _args$stopCheckSessio,\n      _args$revokeTokenType = args.revokeTokenTypes,\n      revokeTokenTypes = _args$revokeTokenType === void 0 ? [\"access_token\", \"refresh_token\"] : _args$revokeTokenType,\n      _args$revokeTokensOnS = args.revokeTokensOnSignout,\n      revokeTokensOnSignout = _args$revokeTokensOnS === void 0 ? false : _args$revokeTokensOnS,\n      _args$includeIdTokenI2 = args.includeIdTokenInSilentSignout,\n      includeIdTokenInSilentSignout = _args$includeIdTokenI2 === void 0 ? false : _args$includeIdTokenI2,\n      _args$accessTokenExpi = args.accessTokenExpiringNotificationTimeInSeconds,\n      accessTokenExpiringNotificationTimeInSeconds = _args$accessTokenExpi === void 0 ? DefaultAccessTokenExpiringNotificationTimeInSeconds : _args$accessTokenExpi,\n      userStore = args.userStore;\n    _this12 = _super5.call(this, args);\n    _this12.popup_redirect_uri = popup_redirect_uri;\n    _this12.popup_post_logout_redirect_uri = popup_post_logout_redirect_uri;\n    _this12.popupWindowFeatures = popupWindowFeatures;\n    _this12.popupWindowTarget = popupWindowTarget;\n    _this12.redirectMethod = redirectMethod;\n    _this12.redirectTarget = redirectTarget;\n    _this12.iframeNotifyParentOrigin = iframeNotifyParentOrigin;\n    _this12.iframeScriptOrigin = iframeScriptOrigin;\n    _this12.silent_redirect_uri = silent_redirect_uri;\n    _this12.silentRequestTimeoutInSeconds = silentRequestTimeoutInSeconds;\n    _this12.automaticSilentRenew = automaticSilentRenew;\n    _this12.validateSubOnSilentRenew = validateSubOnSilentRenew;\n    _this12.includeIdTokenInSilentRenew = includeIdTokenInSilentRenew;\n    _this12.monitorSession = monitorSession;\n    _this12.monitorAnonymousSession = monitorAnonymousSession;\n    _this12.checkSessionIntervalInSeconds = checkSessionIntervalInSeconds;\n    _this12.stopCheckSessionOnError = stopCheckSessionOnError;\n    _this12.query_status_response_type = query_status_response_type;\n    _this12.revokeTokenTypes = revokeTokenTypes;\n    _this12.revokeTokensOnSignout = revokeTokensOnSignout;\n    _this12.includeIdTokenInSilentSignout = includeIdTokenInSilentSignout;\n    _this12.accessTokenExpiringNotificationTimeInSeconds = accessTokenExpiringNotificationTimeInSeconds;\n    if (userStore) {\n      _this12.userStore = userStore;\n    } else {\n      var store = typeof window !== \"undefined\" ? window.sessionStorage : new _InMemoryWebStorage();\n      _this12.userStore = new _WebStorageStateStore({\n        store: store\n      });\n    }\n    return _this12;\n  }\n  return _createClass(_UserManagerSettingsStore);\n}(_OidcClientSettingsStore);\n\n// src/navigators/IFrameWindow.ts\nvar IFrameWindow = /*#__PURE__*/function (_AbstractChildWindow) {\n  _inherits(IFrameWindow, _AbstractChildWindow);\n  var _super6 = _createSuper(IFrameWindow);\n  function IFrameWindow(_ref23) {\n    var _this13;\n    var _ref23$silentRequestT = _ref23.silentRequestTimeoutInSeconds,\n      silentRequestTimeoutInSeconds = _ref23$silentRequestT === void 0 ? DefaultSilentRequestTimeoutInSeconds : _ref23$silentRequestT;\n    _classCallCheck(this, IFrameWindow);\n    _this13 = _super6.call(this);\n    _this13._logger = new _Logger(\"IFrameWindow\");\n    _this13._timeoutInSeconds = silentRequestTimeoutInSeconds;\n    _this13._frame = IFrameWindow.createHiddenIframe();\n    _this13._window = _this13._frame.contentWindow;\n    return _this13;\n  }\n  _createClass(IFrameWindow, [{\n    key: \"navigate\",\n    value: function () {\n      var _navigate2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee37(params) {\n        var _this14 = this;\n        var timer;\n        return _regeneratorRuntime().wrap(function _callee37$(_context37) {\n          while (1) switch (_context37.prev = _context37.next) {\n            case 0:\n              this._logger.debug(\"navigate: Using timeout of:\", this._timeoutInSeconds);\n              timer = setTimeout(function () {\n                return _this14._abort.raise(new _ErrorTimeout(\"IFrame timed out without a response\"));\n              }, this._timeoutInSeconds * 1e3);\n              this._disposeHandlers.add(function () {\n                return clearTimeout(timer);\n              });\n              _context37.next = 5;\n              return _get(_getPrototypeOf(IFrameWindow.prototype), \"navigate\", this).call(this, params);\n            case 5:\n              return _context37.abrupt(\"return\", _context37.sent);\n            case 6:\n            case \"end\":\n              return _context37.stop();\n          }\n        }, _callee37, this);\n      }));\n      function navigate(_x38) {\n        return _navigate2.apply(this, arguments);\n      }\n      return navigate;\n    }()\n  }, {\n    key: \"close\",\n    value: function close() {\n      var _this15 = this;\n      var _a;\n      if (this._frame) {\n        if (this._frame.parentNode) {\n          this._frame.addEventListener(\"load\", function (ev) {\n            var _a2;\n            var frame = ev.target;\n            (_a2 = frame.parentNode) == null ? void 0 : _a2.removeChild(frame);\n            _this15._abort.raise(new Error(\"IFrame removed from DOM\"));\n          }, true);\n          (_a = this._frame.contentWindow) == null ? void 0 : _a.location.replace(\"about:blank\");\n        }\n        this._frame = null;\n      }\n      this._window = null;\n    }\n  }], [{\n    key: \"createHiddenIframe\",\n    value: function createHiddenIframe() {\n      var iframe = window.document.createElement(\"iframe\");\n      iframe.style.visibility = \"hidden\";\n      iframe.style.position = \"fixed\";\n      iframe.style.left = \"-1000px\";\n      iframe.style.top = \"0\";\n      iframe.width = \"0\";\n      iframe.height = \"0\";\n      iframe.setAttribute(\"sandbox\", \"allow-scripts allow-same-origin allow-forms\");\n      window.document.body.appendChild(iframe);\n      return iframe;\n    }\n  }, {\n    key: \"notifyParent\",\n    value: function notifyParent(url, targetOrigin) {\n      return _get(_getPrototypeOf(IFrameWindow), \"_notifyParent\", this).call(this, window.parent, url, false, targetOrigin);\n    }\n  }]);\n  return IFrameWindow;\n}(AbstractChildWindow);\n\n// src/navigators/IFrameNavigator.ts\nvar IFrameNavigator = /*#__PURE__*/function () {\n  function IFrameNavigator(_settings) {\n    _classCallCheck(this, IFrameNavigator);\n    this._settings = _settings;\n    this._logger = new _Logger(\"IFrameNavigator\");\n  }\n  _createClass(IFrameNavigator, [{\n    key: \"prepare\",\n    value: function () {\n      var _prepare = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee38(_ref24) {\n        var _ref24$silentRequestT, silentRequestTimeoutInSeconds;\n        return _regeneratorRuntime().wrap(function _callee38$(_context38) {\n          while (1) switch (_context38.prev = _context38.next) {\n            case 0:\n              _ref24$silentRequestT = _ref24.silentRequestTimeoutInSeconds, silentRequestTimeoutInSeconds = _ref24$silentRequestT === void 0 ? this._settings.silentRequestTimeoutInSeconds : _ref24$silentRequestT;\n              return _context38.abrupt(\"return\", new IFrameWindow({\n                silentRequestTimeoutInSeconds: silentRequestTimeoutInSeconds\n              }));\n            case 2:\n            case \"end\":\n              return _context38.stop();\n          }\n        }, _callee38, this);\n      }));\n      function prepare(_x39) {\n        return _prepare.apply(this, arguments);\n      }\n      return prepare;\n    }()\n  }, {\n    key: \"callback\",\n    value: function () {\n      var _callback2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee39(url) {\n        return _regeneratorRuntime().wrap(function _callee39$(_context39) {\n          while (1) switch (_context39.prev = _context39.next) {\n            case 0:\n              this._logger.create(\"callback\");\n              IFrameWindow.notifyParent(url, this._settings.iframeNotifyParentOrigin);\n            case 2:\n            case \"end\":\n              return _context39.stop();\n          }\n        }, _callee39, this);\n      }));\n      function callback(_x40) {\n        return _callback2.apply(this, arguments);\n      }\n      return callback;\n    }()\n  }]);\n  return IFrameNavigator;\n}();\n\n// src/navigators/PopupWindow.ts\nvar checkForPopupClosedInterval = 500;\nvar PopupWindow = /*#__PURE__*/function (_AbstractChildWindow2) {\n  _inherits(PopupWindow, _AbstractChildWindow2);\n  var _super7 = _createSuper(PopupWindow);\n  function PopupWindow(_ref25) {\n    var _this16;\n    var _ref25$popupWindowTar = _ref25.popupWindowTarget,\n      popupWindowTarget = _ref25$popupWindowTar === void 0 ? DefaultPopupTarget : _ref25$popupWindowTar,\n      _ref25$popupWindowFea = _ref25.popupWindowFeatures,\n      popupWindowFeatures = _ref25$popupWindowFea === void 0 ? {} : _ref25$popupWindowFea;\n    _classCallCheck(this, PopupWindow);\n    _this16 = _super7.call(this);\n    _this16._logger = new _Logger(\"PopupWindow\");\n    var centeredPopup = PopupUtils.center(_objectSpread(_objectSpread({}, DefaultPopupWindowFeatures), popupWindowFeatures));\n    _this16._window = window.open(void 0, popupWindowTarget, PopupUtils.serialize(centeredPopup));\n    return _this16;\n  }\n  _createClass(PopupWindow, [{\n    key: \"navigate\",\n    value: function () {\n      var _navigate3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee40(params) {\n        var _this17 = this;\n        var _a, popupClosedInterval;\n        return _regeneratorRuntime().wrap(function _callee40$(_context40) {\n          while (1) switch (_context40.prev = _context40.next) {\n            case 0:\n              (_a = this._window) == null ? void 0 : _a.focus();\n              popupClosedInterval = setInterval(function () {\n                if (!_this17._window || _this17._window.closed) {\n                  _this17._abort.raise(new Error(\"Popup closed by user\"));\n                }\n              }, checkForPopupClosedInterval);\n              this._disposeHandlers.add(function () {\n                return clearInterval(popupClosedInterval);\n              });\n              _context40.next = 5;\n              return _get(_getPrototypeOf(PopupWindow.prototype), \"navigate\", this).call(this, params);\n            case 5:\n              return _context40.abrupt(\"return\", _context40.sent);\n            case 6:\n            case \"end\":\n              return _context40.stop();\n          }\n        }, _callee40, this);\n      }));\n      function navigate(_x41) {\n        return _navigate3.apply(this, arguments);\n      }\n      return navigate;\n    }()\n  }, {\n    key: \"close\",\n    value: function close() {\n      if (this._window) {\n        if (!this._window.closed) {\n          this._window.close();\n          this._abort.raise(new Error(\"Popup closed\"));\n        }\n      }\n      this._window = null;\n    }\n  }], [{\n    key: \"notifyOpener\",\n    value: function notifyOpener(url, keepOpen) {\n      if (!window.opener) {\n        throw new Error(\"No window.opener. Can't complete notification.\");\n      }\n      return _get(_getPrototypeOf(PopupWindow), \"_notifyParent\", this).call(this, window.opener, url, keepOpen);\n    }\n  }]);\n  return PopupWindow;\n}(AbstractChildWindow);\n\n// src/navigators/PopupNavigator.ts\nvar PopupNavigator = /*#__PURE__*/function () {\n  function PopupNavigator(_settings) {\n    _classCallCheck(this, PopupNavigator);\n    this._settings = _settings;\n    this._logger = new _Logger(\"PopupNavigator\");\n  }\n  _createClass(PopupNavigator, [{\n    key: \"prepare\",\n    value: function () {\n      var _prepare2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee41(_ref26) {\n        var _ref26$popupWindowFea, popupWindowFeatures, _ref26$popupWindowTar, popupWindowTarget;\n        return _regeneratorRuntime().wrap(function _callee41$(_context41) {\n          while (1) switch (_context41.prev = _context41.next) {\n            case 0:\n              _ref26$popupWindowFea = _ref26.popupWindowFeatures, popupWindowFeatures = _ref26$popupWindowFea === void 0 ? this._settings.popupWindowFeatures : _ref26$popupWindowFea, _ref26$popupWindowTar = _ref26.popupWindowTarget, popupWindowTarget = _ref26$popupWindowTar === void 0 ? this._settings.popupWindowTarget : _ref26$popupWindowTar;\n              return _context41.abrupt(\"return\", new PopupWindow({\n                popupWindowFeatures: popupWindowFeatures,\n                popupWindowTarget: popupWindowTarget\n              }));\n            case 2:\n            case \"end\":\n              return _context41.stop();\n          }\n        }, _callee41, this);\n      }));\n      function prepare(_x42) {\n        return _prepare2.apply(this, arguments);\n      }\n      return prepare;\n    }()\n  }, {\n    key: \"callback\",\n    value: function () {\n      var _callback3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee42(url) {\n        var keepOpen,\n          _args42 = arguments;\n        return _regeneratorRuntime().wrap(function _callee42$(_context42) {\n          while (1) switch (_context42.prev = _context42.next) {\n            case 0:\n              keepOpen = _args42.length > 1 && _args42[1] !== undefined ? _args42[1] : false;\n              this._logger.create(\"callback\");\n              PopupWindow.notifyOpener(url, keepOpen);\n            case 3:\n            case \"end\":\n              return _context42.stop();\n          }\n        }, _callee42, this);\n      }));\n      function callback(_x43) {\n        return _callback3.apply(this, arguments);\n      }\n      return callback;\n    }()\n  }]);\n  return PopupNavigator;\n}();\n\n// src/navigators/RedirectNavigator.ts\nvar RedirectNavigator = /*#__PURE__*/function () {\n  function RedirectNavigator(_settings) {\n    _classCallCheck(this, RedirectNavigator);\n    this._settings = _settings;\n    this._logger = new _Logger(\"RedirectNavigator\");\n  }\n  _createClass(RedirectNavigator, [{\n    key: \"prepare\",\n    value: function () {\n      var _prepare3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee44(_ref27) {\n        var _this18 = this;\n        var _ref27$redirectMethod, redirectMethod, _ref27$redirectTarget, redirectTarget, _a, targetWindow, redirect, abort;\n        return _regeneratorRuntime().wrap(function _callee44$(_context44) {\n          while (1) switch (_context44.prev = _context44.next) {\n            case 0:\n              _ref27$redirectMethod = _ref27.redirectMethod, redirectMethod = _ref27$redirectMethod === void 0 ? this._settings.redirectMethod : _ref27$redirectMethod, _ref27$redirectTarget = _ref27.redirectTarget, redirectTarget = _ref27$redirectTarget === void 0 ? this._settings.redirectTarget : _ref27$redirectTarget;\n              this._logger.create(\"prepare\");\n              targetWindow = window.self;\n              if (redirectTarget === \"top\") {\n                targetWindow = (_a = window.top) != null ? _a : window.self;\n              }\n              redirect = targetWindow.location[redirectMethod].bind(targetWindow.location);\n              return _context44.abrupt(\"return\", {\n                navigate: function () {\n                  var _navigate4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee43(params) {\n                    var promise;\n                    return _regeneratorRuntime().wrap(function _callee43$(_context43) {\n                      while (1) switch (_context43.prev = _context43.next) {\n                        case 0:\n                          _this18._logger.create(\"navigate\");\n                          promise = new Promise(function (resolve, reject) {\n                            abort = reject;\n                          });\n                          redirect(params.url);\n                          _context43.next = 5;\n                          return promise;\n                        case 5:\n                          return _context43.abrupt(\"return\", _context43.sent);\n                        case 6:\n                        case \"end\":\n                          return _context43.stop();\n                      }\n                    }, _callee43);\n                  }));\n                  function navigate(_x45) {\n                    return _navigate4.apply(this, arguments);\n                  }\n                  return navigate;\n                }(),\n                close: function close() {\n                  _this18._logger.create(\"close\");\n                  abort == null ? void 0 : abort(new Error(\"Redirect aborted\"));\n                  targetWindow.stop();\n                }\n              });\n            case 6:\n            case \"end\":\n              return _context44.stop();\n          }\n        }, _callee44, this);\n      }));\n      function prepare(_x44) {\n        return _prepare3.apply(this, arguments);\n      }\n      return prepare;\n    }()\n  }]);\n  return RedirectNavigator;\n}();\n\n// src/UserManagerEvents.ts\nvar UserManagerEvents = /*#__PURE__*/function (_AccessTokenEvents2) {\n  _inherits(UserManagerEvents, _AccessTokenEvents2);\n  var _super8 = _createSuper(UserManagerEvents);\n  function UserManagerEvents(settings) {\n    var _this19;\n    _classCallCheck(this, UserManagerEvents);\n    _this19 = _super8.call(this, {\n      expiringNotificationTimeInSeconds: settings.accessTokenExpiringNotificationTimeInSeconds\n    });\n    _this19._logger = new _Logger(\"UserManagerEvents\");\n    _this19._userLoaded = new Event(\"User loaded\");\n    _this19._userUnloaded = new Event(\"User unloaded\");\n    _this19._silentRenewError = new Event(\"Silent renew error\");\n    _this19._userSignedIn = new Event(\"User signed in\");\n    _this19._userSignedOut = new Event(\"User signed out\");\n    _this19._userSessionChanged = new Event(\"User session changed\");\n    return _this19;\n  }\n  _createClass(UserManagerEvents, [{\n    key: \"load\",\n    value: function load(user) {\n      var raiseEvent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      _get(_getPrototypeOf(UserManagerEvents.prototype), \"load\", this).call(this, user);\n      if (raiseEvent) {\n        this._userLoaded.raise(user);\n      }\n    }\n  }, {\n    key: \"unload\",\n    value: function unload() {\n      _get(_getPrototypeOf(UserManagerEvents.prototype), \"unload\", this).call(this);\n      this._userUnloaded.raise();\n    }\n    /**\n     * Add callback: Raised when a user session has been established (or re-established).\n     */\n  }, {\n    key: \"addUserLoaded\",\n    value: function addUserLoaded(cb) {\n      return this._userLoaded.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when a user session has been established (or re-established).\n     */\n  }, {\n    key: \"removeUserLoaded\",\n    value: function removeUserLoaded(cb) {\n      return this._userLoaded.removeHandler(cb);\n    }\n    /**\n     * Add callback: Raised when a user session has been terminated.\n     */\n  }, {\n    key: \"addUserUnloaded\",\n    value: function addUserUnloaded(cb) {\n      return this._userUnloaded.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when a user session has been terminated.\n     */\n  }, {\n    key: \"removeUserUnloaded\",\n    value: function removeUserUnloaded(cb) {\n      return this._userUnloaded.removeHandler(cb);\n    }\n    /**\n     * Add callback: Raised when the automatic silent renew has failed.\n     */\n  }, {\n    key: \"addSilentRenewError\",\n    value: function addSilentRenewError(cb) {\n      return this._silentRenewError.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the automatic silent renew has failed.\n     */\n  }, {\n    key: \"removeSilentRenewError\",\n    value: function removeSilentRenewError(cb) {\n      return this._silentRenewError.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_raiseSilentRenewError\",\n    value: function _raiseSilentRenewError(e) {\n      this._silentRenewError.raise(e);\n    }\n    /**\n     * Add callback: Raised when the user is signed in (when `monitorSession` is set).\n     * @see {@link UserManagerSettings.monitorSession}\n     */\n  }, {\n    key: \"addUserSignedIn\",\n    value: function addUserSignedIn(cb) {\n      return this._userSignedIn.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the user is signed in (when `monitorSession` is set).\n     */\n  }, {\n    key: \"removeUserSignedIn\",\n    value: function removeUserSignedIn(cb) {\n      this._userSignedIn.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_raiseUserSignedIn\",\n    value: function _raiseUserSignedIn() {\n      this._userSignedIn.raise();\n    }\n    /**\n     * Add callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n     * @see {@link UserManagerSettings.monitorSession}\n     */\n  }, {\n    key: \"addUserSignedOut\",\n    value: function addUserSignedOut(cb) {\n      return this._userSignedOut.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n     */\n  }, {\n    key: \"removeUserSignedOut\",\n    value: function removeUserSignedOut(cb) {\n      this._userSignedOut.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_raiseUserSignedOut\",\n    value: function _raiseUserSignedOut() {\n      this._userSignedOut.raise();\n    }\n    /**\n     * Add callback: Raised when the user session changed (when `monitorSession` is set).\n     * @see {@link UserManagerSettings.monitorSession}\n     */\n  }, {\n    key: \"addUserSessionChanged\",\n    value: function addUserSessionChanged(cb) {\n      return this._userSessionChanged.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the user session changed (when `monitorSession` is set).\n     */\n  }, {\n    key: \"removeUserSessionChanged\",\n    value: function removeUserSessionChanged(cb) {\n      this._userSessionChanged.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n  }, {\n    key: \"_raiseUserSessionChanged\",\n    value: function _raiseUserSessionChanged() {\n      this._userSessionChanged.raise();\n    }\n  }]);\n  return UserManagerEvents;\n}(_AccessTokenEvents);\n\n// src/SilentRenewService.ts\nvar SilentRenewService = /*#__PURE__*/function () {\n  function SilentRenewService(_userManager) {\n    var _this20 = this;\n    _classCallCheck(this, SilentRenewService);\n    this._userManager = _userManager;\n    this._logger = new _Logger(\"SilentRenewService\");\n    this._isStarted = false;\n    this._retryTimer = new Timer(\"Retry Silent Renew\");\n    this._tokenExpiring = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee45() {\n      var logger2;\n      return _regeneratorRuntime().wrap(function _callee45$(_context45) {\n        while (1) switch (_context45.prev = _context45.next) {\n          case 0:\n            logger2 = _this20._logger.create(\"_tokenExpiring\");\n            _context45.prev = 1;\n            _context45.next = 4;\n            return _this20._userManager.signinSilent();\n          case 4:\n            logger2.debug(\"silent token renewal successful\");\n            _context45.next = 15;\n            break;\n          case 7:\n            _context45.prev = 7;\n            _context45.t0 = _context45[\"catch\"](1);\n            if (!(_context45.t0 instanceof _ErrorTimeout)) {\n              _context45.next = 13;\n              break;\n            }\n            logger2.warn(\"ErrorTimeout from signinSilent:\", _context45.t0, \"retry in 5s\");\n            _this20._retryTimer.init(5);\n            return _context45.abrupt(\"return\");\n          case 13:\n            logger2.error(\"Error from signinSilent:\", _context45.t0);\n            _this20._userManager.events._raiseSilentRenewError(_context45.t0);\n          case 15:\n          case \"end\":\n            return _context45.stop();\n        }\n      }, _callee45, null, [[1, 7]]);\n    }));\n  }\n  _createClass(SilentRenewService, [{\n    key: \"start\",\n    value: function () {\n      var _start = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee46() {\n        var logger2;\n        return _regeneratorRuntime().wrap(function _callee46$(_context46) {\n          while (1) switch (_context46.prev = _context46.next) {\n            case 0:\n              logger2 = this._logger.create(\"start\");\n              if (this._isStarted) {\n                _context46.next = 13;\n                break;\n              }\n              this._isStarted = true;\n              this._userManager.events.addAccessTokenExpiring(this._tokenExpiring);\n              this._retryTimer.addHandler(this._tokenExpiring);\n              _context46.prev = 5;\n              _context46.next = 8;\n              return this._userManager.getUser();\n            case 8:\n              _context46.next = 13;\n              break;\n            case 10:\n              _context46.prev = 10;\n              _context46.t0 = _context46[\"catch\"](5);\n              logger2.error(\"getUser error\", _context46.t0);\n            case 13:\n            case \"end\":\n              return _context46.stop();\n          }\n        }, _callee46, this, [[5, 10]]);\n      }));\n      function start() {\n        return _start.apply(this, arguments);\n      }\n      return start;\n    }()\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this._isStarted) {\n        this._retryTimer.cancel();\n        this._retryTimer.removeHandler(this._tokenExpiring);\n        this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring);\n        this._isStarted = false;\n      }\n    }\n  }]);\n  return SilentRenewService;\n}();\n\n// src/RefreshState.ts\nvar RefreshState = /*#__PURE__*/_createClass(function RefreshState(args) {\n  _classCallCheck(this, RefreshState);\n  this.refresh_token = args.refresh_token;\n  this.id_token = args.id_token;\n  this.session_state = args.session_state;\n  this.scope = args.scope;\n  this.profile = args.profile;\n  this.data = args.state;\n});\n\n// src/UserManager.ts\nvar _UserManager = /*#__PURE__*/function () {\n  function _UserManager(settings) {\n    _classCallCheck(this, _UserManager);\n    this._logger = new _Logger(\"UserManager\");\n    this.settings = new _UserManagerSettingsStore(settings);\n    this._client = new _OidcClient(settings);\n    this._redirectNavigator = new RedirectNavigator(this.settings);\n    this._popupNavigator = new PopupNavigator(this.settings);\n    this._iframeNavigator = new IFrameNavigator(this.settings);\n    this._events = new UserManagerEvents(this.settings);\n    this._silentRenewService = new SilentRenewService(this);\n    if (this.settings.automaticSilentRenew) {\n      this.startSilentRenew();\n    }\n    this._sessionMonitor = null;\n    if (this.settings.monitorSession) {\n      this._sessionMonitor = new _SessionMonitor(this);\n    }\n  }\n  /** Returns an object used to register for events raised by the `UserManager`. */\n  _createClass(_UserManager, [{\n    key: \"events\",\n    get: function get() {\n      return this._events;\n    }\n    /** Returns an object used to access the metadata configuration of the OIDC provider. */\n  }, {\n    key: \"metadataService\",\n    get: function get() {\n      return this._client.metadataService;\n    }\n    /**\n     * Returns promise to load the `User` object for the currently authenticated user.\n     */\n  }, {\n    key: \"getUser\",\n    value: function () {\n      var _getUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee47() {\n        var logger2, user;\n        return _regeneratorRuntime().wrap(function _callee47$(_context47) {\n          while (1) switch (_context47.prev = _context47.next) {\n            case 0:\n              logger2 = this._logger.create(\"getUser\");\n              _context47.next = 3;\n              return this._loadUser();\n            case 3:\n              user = _context47.sent;\n              if (!user) {\n                _context47.next = 8;\n                break;\n              }\n              logger2.info(\"user loaded\");\n              this._events.load(user, false);\n              return _context47.abrupt(\"return\", user);\n            case 8:\n              logger2.info(\"user not found in storage\");\n              return _context47.abrupt(\"return\", null);\n            case 10:\n            case \"end\":\n              return _context47.stop();\n          }\n        }, _callee47, this);\n      }));\n      function getUser() {\n        return _getUser.apply(this, arguments);\n      }\n      return getUser;\n    }()\n    /**\n     * Returns promise to remove from any storage the currently authenticated user.\n     */\n  }, {\n    key: \"removeUser\",\n    value: function () {\n      var _removeUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee48() {\n        var logger2;\n        return _regeneratorRuntime().wrap(function _callee48$(_context48) {\n          while (1) switch (_context48.prev = _context48.next) {\n            case 0:\n              logger2 = this._logger.create(\"removeUser\");\n              _context48.next = 3;\n              return this.storeUser(null);\n            case 3:\n              logger2.info(\"user removed from storage\");\n              this._events.unload();\n            case 5:\n            case \"end\":\n              return _context48.stop();\n          }\n        }, _callee48, this);\n      }));\n      function removeUser() {\n        return _removeUser.apply(this, arguments);\n      }\n      return removeUser;\n    }()\n    /**\n     * Returns promise to trigger a redirect of the current window to the authorization endpoint.\n     */\n  }, {\n    key: \"signinRedirect\",\n    value: function () {\n      var _signinRedirect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee49() {\n        var args,\n          redirectMethod,\n          requestArgs,\n          handle,\n          _args49 = arguments;\n        return _regeneratorRuntime().wrap(function _callee49$(_context49) {\n          while (1) switch (_context49.prev = _context49.next) {\n            case 0:\n              args = _args49.length > 0 && _args49[0] !== undefined ? _args49[0] : {};\n              this._logger.create(\"signinRedirect\");\n              redirectMethod = args.redirectMethod, requestArgs = _objectWithoutProperties(args, _excluded6);\n              _context49.next = 5;\n              return this._redirectNavigator.prepare({\n                redirectMethod: redirectMethod\n              });\n            case 5:\n              handle = _context49.sent;\n              _context49.next = 8;\n              return this._signinStart(_objectSpread({\n                request_type: \"si:r\"\n              }, requestArgs), handle);\n            case 8:\n            case \"end\":\n              return _context49.stop();\n          }\n        }, _callee49, this);\n      }));\n      function signinRedirect() {\n        return _signinRedirect.apply(this, arguments);\n      }\n      return signinRedirect;\n    }()\n    /**\n     * Returns promise to process response from the authorization endpoint. The result of the promise is the authenticated `User`.\n     */\n  }, {\n    key: \"signinRedirectCallback\",\n    value: function () {\n      var _signinRedirectCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee50() {\n        var url,\n          logger2,\n          user,\n          _args50 = arguments;\n        return _regeneratorRuntime().wrap(function _callee50$(_context50) {\n          while (1) switch (_context50.prev = _context50.next) {\n            case 0:\n              url = _args50.length > 0 && _args50[0] !== undefined ? _args50[0] : window.location.href;\n              logger2 = this._logger.create(\"signinRedirectCallback\");\n              _context50.next = 4;\n              return this._signinEnd(url);\n            case 4:\n              user = _context50.sent;\n              if (user.profile && user.profile.sub) {\n                logger2.info(\"success, signed in subject\", user.profile.sub);\n              } else {\n                logger2.info(\"no subject\");\n              }\n              return _context50.abrupt(\"return\", user);\n            case 7:\n            case \"end\":\n              return _context50.stop();\n          }\n        }, _callee50, this);\n      }));\n      function signinRedirectCallback() {\n        return _signinRedirectCallback.apply(this, arguments);\n      }\n      return signinRedirectCallback;\n    }()\n    /**\n     * Returns promise to process the signin with user/password. The result of the promise is the authenticated `User`.\n     *\n     * Throws an ErrorResponse in case of wrong authentication.\n     */\n  }, {\n    key: \"signinResourceOwnerCredentials\",\n    value: function () {\n      var _signinResourceOwnerCredentials = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee51(_ref29) {\n        var username, password, _ref29$skipUserInfo, skipUserInfo, logger2, signinResponse, user;\n        return _regeneratorRuntime().wrap(function _callee51$(_context51) {\n          while (1) switch (_context51.prev = _context51.next) {\n            case 0:\n              username = _ref29.username, password = _ref29.password, _ref29$skipUserInfo = _ref29.skipUserInfo, skipUserInfo = _ref29$skipUserInfo === void 0 ? false : _ref29$skipUserInfo;\n              logger2 = this._logger.create(\"signinResourceOwnerCredential\");\n              _context51.next = 4;\n              return this._client.processResourceOwnerPasswordCredentials({\n                username: username,\n                password: password,\n                skipUserInfo: skipUserInfo,\n                extraTokenParams: this.settings.extraTokenParams\n              });\n            case 4:\n              signinResponse = _context51.sent;\n              logger2.debug(\"got signin response\");\n              _context51.next = 8;\n              return this._buildUser(signinResponse);\n            case 8:\n              user = _context51.sent;\n              if (user.profile && user.profile.sub) {\n                logger2.info(\"success, signed in subject\", user.profile.sub);\n              } else {\n                logger2.info(\"no subject\");\n              }\n              return _context51.abrupt(\"return\", user);\n            case 11:\n            case \"end\":\n              return _context51.stop();\n          }\n        }, _callee51, this);\n      }));\n      function signinResourceOwnerCredentials(_x46) {\n        return _signinResourceOwnerCredentials.apply(this, arguments);\n      }\n      return signinResourceOwnerCredentials;\n    }()\n    /**\n     * Returns promise to trigger a request (via a popup window) to the authorization endpoint. The result of the promise is the authenticated `User`.\n     */\n  }, {\n    key: \"signinPopup\",\n    value: function () {\n      var _signinPopup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee52() {\n        var args,\n          logger2,\n          popupWindowFeatures,\n          popupWindowTarget,\n          requestArgs,\n          url,\n          handle,\n          user,\n          _args52 = arguments;\n        return _regeneratorRuntime().wrap(function _callee52$(_context52) {\n          while (1) switch (_context52.prev = _context52.next) {\n            case 0:\n              args = _args52.length > 0 && _args52[0] !== undefined ? _args52[0] : {};\n              logger2 = this._logger.create(\"signinPopup\");\n              popupWindowFeatures = args.popupWindowFeatures, popupWindowTarget = args.popupWindowTarget, requestArgs = _objectWithoutProperties(args, _excluded7);\n              url = this.settings.popup_redirect_uri;\n              if (!url) {\n                logger2.throw(new Error(\"No popup_redirect_uri configured\"));\n              }\n              _context52.next = 7;\n              return this._popupNavigator.prepare({\n                popupWindowFeatures: popupWindowFeatures,\n                popupWindowTarget: popupWindowTarget\n              });\n            case 7:\n              handle = _context52.sent;\n              _context52.next = 10;\n              return this._signin(_objectSpread({\n                request_type: \"si:p\",\n                redirect_uri: url,\n                display: \"popup\"\n              }, requestArgs), handle);\n            case 10:\n              user = _context52.sent;\n              if (user) {\n                if (user.profile && user.profile.sub) {\n                  logger2.info(\"success, signed in subject\", user.profile.sub);\n                } else {\n                  logger2.info(\"no subject\");\n                }\n              }\n              return _context52.abrupt(\"return\", user);\n            case 13:\n            case \"end\":\n              return _context52.stop();\n          }\n        }, _callee52, this);\n      }));\n      function signinPopup() {\n        return _signinPopup.apply(this, arguments);\n      }\n      return signinPopup;\n    }()\n    /**\n     * Returns promise to notify the opening window of response from the authorization endpoint.\n     */\n  }, {\n    key: \"signinPopupCallback\",\n    value: function () {\n      var _signinPopupCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee53() {\n        var url,\n          keepOpen,\n          logger2,\n          _args53 = arguments;\n        return _regeneratorRuntime().wrap(function _callee53$(_context53) {\n          while (1) switch (_context53.prev = _context53.next) {\n            case 0:\n              url = _args53.length > 0 && _args53[0] !== undefined ? _args53[0] : window.location.href;\n              keepOpen = _args53.length > 1 && _args53[1] !== undefined ? _args53[1] : false;\n              logger2 = this._logger.create(\"signinPopupCallback\");\n              _context53.next = 5;\n              return this._popupNavigator.callback(url, keepOpen);\n            case 5:\n              logger2.info(\"success\");\n            case 6:\n            case \"end\":\n              return _context53.stop();\n          }\n        }, _callee53, this);\n      }));\n      function signinPopupCallback() {\n        return _signinPopupCallback.apply(this, arguments);\n      }\n      return signinPopupCallback;\n    }()\n    /**\n     * Returns promise to trigger a silent request (via an iframe) to the authorization endpoint.\n     * The result of the promise is the authenticated `User`.\n     */\n  }, {\n    key: \"signinSilent\",\n    value: function () {\n      var _signinSilent = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee54() {\n        var args,\n          _a,\n          logger2,\n          silentRequestTimeoutInSeconds,\n          requestArgs,\n          user,\n          state,\n          url,\n          verifySub,\n          handle,\n          _args54 = arguments;\n        return _regeneratorRuntime().wrap(function _callee54$(_context54) {\n          while (1) switch (_context54.prev = _context54.next) {\n            case 0:\n              args = _args54.length > 0 && _args54[0] !== undefined ? _args54[0] : {};\n              logger2 = this._logger.create(\"signinSilent\");\n              silentRequestTimeoutInSeconds = args.silentRequestTimeoutInSeconds, requestArgs = _objectWithoutProperties(args, _excluded8);\n              _context54.next = 5;\n              return this._loadUser();\n            case 5:\n              user = _context54.sent;\n              if (!(user == null ? void 0 : user.refresh_token)) {\n                _context54.next = 12;\n                break;\n              }\n              logger2.debug(\"using refresh token\");\n              state = new RefreshState(user);\n              _context54.next = 11;\n              return this._useRefreshToken(state);\n            case 11:\n              return _context54.abrupt(\"return\", _context54.sent);\n            case 12:\n              url = this.settings.silent_redirect_uri;\n              if (!url) {\n                logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n              }\n              if (user && this.settings.validateSubOnSilentRenew) {\n                logger2.debug(\"subject prior to silent renew:\", user.profile.sub);\n                verifySub = user.profile.sub;\n              }\n              _context54.next = 17;\n              return this._iframeNavigator.prepare({\n                silentRequestTimeoutInSeconds: silentRequestTimeoutInSeconds\n              });\n            case 17:\n              handle = _context54.sent;\n              _context54.next = 20;\n              return this._signin(_objectSpread({\n                request_type: \"si:s\",\n                redirect_uri: url,\n                prompt: \"none\",\n                id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0\n              }, requestArgs), handle, verifySub);\n            case 20:\n              user = _context54.sent;\n              if (user) {\n                if ((_a = user.profile) == null ? void 0 : _a.sub) {\n                  logger2.info(\"success, signed in subject\", user.profile.sub);\n                } else {\n                  logger2.info(\"no subject\");\n                }\n              }\n              return _context54.abrupt(\"return\", user);\n            case 23:\n            case \"end\":\n              return _context54.stop();\n          }\n        }, _callee54, this);\n      }));\n      function signinSilent() {\n        return _signinSilent.apply(this, arguments);\n      }\n      return signinSilent;\n    }()\n  }, {\n    key: \"_useRefreshToken\",\n    value: function () {\n      var _useRefreshToken2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee55(state) {\n        var response, user;\n        return _regeneratorRuntime().wrap(function _callee55$(_context55) {\n          while (1) switch (_context55.prev = _context55.next) {\n            case 0:\n              _context55.next = 2;\n              return this._client.useRefreshToken({\n                state: state,\n                timeoutInSeconds: this.settings.silentRequestTimeoutInSeconds\n              });\n            case 2:\n              response = _context55.sent;\n              user = new _User(_objectSpread(_objectSpread({}, state), response));\n              _context55.next = 6;\n              return this.storeUser(user);\n            case 6:\n              this._events.load(user);\n              return _context55.abrupt(\"return\", user);\n            case 8:\n            case \"end\":\n              return _context55.stop();\n          }\n        }, _callee55, this);\n      }));\n      function _useRefreshToken(_x47) {\n        return _useRefreshToken2.apply(this, arguments);\n      }\n      return _useRefreshToken;\n    }()\n    /**\n     * Returns promise to notify the parent window of response from the authorization endpoint.\n     */\n  }, {\n    key: \"signinSilentCallback\",\n    value: function () {\n      var _signinSilentCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee56() {\n        var url,\n          logger2,\n          _args56 = arguments;\n        return _regeneratorRuntime().wrap(function _callee56$(_context56) {\n          while (1) switch (_context56.prev = _context56.next) {\n            case 0:\n              url = _args56.length > 0 && _args56[0] !== undefined ? _args56[0] : window.location.href;\n              logger2 = this._logger.create(\"signinSilentCallback\");\n              _context56.next = 4;\n              return this._iframeNavigator.callback(url);\n            case 4:\n              logger2.info(\"success\");\n            case 5:\n            case \"end\":\n              return _context56.stop();\n          }\n        }, _callee56, this);\n      }));\n      function signinSilentCallback() {\n        return _signinSilentCallback.apply(this, arguments);\n      }\n      return signinSilentCallback;\n    }()\n  }, {\n    key: \"signinCallback\",\n    value: function () {\n      var _signinCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee57() {\n        var url,\n          _yield$this$_client$r,\n          state,\n          _args57 = arguments;\n        return _regeneratorRuntime().wrap(function _callee57$(_context57) {\n          while (1) switch (_context57.prev = _context57.next) {\n            case 0:\n              url = _args57.length > 0 && _args57[0] !== undefined ? _args57[0] : window.location.href;\n              _context57.next = 3;\n              return this._client.readSigninResponseState(url);\n            case 3:\n              _yield$this$_client$r = _context57.sent;\n              state = _yield$this$_client$r.state;\n              _context57.t0 = state.request_type;\n              _context57.next = _context57.t0 === \"si:r\" ? 8 : _context57.t0 === \"si:p\" ? 11 : _context57.t0 === \"si:s\" ? 14 : 17;\n              break;\n            case 8:\n              _context57.next = 10;\n              return this.signinRedirectCallback(url);\n            case 10:\n              return _context57.abrupt(\"return\", _context57.sent);\n            case 11:\n              _context57.next = 13;\n              return this.signinPopupCallback(url);\n            case 13:\n              return _context57.abrupt(\"return\", _context57.sent);\n            case 14:\n              _context57.next = 16;\n              return this.signinSilentCallback(url);\n            case 16:\n              return _context57.abrupt(\"return\", _context57.sent);\n            case 17:\n              throw new Error(\"invalid response_type in state\");\n            case 18:\n            case \"end\":\n              return _context57.stop();\n          }\n        }, _callee57, this);\n      }));\n      function signinCallback() {\n        return _signinCallback.apply(this, arguments);\n      }\n      return signinCallback;\n    }()\n  }, {\n    key: \"signoutCallback\",\n    value: function () {\n      var _signoutCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee58() {\n        var url,\n          keepOpen,\n          _yield$this$_client$r2,\n          state,\n          _args58 = arguments;\n        return _regeneratorRuntime().wrap(function _callee58$(_context58) {\n          while (1) switch (_context58.prev = _context58.next) {\n            case 0:\n              url = _args58.length > 0 && _args58[0] !== undefined ? _args58[0] : window.location.href;\n              keepOpen = _args58.length > 1 && _args58[1] !== undefined ? _args58[1] : false;\n              _context58.next = 4;\n              return this._client.readSignoutResponseState(url);\n            case 4:\n              _yield$this$_client$r2 = _context58.sent;\n              state = _yield$this$_client$r2.state;\n              if (state) {\n                _context58.next = 8;\n                break;\n              }\n              return _context58.abrupt(\"return\");\n            case 8:\n              _context58.t0 = state.request_type;\n              _context58.next = _context58.t0 === \"so:r\" ? 11 : _context58.t0 === \"so:p\" ? 14 : _context58.t0 === \"so:s\" ? 17 : 20;\n              break;\n            case 11:\n              _context58.next = 13;\n              return this.signoutRedirectCallback(url);\n            case 13:\n              return _context58.abrupt(\"break\", 21);\n            case 14:\n              _context58.next = 16;\n              return this.signoutPopupCallback(url, keepOpen);\n            case 16:\n              return _context58.abrupt(\"break\", 21);\n            case 17:\n              _context58.next = 19;\n              return this.signoutSilentCallback(url);\n            case 19:\n              return _context58.abrupt(\"break\", 21);\n            case 20:\n              throw new Error(\"invalid response_type in state\");\n            case 21:\n            case \"end\":\n              return _context58.stop();\n          }\n        }, _callee58, this);\n      }));\n      function signoutCallback() {\n        return _signoutCallback.apply(this, arguments);\n      }\n      return signoutCallback;\n    }()\n    /**\n     * Returns promise to query OP for user's current signin status. Returns object with session_state and subject identifier.\n     */\n  }, {\n    key: \"querySessionStatus\",\n    value: function () {\n      var _querySessionStatus = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee59() {\n        var args,\n          logger2,\n          silentRequestTimeoutInSeconds,\n          requestArgs,\n          url,\n          user,\n          handle,\n          navResponse,\n          signinResponse,\n          _args59 = arguments;\n        return _regeneratorRuntime().wrap(function _callee59$(_context59) {\n          while (1) switch (_context59.prev = _context59.next) {\n            case 0:\n              args = _args59.length > 0 && _args59[0] !== undefined ? _args59[0] : {};\n              logger2 = this._logger.create(\"querySessionStatus\");\n              silentRequestTimeoutInSeconds = args.silentRequestTimeoutInSeconds, requestArgs = _objectWithoutProperties(args, _excluded9);\n              url = this.settings.silent_redirect_uri;\n              if (!url) {\n                logger2.throw(new Error(\"No silent_redirect_uri configured\"));\n              }\n              _context59.next = 7;\n              return this._loadUser();\n            case 7:\n              user = _context59.sent;\n              _context59.next = 10;\n              return this._iframeNavigator.prepare({\n                silentRequestTimeoutInSeconds: silentRequestTimeoutInSeconds\n              });\n            case 10:\n              handle = _context59.sent;\n              _context59.next = 13;\n              return this._signinStart(_objectSpread({\n                request_type: \"si:s\",\n                // this acts like a signin silent\n                redirect_uri: url,\n                prompt: \"none\",\n                id_token_hint: this.settings.includeIdTokenInSilentRenew ? user == null ? void 0 : user.id_token : void 0,\n                response_type: this.settings.query_status_response_type,\n                scope: \"openid\",\n                skipUserInfo: true\n              }, requestArgs), handle);\n            case 13:\n              navResponse = _context59.sent;\n              _context59.prev = 14;\n              _context59.next = 17;\n              return this._client.processSigninResponse(navResponse.url);\n            case 17:\n              signinResponse = _context59.sent;\n              logger2.debug(\"got signin response\");\n              if (!(signinResponse.session_state && signinResponse.profile.sub)) {\n                _context59.next = 22;\n                break;\n              }\n              logger2.info(\"success for subject\", signinResponse.profile.sub);\n              return _context59.abrupt(\"return\", {\n                session_state: signinResponse.session_state,\n                sub: signinResponse.profile.sub,\n                sid: signinResponse.profile.sid\n              });\n            case 22:\n              logger2.info(\"success, user not authenticated\");\n              return _context59.abrupt(\"return\", null);\n            case 26:\n              _context59.prev = 26;\n              _context59.t0 = _context59[\"catch\"](14);\n              if (!(this.settings.monitorAnonymousSession && _context59.t0 instanceof _ErrorResponse)) {\n                _context59.next = 34;\n                break;\n              }\n              _context59.t1 = _context59.t0.error;\n              _context59.next = _context59.t1 === \"login_required\" ? 32 : _context59.t1 === \"consent_required\" ? 32 : _context59.t1 === \"interaction_required\" ? 32 : _context59.t1 === \"account_selection_required\" ? 32 : 34;\n              break;\n            case 32:\n              logger2.info(\"success for anonymous user\");\n              return _context59.abrupt(\"return\", {\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                session_state: _context59.t0.session_state\n              });\n            case 34:\n              throw _context59.t0;\n            case 35:\n            case \"end\":\n              return _context59.stop();\n          }\n        }, _callee59, this, [[14, 26]]);\n      }));\n      function querySessionStatus() {\n        return _querySessionStatus.apply(this, arguments);\n      }\n      return querySessionStatus;\n    }()\n  }, {\n    key: \"_signin\",\n    value: function () {\n      var _signin2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee60(args, handle, verifySub) {\n        var navResponse;\n        return _regeneratorRuntime().wrap(function _callee60$(_context60) {\n          while (1) switch (_context60.prev = _context60.next) {\n            case 0:\n              _context60.next = 2;\n              return this._signinStart(args, handle);\n            case 2:\n              navResponse = _context60.sent;\n              _context60.next = 5;\n              return this._signinEnd(navResponse.url, verifySub);\n            case 5:\n              return _context60.abrupt(\"return\", _context60.sent);\n            case 6:\n            case \"end\":\n              return _context60.stop();\n          }\n        }, _callee60, this);\n      }));\n      function _signin(_x48, _x49, _x50) {\n        return _signin2.apply(this, arguments);\n      }\n      return _signin;\n    }()\n  }, {\n    key: \"_signinStart\",\n    value: function () {\n      var _signinStart2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee61(args, handle) {\n        var logger2, signinRequest;\n        return _regeneratorRuntime().wrap(function _callee61$(_context61) {\n          while (1) switch (_context61.prev = _context61.next) {\n            case 0:\n              logger2 = this._logger.create(\"_signinStart\");\n              _context61.prev = 1;\n              _context61.next = 4;\n              return this._client.createSigninRequest(args);\n            case 4:\n              signinRequest = _context61.sent;\n              logger2.debug(\"got signin request\");\n              _context61.next = 8;\n              return handle.navigate({\n                url: signinRequest.url,\n                state: signinRequest.state.id,\n                response_mode: signinRequest.state.response_mode,\n                scriptOrigin: this.settings.iframeScriptOrigin\n              });\n            case 8:\n              return _context61.abrupt(\"return\", _context61.sent);\n            case 11:\n              _context61.prev = 11;\n              _context61.t0 = _context61[\"catch\"](1);\n              logger2.debug(\"error after preparing navigator, closing navigator window\");\n              handle.close();\n              throw _context61.t0;\n            case 16:\n            case \"end\":\n              return _context61.stop();\n          }\n        }, _callee61, this, [[1, 11]]);\n      }));\n      function _signinStart(_x51, _x52) {\n        return _signinStart2.apply(this, arguments);\n      }\n      return _signinStart;\n    }()\n  }, {\n    key: \"_signinEnd\",\n    value: function () {\n      var _signinEnd2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee62(url, verifySub) {\n        var logger2, signinResponse, user;\n        return _regeneratorRuntime().wrap(function _callee62$(_context62) {\n          while (1) switch (_context62.prev = _context62.next) {\n            case 0:\n              logger2 = this._logger.create(\"_signinEnd\");\n              _context62.next = 3;\n              return this._client.processSigninResponse(url);\n            case 3:\n              signinResponse = _context62.sent;\n              logger2.debug(\"got signin response\");\n              _context62.next = 7;\n              return this._buildUser(signinResponse, verifySub);\n            case 7:\n              user = _context62.sent;\n              return _context62.abrupt(\"return\", user);\n            case 9:\n            case \"end\":\n              return _context62.stop();\n          }\n        }, _callee62, this);\n      }));\n      function _signinEnd(_x53, _x54) {\n        return _signinEnd2.apply(this, arguments);\n      }\n      return _signinEnd;\n    }()\n  }, {\n    key: \"_buildUser\",\n    value: function () {\n      var _buildUser2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee63(signinResponse, verifySub) {\n        var logger2, user;\n        return _regeneratorRuntime().wrap(function _callee63$(_context63) {\n          while (1) switch (_context63.prev = _context63.next) {\n            case 0:\n              logger2 = this._logger.create(\"_buildUser\");\n              user = new _User(signinResponse);\n              if (!verifySub) {\n                _context63.next = 7;\n                break;\n              }\n              if (!(verifySub !== user.profile.sub)) {\n                _context63.next = 6;\n                break;\n              }\n              logger2.debug(\"current user does not match user returned from signin. sub from signin:\", user.profile.sub);\n              throw new _ErrorResponse(_objectSpread(_objectSpread({}, signinResponse), {}, {\n                error: \"login_required\"\n              }));\n            case 6:\n              logger2.debug(\"current user matches user returned from signin\");\n            case 7:\n              _context63.next = 9;\n              return this.storeUser(user);\n            case 9:\n              logger2.debug(\"user stored\");\n              this._events.load(user);\n              return _context63.abrupt(\"return\", user);\n            case 12:\n            case \"end\":\n              return _context63.stop();\n          }\n        }, _callee63, this);\n      }));\n      function _buildUser(_x55, _x56) {\n        return _buildUser2.apply(this, arguments);\n      }\n      return _buildUser;\n    }()\n    /**\n     * Returns promise to trigger a redirect of the current window to the end session endpoint.\n     */\n  }, {\n    key: \"signoutRedirect\",\n    value: function () {\n      var _signoutRedirect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee64() {\n        var args,\n          logger2,\n          redirectMethod,\n          requestArgs,\n          handle,\n          _args64 = arguments;\n        return _regeneratorRuntime().wrap(function _callee64$(_context64) {\n          while (1) switch (_context64.prev = _context64.next) {\n            case 0:\n              args = _args64.length > 0 && _args64[0] !== undefined ? _args64[0] : {};\n              logger2 = this._logger.create(\"signoutRedirect\");\n              redirectMethod = args.redirectMethod, requestArgs = _objectWithoutProperties(args, _excluded10);\n              _context64.next = 5;\n              return this._redirectNavigator.prepare({\n                redirectMethod: redirectMethod\n              });\n            case 5:\n              handle = _context64.sent;\n              _context64.next = 8;\n              return this._signoutStart(_objectSpread({\n                request_type: \"so:r\",\n                post_logout_redirect_uri: this.settings.post_logout_redirect_uri\n              }, requestArgs), handle);\n            case 8:\n              logger2.info(\"success\");\n            case 9:\n            case \"end\":\n              return _context64.stop();\n          }\n        }, _callee64, this);\n      }));\n      function signoutRedirect() {\n        return _signoutRedirect.apply(this, arguments);\n      }\n      return signoutRedirect;\n    }()\n    /**\n     * Returns promise to process response from the end session endpoint.\n     */\n  }, {\n    key: \"signoutRedirectCallback\",\n    value: function () {\n      var _signoutRedirectCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee65() {\n        var url,\n          logger2,\n          response,\n          _args65 = arguments;\n        return _regeneratorRuntime().wrap(function _callee65$(_context65) {\n          while (1) switch (_context65.prev = _context65.next) {\n            case 0:\n              url = _args65.length > 0 && _args65[0] !== undefined ? _args65[0] : window.location.href;\n              logger2 = this._logger.create(\"signoutRedirectCallback\");\n              _context65.next = 4;\n              return this._signoutEnd(url);\n            case 4:\n              response = _context65.sent;\n              logger2.info(\"success\");\n              return _context65.abrupt(\"return\", response);\n            case 7:\n            case \"end\":\n              return _context65.stop();\n          }\n        }, _callee65, this);\n      }));\n      function signoutRedirectCallback() {\n        return _signoutRedirectCallback.apply(this, arguments);\n      }\n      return signoutRedirectCallback;\n    }()\n    /**\n     * Returns promise to trigger a redirect of a popup window window to the end session endpoint.\n     */\n  }, {\n    key: \"signoutPopup\",\n    value: function () {\n      var _signoutPopup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee66() {\n        var args,\n          logger2,\n          popupWindowFeatures,\n          popupWindowTarget,\n          requestArgs,\n          url,\n          handle,\n          _args66 = arguments;\n        return _regeneratorRuntime().wrap(function _callee66$(_context66) {\n          while (1) switch (_context66.prev = _context66.next) {\n            case 0:\n              args = _args66.length > 0 && _args66[0] !== undefined ? _args66[0] : {};\n              logger2 = this._logger.create(\"signoutPopup\");\n              popupWindowFeatures = args.popupWindowFeatures, popupWindowTarget = args.popupWindowTarget, requestArgs = _objectWithoutProperties(args, _excluded11);\n              url = this.settings.popup_post_logout_redirect_uri;\n              _context66.next = 6;\n              return this._popupNavigator.prepare({\n                popupWindowFeatures: popupWindowFeatures,\n                popupWindowTarget: popupWindowTarget\n              });\n            case 6:\n              handle = _context66.sent;\n              _context66.next = 9;\n              return this._signout(_objectSpread({\n                request_type: \"so:p\",\n                post_logout_redirect_uri: url,\n                // we're putting a dummy entry in here because we\n                // need a unique id from the state for notification\n                // to the parent window, which is necessary if we\n                // plan to return back to the client after signout\n                // and so we can close the popup after signout\n                state: url == null ? void 0 : {}\n              }, requestArgs), handle);\n            case 9:\n              logger2.info(\"success\");\n            case 10:\n            case \"end\":\n              return _context66.stop();\n          }\n        }, _callee66, this);\n      }));\n      function signoutPopup() {\n        return _signoutPopup.apply(this, arguments);\n      }\n      return signoutPopup;\n    }()\n    /**\n     * Returns promise to process response from the end session endpoint from a popup window.\n     */\n  }, {\n    key: \"signoutPopupCallback\",\n    value: function () {\n      var _signoutPopupCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee67() {\n        var url,\n          keepOpen,\n          logger2,\n          _args67 = arguments;\n        return _regeneratorRuntime().wrap(function _callee67$(_context67) {\n          while (1) switch (_context67.prev = _context67.next) {\n            case 0:\n              url = _args67.length > 0 && _args67[0] !== undefined ? _args67[0] : window.location.href;\n              keepOpen = _args67.length > 1 && _args67[1] !== undefined ? _args67[1] : false;\n              logger2 = this._logger.create(\"signoutPopupCallback\");\n              _context67.next = 5;\n              return this._popupNavigator.callback(url, keepOpen);\n            case 5:\n              logger2.info(\"success\");\n            case 6:\n            case \"end\":\n              return _context67.stop();\n          }\n        }, _callee67, this);\n      }));\n      function signoutPopupCallback() {\n        return _signoutPopupCallback.apply(this, arguments);\n      }\n      return signoutPopupCallback;\n    }()\n  }, {\n    key: \"_signout\",\n    value: function () {\n      var _signout2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee68(args, handle) {\n        var navResponse;\n        return _regeneratorRuntime().wrap(function _callee68$(_context68) {\n          while (1) switch (_context68.prev = _context68.next) {\n            case 0:\n              _context68.next = 2;\n              return this._signoutStart(args, handle);\n            case 2:\n              navResponse = _context68.sent;\n              _context68.next = 5;\n              return this._signoutEnd(navResponse.url);\n            case 5:\n              return _context68.abrupt(\"return\", _context68.sent);\n            case 6:\n            case \"end\":\n              return _context68.stop();\n          }\n        }, _callee68, this);\n      }));\n      function _signout(_x57, _x58) {\n        return _signout2.apply(this, arguments);\n      }\n      return _signout;\n    }()\n  }, {\n    key: \"_signoutStart\",\n    value: function () {\n      var _signoutStart2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee69() {\n        var args,\n          handle,\n          _a,\n          logger2,\n          user,\n          id_token,\n          signoutRequest,\n          _args69 = arguments;\n        return _regeneratorRuntime().wrap(function _callee69$(_context69) {\n          while (1) switch (_context69.prev = _context69.next) {\n            case 0:\n              args = _args69.length > 0 && _args69[0] !== undefined ? _args69[0] : {};\n              handle = _args69.length > 1 ? _args69[1] : undefined;\n              logger2 = this._logger.create(\"_signoutStart\");\n              _context69.prev = 3;\n              _context69.next = 6;\n              return this._loadUser();\n            case 6:\n              user = _context69.sent;\n              logger2.debug(\"loaded current user from storage\");\n              if (!this.settings.revokeTokensOnSignout) {\n                _context69.next = 11;\n                break;\n              }\n              _context69.next = 11;\n              return this._revokeInternal(user);\n            case 11:\n              id_token = args.id_token_hint || user && user.id_token;\n              if (id_token) {\n                logger2.debug(\"setting id_token_hint in signout request\");\n                args.id_token_hint = id_token;\n              }\n              _context69.next = 15;\n              return this.removeUser();\n            case 15:\n              logger2.debug(\"user removed, creating signout request\");\n              _context69.next = 18;\n              return this._client.createSignoutRequest(args);\n            case 18:\n              signoutRequest = _context69.sent;\n              logger2.debug(\"got signout request\");\n              _context69.next = 22;\n              return handle.navigate({\n                url: signoutRequest.url,\n                state: (_a = signoutRequest.state) == null ? void 0 : _a.id\n              });\n            case 22:\n              return _context69.abrupt(\"return\", _context69.sent);\n            case 25:\n              _context69.prev = 25;\n              _context69.t0 = _context69[\"catch\"](3);\n              logger2.debug(\"error after preparing navigator, closing navigator window\");\n              handle.close();\n              throw _context69.t0;\n            case 30:\n            case \"end\":\n              return _context69.stop();\n          }\n        }, _callee69, this, [[3, 25]]);\n      }));\n      function _signoutStart() {\n        return _signoutStart2.apply(this, arguments);\n      }\n      return _signoutStart;\n    }()\n  }, {\n    key: \"_signoutEnd\",\n    value: function () {\n      var _signoutEnd2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee70(url) {\n        var logger2, signoutResponse;\n        return _regeneratorRuntime().wrap(function _callee70$(_context70) {\n          while (1) switch (_context70.prev = _context70.next) {\n            case 0:\n              logger2 = this._logger.create(\"_signoutEnd\");\n              _context70.next = 3;\n              return this._client.processSignoutResponse(url);\n            case 3:\n              signoutResponse = _context70.sent;\n              logger2.debug(\"got signout response\");\n              return _context70.abrupt(\"return\", signoutResponse);\n            case 6:\n            case \"end\":\n              return _context70.stop();\n          }\n        }, _callee70, this);\n      }));\n      function _signoutEnd(_x59) {\n        return _signoutEnd2.apply(this, arguments);\n      }\n      return _signoutEnd;\n    }()\n    /**\n     * Returns promise to trigger a silent request (via an iframe) to the end session endpoint.\n     */\n  }, {\n    key: \"signoutSilent\",\n    value: function () {\n      var _signoutSilent = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee71() {\n        var args,\n          _a,\n          logger2,\n          silentRequestTimeoutInSeconds,\n          requestArgs,\n          id_token_hint,\n          url,\n          handle,\n          _args71 = arguments;\n        return _regeneratorRuntime().wrap(function _callee71$(_context71) {\n          while (1) switch (_context71.prev = _context71.next) {\n            case 0:\n              args = _args71.length > 0 && _args71[0] !== undefined ? _args71[0] : {};\n              logger2 = this._logger.create(\"signoutSilent\");\n              silentRequestTimeoutInSeconds = args.silentRequestTimeoutInSeconds, requestArgs = _objectWithoutProperties(args, _excluded12);\n              if (!this.settings.includeIdTokenInSilentSignout) {\n                _context71.next = 15;\n                break;\n              }\n              _context71.next = 6;\n              return this._loadUser();\n            case 6:\n              _context71.t1 = _a = _context71.sent;\n              if (!(_context71.t1 == null)) {\n                _context71.next = 11;\n                break;\n              }\n              _context71.t2 = void 0;\n              _context71.next = 12;\n              break;\n            case 11:\n              _context71.t2 = _a.id_token;\n            case 12:\n              _context71.t0 = _context71.t2;\n              _context71.next = 16;\n              break;\n            case 15:\n              _context71.t0 = void 0;\n            case 16:\n              id_token_hint = _context71.t0;\n              url = this.settings.popup_post_logout_redirect_uri;\n              _context71.next = 20;\n              return this._iframeNavigator.prepare({\n                silentRequestTimeoutInSeconds: silentRequestTimeoutInSeconds\n              });\n            case 20:\n              handle = _context71.sent;\n              _context71.next = 23;\n              return this._signout(_objectSpread({\n                request_type: \"so:s\",\n                post_logout_redirect_uri: url,\n                id_token_hint: id_token_hint\n              }, requestArgs), handle);\n            case 23:\n              logger2.info(\"success\");\n            case 24:\n            case \"end\":\n              return _context71.stop();\n          }\n        }, _callee71, this);\n      }));\n      function signoutSilent() {\n        return _signoutSilent.apply(this, arguments);\n      }\n      return signoutSilent;\n    }()\n    /**\n     * Returns promise to notify the parent window of response from the end session endpoint.\n     */\n  }, {\n    key: \"signoutSilentCallback\",\n    value: function () {\n      var _signoutSilentCallback = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee72() {\n        var url,\n          logger2,\n          _args72 = arguments;\n        return _regeneratorRuntime().wrap(function _callee72$(_context72) {\n          while (1) switch (_context72.prev = _context72.next) {\n            case 0:\n              url = _args72.length > 0 && _args72[0] !== undefined ? _args72[0] : window.location.href;\n              logger2 = this._logger.create(\"signoutSilentCallback\");\n              _context72.next = 4;\n              return this._iframeNavigator.callback(url);\n            case 4:\n              logger2.info(\"success\");\n            case 5:\n            case \"end\":\n              return _context72.stop();\n          }\n        }, _callee72, this);\n      }));\n      function signoutSilentCallback() {\n        return _signoutSilentCallback.apply(this, arguments);\n      }\n      return signoutSilentCallback;\n    }()\n  }, {\n    key: \"revokeTokens\",\n    value: function () {\n      var _revokeTokens = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee73(types) {\n        var user;\n        return _regeneratorRuntime().wrap(function _callee73$(_context73) {\n          while (1) switch (_context73.prev = _context73.next) {\n            case 0:\n              _context73.next = 2;\n              return this._loadUser();\n            case 2:\n              user = _context73.sent;\n              _context73.next = 5;\n              return this._revokeInternal(user, types);\n            case 5:\n            case \"end\":\n              return _context73.stop();\n          }\n        }, _callee73, this);\n      }));\n      function revokeTokens(_x60) {\n        return _revokeTokens.apply(this, arguments);\n      }\n      return revokeTokens;\n    }()\n  }, {\n    key: \"_revokeInternal\",\n    value: function () {\n      var _revokeInternal2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee74(user) {\n        var types,\n          logger2,\n          typesPresent,\n          _iterator6,\n          _step6,\n          type,\n          _args74 = arguments;\n        return _regeneratorRuntime().wrap(function _callee74$(_context74) {\n          while (1) switch (_context74.prev = _context74.next) {\n            case 0:\n              types = _args74.length > 1 && _args74[1] !== undefined ? _args74[1] : this.settings.revokeTokenTypes;\n              logger2 = this._logger.create(\"_revokeInternal\");\n              if (user) {\n                _context74.next = 4;\n                break;\n              }\n              return _context74.abrupt(\"return\");\n            case 4:\n              typesPresent = types.filter(function (type) {\n                return typeof user[type] === \"string\";\n              });\n              if (typesPresent.length) {\n                _context74.next = 8;\n                break;\n              }\n              logger2.debug(\"no need to revoke due to no token(s)\");\n              return _context74.abrupt(\"return\");\n            case 8:\n              _iterator6 = _createForOfIteratorHelper(typesPresent);\n              _context74.prev = 9;\n              _iterator6.s();\n            case 11:\n              if ((_step6 = _iterator6.n()).done) {\n                _context74.next = 19;\n                break;\n              }\n              type = _step6.value;\n              _context74.next = 15;\n              return this._client.revokeToken(user[type],\n              // eslint-disable-line @typescript-eslint/no-non-null-assertion\n              type);\n            case 15:\n              logger2.info(\"\".concat(type, \" revoked successfully\"));\n              if (type !== \"access_token\") {\n                user[type] = null;\n              }\n            case 17:\n              _context74.next = 11;\n              break;\n            case 19:\n              _context74.next = 24;\n              break;\n            case 21:\n              _context74.prev = 21;\n              _context74.t0 = _context74[\"catch\"](9);\n              _iterator6.e(_context74.t0);\n            case 24:\n              _context74.prev = 24;\n              _iterator6.f();\n              return _context74.finish(24);\n            case 27:\n              _context74.next = 29;\n              return this.storeUser(user);\n            case 29:\n              logger2.debug(\"user stored\");\n              this._events.load(user);\n            case 31:\n            case \"end\":\n              return _context74.stop();\n          }\n        }, _callee74, this, [[9, 21, 24, 27]]);\n      }));\n      function _revokeInternal(_x61) {\n        return _revokeInternal2.apply(this, arguments);\n      }\n      return _revokeInternal;\n    }()\n    /**\n     * Enables silent renew for the `UserManager`.\n     */\n  }, {\n    key: \"startSilentRenew\",\n    value: function startSilentRenew() {\n      this._logger.create(\"startSilentRenew\");\n      void this._silentRenewService.start();\n    }\n    /**\n     * Disables silent renew for the `UserManager`.\n     */\n  }, {\n    key: \"stopSilentRenew\",\n    value: function stopSilentRenew() {\n      this._silentRenewService.stop();\n    }\n  }, {\n    key: \"_userStoreKey\",\n    get: function get() {\n      return \"user:\".concat(this.settings.authority, \":\").concat(this.settings.client_id);\n    }\n  }, {\n    key: \"_loadUser\",\n    value: function () {\n      var _loadUser2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee75() {\n        var logger2, storageString;\n        return _regeneratorRuntime().wrap(function _callee75$(_context75) {\n          while (1) switch (_context75.prev = _context75.next) {\n            case 0:\n              logger2 = this._logger.create(\"_loadUser\");\n              _context75.next = 3;\n              return this.settings.userStore.get(this._userStoreKey);\n            case 3:\n              storageString = _context75.sent;\n              if (!storageString) {\n                _context75.next = 7;\n                break;\n              }\n              logger2.debug(\"user storageString loaded\");\n              return _context75.abrupt(\"return\", _User.fromStorageString(storageString));\n            case 7:\n              logger2.debug(\"no user storageString\");\n              return _context75.abrupt(\"return\", null);\n            case 9:\n            case \"end\":\n              return _context75.stop();\n          }\n        }, _callee75, this);\n      }));\n      function _loadUser() {\n        return _loadUser2.apply(this, arguments);\n      }\n      return _loadUser;\n    }()\n  }, {\n    key: \"storeUser\",\n    value: function () {\n      var _storeUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee76(user) {\n        var logger2, storageString;\n        return _regeneratorRuntime().wrap(function _callee76$(_context76) {\n          while (1) switch (_context76.prev = _context76.next) {\n            case 0:\n              logger2 = this._logger.create(\"storeUser\");\n              if (!user) {\n                _context76.next = 8;\n                break;\n              }\n              logger2.debug(\"storing user\");\n              storageString = user.toStorageString();\n              _context76.next = 6;\n              return this.settings.userStore.set(this._userStoreKey, storageString);\n            case 6:\n              _context76.next = 11;\n              break;\n            case 8:\n              this._logger.debug(\"removing user\");\n              _context76.next = 11;\n              return this.settings.userStore.remove(this._userStoreKey);\n            case 11:\n            case \"end\":\n              return _context76.stop();\n          }\n        }, _callee76, this);\n      }));\n      function storeUser(_x62) {\n        return _storeUser.apply(this, arguments);\n      }\n      return storeUser;\n    }()\n    /**\n     * Removes stale state entries in storage for incomplete authorize requests.\n     */\n  }, {\n    key: \"clearStaleState\",\n    value: function () {\n      var _clearStaleState2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee77() {\n        return _regeneratorRuntime().wrap(function _callee77$(_context77) {\n          while (1) switch (_context77.prev = _context77.next) {\n            case 0:\n              _context77.next = 2;\n              return this._client.clearStaleState();\n            case 2:\n            case \"end\":\n              return _context77.stop();\n          }\n        }, _callee77, this);\n      }));\n      function clearStaleState() {\n        return _clearStaleState2.apply(this, arguments);\n      }\n      return clearStaleState;\n    }()\n  }]);\n  return _UserManager;\n}();\n\n// package.json\nvar version = \"2.2.1\";\n\n// src/Version.ts\nvar _Version = version;\n// Annotate the CommonJS export names for ESM import in node:\n0 && (module.exports = {\n  AccessTokenEvents: _AccessTokenEvents,\n  CheckSessionIFrame: _CheckSessionIFrame,\n  ErrorResponse: _ErrorResponse,\n  ErrorTimeout: _ErrorTimeout,\n  InMemoryWebStorage: _InMemoryWebStorage,\n  Log: _Log,\n  Logger: _Logger,\n  MetadataService: _MetadataService,\n  OidcClient: _OidcClient,\n  OidcClientSettingsStore: _OidcClientSettingsStore,\n  SessionMonitor: _SessionMonitor,\n  SigninResponse: _SigninResponse,\n  SigninState: _SigninState,\n  SignoutResponse: _SignoutResponse,\n  State: _State,\n  User: _User,\n  UserManager: _UserManager,\n  UserManagerSettingsStore: _UserManagerSettingsStore,\n  Version: _Version,\n  WebStorageStateStore: _WebStorageStateStore\n});","map":{"version":3,"sources":["../../src/index.ts","../../src/utils/CryptoUtils.ts","../../src/utils/Logger.ts","../../src/utils/Event.ts","../../src/utils/JwtUtils.ts","../../src/utils/PopupUtils.ts","../../src/utils/Timer.ts","../../src/utils/UrlUtils.ts","../../src/errors/ErrorResponse.ts","../../src/errors/ErrorTimeout.ts","../../src/AccessTokenEvents.ts","../../src/CheckSessionIFrame.ts","../../src/InMemoryWebStorage.ts","../../src/JsonService.ts","../../src/MetadataService.ts","../../src/WebStorageStateStore.ts","../../src/OidcClientSettings.ts","../../src/UserInfoService.ts","../../src/TokenClient.ts","../../src/ResponseValidator.ts","../../src/State.ts","../../src/SigninState.ts","../../src/SigninRequest.ts","../../src/SigninResponse.ts","../../src/SignoutRequest.ts","../../src/SignoutResponse.ts","../../src/OidcClient.ts","../../src/SessionMonitor.ts","../../src/User.ts","../../src/navigators/AbstractChildWindow.ts","../../src/UserManagerSettings.ts","../../src/navigators/IFrameWindow.ts","../../src/navigators/IFrameNavigator.ts","../../src/navigators/PopupWindow.ts","../../src/navigators/PopupNavigator.ts","../../src/navigators/RedirectNavigator.ts","../../src/UserManagerEvents.ts","../../src/SilentRenewService.ts","../../src/RefreshState.ts","../../src/UserManager.ts","../../package.json","../../src/Version.ts"],"names":["Log","logger"],"mappings":"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","sourcesContent":["// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nexport { ErrorResponse, ErrorTimeout } from \"./errors\";\nexport type { IFrameWindowParams, PopupWindowParams, RedirectParams } from \"./navigators\";\nexport { Log, Logger } from \"./utils\";\nexport type { ILogger, PopupWindowFeatures } from \"./utils\";\nexport type { OidcAddressClaim, OidcStandardClaims, IdTokenClaims, JwtClaims } from \"./Claims\";\n\nexport { AccessTokenEvents } from \"./AccessTokenEvents\";\nexport type { AccessTokenCallback } from \"./AccessTokenEvents\";\nexport { CheckSessionIFrame } from \"./CheckSessionIFrame\";\nexport { InMemoryWebStorage } from \"./InMemoryWebStorage\";\nexport type { AsyncStorage } from \"./AsyncStorage\";\nexport { MetadataService } from \"./MetadataService\";\nexport * from \"./OidcClient\";\nexport { OidcClientSettingsStore } from \"./OidcClientSettings\";\nexport type { OidcClientSettings, SigningKey } from \"./OidcClientSettings\";\nexport type { OidcMetadata } from \"./OidcMetadata\";\nexport { SessionMonitor } from \"./SessionMonitor\";\nexport type { SessionStatus } from \"./SessionStatus\";\nexport type { SigninRequest, SigninRequestArgs } from \"./SigninRequest\";\nexport { SigninResponse } from \"./SigninResponse\";\nexport { SigninState } from \"./SigninState\";\nexport type { SignoutRequest, SignoutRequestArgs } from \"./SignoutRequest\";\nexport { SignoutResponse } from \"./SignoutResponse\";\nexport { State } from \"./State\";\nexport type { StateStore } from \"./StateStore\";\nexport { User } from \"./User\";\nexport type { UserProfile } from \"./User\";\nexport * from \"./UserManager\";\nexport type {\n    UserManagerEvents,\n    SilentRenewErrorCallback,\n    UserLoadedCallback,\n    UserSessionChangedCallback,\n    UserSignedInCallback,\n    UserSignedOutCallback,\n    UserUnloadedCallback,\n} from \"./UserManagerEvents\";\nexport { UserManagerSettingsStore } from \"./UserManagerSettings\";\nexport type { UserManagerSettings } from \"./UserManagerSettings\";\nexport { Version } from \"./Version\";\nexport { WebStorageStateStore } from \"./WebStorageStateStore\";\n","import CryptoJS from \"crypto-js/core.js\";\nimport sha256 from \"crypto-js/sha256.js\";\nimport Base64 from \"crypto-js/enc-base64.js\";\nimport Utf8 from \"crypto-js/enc-utf8.js\";\n\nimport { Logger } from \"./Logger\";\n\nconst UUID_V4_TEMPLATE = \"10000000-1000-4000-8000-100000000000\";\n\n/**\n * @internal\n */\nexport class CryptoUtils {\n    private static _randomWord(): number {\n        return CryptoJS.lib.WordArray.random(1).words[0];\n    }\n\n    /**\n     * Generates RFC4122 version 4 guid\n     */\n    public static generateUUIDv4(): string {\n        const uuid = UUID_V4_TEMPLATE.replace(/[018]/g, c =>\n            (+c ^ CryptoUtils._randomWord() & 15 >> +c / 4).toString(16),\n        );\n        return uuid.replace(/-/g, \"\");\n    }\n\n    /**\n     * PKCE: Generate a code verifier\n     */\n    public static generateCodeVerifier(): string {\n        return CryptoUtils.generateUUIDv4() + CryptoUtils.generateUUIDv4() + CryptoUtils.generateUUIDv4();\n    }\n\n    /**\n     * PKCE: Generate a code challenge\n     */\n    public static generateCodeChallenge(code_verifier: string): string {\n        try {\n            const hashed = sha256(code_verifier);\n            return Base64.stringify(hashed).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n        }\n        catch (err) {\n            Logger.error(\"CryptoUtils.generateCodeChallenge\", err);\n            throw err;\n        }\n    }\n\n    /**\n     * Generates a base64-encoded string for a basic auth header\n     */\n    public static generateBasicAuth(client_id: string, client_secret: string): string {\n        const basicAuth = Utf8.parse([client_id, client_secret].join(\":\"));\n        return Base64.stringify(basicAuth);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\n/**\n * Native interface\n *\n * @public\n */\nexport interface ILogger {\n    debug(...args: unknown[]): void;\n    info(...args: unknown[]): void;\n    warn(...args: unknown[]): void;\n    error(...args: unknown[]): void;\n}\n\nconst nopLogger: ILogger = {\n    debug: () => undefined,\n    info: () => undefined,\n    warn: () => undefined,\n    error: () => undefined,\n};\n\nlet level: number;\nlet logger: ILogger;\n\n/**\n * Log levels\n *\n * @public\n */\nexport enum Log {\n    NONE,\n    ERROR,\n    WARN,\n    INFO,\n    DEBUG\n}\n\n/**\n * Log manager\n *\n * @public\n */\nexport namespace Log { // eslint-disable-line @typescript-eslint/no-namespace\n    export function reset(): void {\n        level = Log.INFO;\n        logger = nopLogger;\n    }\n\n    export function setLevel(value: Log): void {\n        if (!(Log.NONE <= value && value <= Log.DEBUG)) {\n            throw new Error(\"Invalid log level\");\n        }\n        level = value;\n    }\n\n    export function setLogger(value: ILogger): void {\n        logger = value;\n    }\n}\n\n/**\n * Internal logger instance\n *\n * @public\n */\nexport class Logger {\n    private _method?: string;\n    public constructor(private _name: string) {}\n\n    public debug(...args: unknown[]): void {\n        if (level >= Log.DEBUG) {\n            logger.debug(Logger._format(this._name, this._method), ...args);\n        }\n    }\n    public info(...args: unknown[]): void {\n        if (level >= Log.INFO) {\n            logger.info(Logger._format(this._name, this._method), ...args);\n        }\n    }\n    public warn(...args: unknown[]): void {\n        if (level >= Log.WARN) {\n            logger.warn(Logger._format(this._name, this._method), ...args);\n        }\n    }\n    public error(...args: unknown[]): void {\n        if (level >= Log.ERROR) {\n            logger.error(Logger._format(this._name, this._method), ...args);\n        }\n    }\n\n    public throw(err: Error): never {\n        this.error(err);\n        throw err;\n    }\n\n    public create(method: string): Logger {\n        const methodLogger: Logger = Object.create(this);\n        methodLogger._method = method;\n        methodLogger.debug(\"begin\");\n        return methodLogger;\n    }\n\n    public static createStatic(name: string, staticMethod: string): Logger {\n        const staticLogger = new Logger(`${name}.${staticMethod}`);\n        staticLogger.debug(\"begin\");\n        return staticLogger;\n    }\n\n    private static _format(name: string, method?: string) {\n        const prefix = `[${name}]`;\n        return method ? `${prefix} ${method}:` : prefix;\n    }\n\n    // helpers for static class methods\n    public static debug(name: string, ...args: unknown[]): void {\n        if (level >= Log.DEBUG) {\n            logger.debug(Logger._format(name), ...args);\n        }\n    }\n    public static info(name: string, ...args: unknown[]): void {\n        if (level >= Log.INFO) {\n            logger.info(Logger._format(name), ...args);\n        }\n    }\n    public static warn(name: string, ...args: unknown[]): void {\n        if (level >= Log.WARN) {\n            logger.warn(Logger._format(name), ...args);\n        }\n    }\n    public static error(name: string, ...args: unknown[]): void {\n        if (level >= Log.ERROR) {\n            logger.error(Logger._format(name), ...args);\n        }\n    }\n}\n\nLog.reset();\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./Logger\";\n\n/**\n * @internal\n */\nexport type Callback<EventType extends unknown[]> = (...ev: EventType) => (Promise<void> | void);\n\n/**\n * @internal\n */\nexport class Event<EventType extends unknown[]> {\n    protected readonly _logger = new Logger(`Event('${this._name}')`);\n\n    private _callbacks: Array<Callback<EventType>> = [];\n\n    public constructor(protected readonly _name: string) {}\n\n    public addHandler(cb: Callback<EventType>): () => void {\n        this._callbacks.push(cb);\n        return () => this.removeHandler(cb);\n    }\n\n    public removeHandler(cb: Callback<EventType>): void {\n        const idx = this._callbacks.lastIndexOf(cb);\n        if (idx >= 0) {\n            this._callbacks.splice(idx, 1);\n        }\n    }\n\n    public raise(...ev: EventType): void {\n        this._logger.debug(\"raise:\", ...ev);\n        for (const cb of this._callbacks) {\n            void cb(...ev);\n        }\n    }\n}\n","import jwt_decode from \"jwt-decode\";\n\nimport { Logger } from \"./Logger\";\nimport type { JwtClaims } from \"../Claims\";\n\n/**\n * @internal\n */\nexport class JwtUtils {\n    // IMPORTANT: doesn't validate the token\n    public static decode(token: string): JwtClaims {\n        try {\n            return jwt_decode<JwtClaims>(token);\n        }\n        catch (err) {\n            Logger.error(\"JwtUtils.decode\", err);\n            throw err;\n        }\n    }\n}\n","/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/open#window_features\n *\n * @public\n */\nexport interface PopupWindowFeatures {\n    left?: number;\n    top?: number;\n    width?: number;\n    height?: number;\n    menubar?: boolean | string;\n    toolbar?: boolean | string;\n    location?: boolean | string;\n    status?: boolean | string;\n    resizable?: boolean | string;\n    scrollbars?: boolean | string;\n\n    [k: string]: boolean | string | number | undefined;\n}\n\nexport class PopupUtils {\n    /**\n     * Populates a map of window features with a placement centered in front of\n     * the current window. If no explicit width is given, a default value is\n     * binned into [800, 720, 600, 480, 360] based on the current window's width.\n     */\n    static center({ ...features }: PopupWindowFeatures): PopupWindowFeatures {\n        if (features.width == null)\n            features.width = [800, 720, 600, 480].find(width => width <= window.outerWidth / 1.618) ?? 360;\n        features.left ??= Math.max(0, Math.round(window.screenX + (window.outerWidth - features.width) / 2));\n        if (features.height != null)\n            features.top ??= Math.max(0, Math.round(window.screenY + (window.outerHeight - features.height) / 2));\n        return features;\n    }\n\n    static serialize(features: PopupWindowFeatures): string {\n        return Object.entries(features)\n            .filter(([, value]) => value != null)\n            .map(([key, value]) => `${key}=${typeof value !== \"boolean\" ? value as string : value ? \"yes\" : \"no\"}`)\n            .join(\",\");\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Event } from \"./Event\";\nimport { Logger } from \"./Logger\";\n\n/**\n * @internal\n */\nexport class Timer extends Event<[void]> {\n    protected readonly _logger = new Logger(`Timer('${this._name}')`);\n    private _timerHandle: ReturnType<typeof setInterval> | null = null;\n    private _expiration = 0;\n\n    // get the time\n    public static getEpochTime(): number {\n        return Math.floor(Date.now() / 1000);\n    }\n\n    public init(durationInSeconds: number): void {\n        const logger = this._logger.create(\"init\");\n        durationInSeconds = Math.max(Math.floor(durationInSeconds), 1);\n        const expiration = Timer.getEpochTime() + durationInSeconds;\n        if (this.expiration === expiration && this._timerHandle) {\n            // no need to reinitialize to same expiration, so bail out\n            logger.debug(\"skipping since already initialized for expiration at\", this.expiration);\n            return;\n        }\n\n        this.cancel();\n\n        logger.debug(\"using duration\", durationInSeconds);\n        this._expiration = expiration;\n\n        // we're using a fairly short timer and then checking the expiration in the\n        // callback to handle scenarios where the browser device sleeps, and then\n        // the timers end up getting delayed.\n        const timerDurationInSeconds = Math.min(durationInSeconds, 5);\n        this._timerHandle = setInterval(this._callback, timerDurationInSeconds * 1000);\n    }\n\n    public get expiration(): number {\n        return this._expiration;\n    }\n\n    public cancel(): void {\n        this._logger.create(\"cancel\");\n        if (this._timerHandle) {\n            clearInterval(this._timerHandle);\n            this._timerHandle = null;\n        }\n    }\n\n    protected _callback = (): void => {\n        const diff = this._expiration - Timer.getEpochTime();\n        this._logger.debug(\"timer completes in\", diff);\n\n        if (this._expiration <= Timer.getEpochTime()) {\n            this.cancel();\n            super.raise();\n        }\n    };\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\n/**\n * @internal\n */\nexport class UrlUtils {\n    public static readParams(url: string, responseMode: \"query\" | \"fragment\" = \"query\"): URLSearchParams {\n        if (!url) throw new TypeError(\"Invalid URL\");\n        const parsedUrl = new URL(url, window.location.origin);\n        const params = parsedUrl[responseMode === \"fragment\" ? \"hash\" : \"search\"];\n        return new URLSearchParams(params.slice(1));\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"../utils\";\n\n/**\n * Error class thrown in case of an authentication error.\n *\n * See https://openid.net/specs/openid-connect-core-1_0.html#AuthError\n *\n * @public\n */\nexport class ErrorResponse extends Error {\n    /** Marker to detect class: \"ErrorResponse\" */\n    public readonly name: string = \"ErrorResponse\";\n\n    /** An error code string that can be used to classify the types of errors that occur and to respond to errors. */\n    public readonly error: string | null;\n    /** additional information that can help a developer identify the cause of the error.*/\n    public readonly error_description: string | null;\n    /**\n     * URI identifying a human-readable web page with information about the error, used to provide the client\n       developer with additional information about the error.\n    */\n    public readonly error_uri: string | null;\n\n    /** custom state data set during the initial signin request */\n    public state?: unknown;\n\n    public readonly session_state: string | null;\n\n    public constructor(\n        args: {\n            error?: string | null; error_description?: string | null; error_uri?: string | null;\n            userState?: unknown; session_state?: string | null;\n        },\n        /** The x-www-form-urlencoded request body sent to the authority server */\n        public readonly form?: URLSearchParams,\n    ) {\n        super(args.error_description || args.error || \"\");\n\n        if (!args.error) {\n            Logger.error(\"ErrorResponse\", \"No error passed\");\n            throw new Error(\"No error passed\");\n        }\n\n        this.error = args.error;\n        this.error_description = args.error_description ?? null;\n        this.error_uri = args.error_uri ?? null;\n\n        this.state = args.userState;\n        this.session_state = args.session_state ?? null;\n    }\n}\n","// Copyright (C) 2021 AuthTS Contributors\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\n/**\n * Error class thrown in case of network timeouts (e.g IFrame time out).\n *\n * @public\n */\nexport class ErrorTimeout extends Error {\n    /** Marker to detect class: \"ErrorTimeout\" */\n    public readonly name: string = \"ErrorTimeout\";\n\n    public constructor(message?: string) {\n        super(message);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, Timer } from \"./utils\";\nimport type { User } from \"./User\";\n\n/**\n * @public\n */\nexport type AccessTokenCallback = (...ev: unknown[]) => (Promise<void> | void);\n\n/**\n * @public\n */\nexport class AccessTokenEvents {\n    protected readonly _logger = new Logger(\"AccessTokenEvents\");\n\n    private readonly _expiringTimer = new Timer(\"Access token expiring\");\n    private readonly _expiredTimer = new Timer(\"Access token expired\");\n    private readonly _expiringNotificationTimeInSeconds: number;\n\n    public constructor(args: { expiringNotificationTimeInSeconds: number }) {\n        this._expiringNotificationTimeInSeconds = args.expiringNotificationTimeInSeconds;\n    }\n\n    public load(container: User): void {\n        const logger = this._logger.create(\"load\");\n        // only register events if there's an access token and it has an expiration\n        if (container.access_token && container.expires_in !== undefined) {\n            const duration = container.expires_in;\n            logger.debug(\"access token present, remaining duration:\", duration);\n\n            if (duration > 0) {\n                // only register expiring if we still have time\n                let expiring = duration - this._expiringNotificationTimeInSeconds;\n                if (expiring <= 0) {\n                    expiring = 1;\n                }\n\n                logger.debug(\"registering expiring timer, raising in\", expiring, \"seconds\");\n                this._expiringTimer.init(expiring);\n            }\n            else {\n                logger.debug(\"canceling existing expiring timer because we're past expiration.\");\n                this._expiringTimer.cancel();\n            }\n\n            // if it's negative, it will still fire\n            const expired = duration + 1;\n            logger.debug(\"registering expired timer, raising in\", expired, \"seconds\");\n            this._expiredTimer.init(expired);\n        }\n        else {\n            this._expiringTimer.cancel();\n            this._expiredTimer.cancel();\n        }\n    }\n\n    public unload(): void {\n        this._logger.debug(\"unload: canceling existing access token timers\");\n        this._expiringTimer.cancel();\n        this._expiredTimer.cancel();\n    }\n\n    /**\n     * Add callback: Raised prior to the access token expiring.\n     */\n    public addAccessTokenExpiring(cb: AccessTokenCallback): () => void {\n        return this._expiringTimer.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised prior to the access token expiring.\n     */\n    public removeAccessTokenExpiring(cb: AccessTokenCallback): void {\n        this._expiringTimer.removeHandler(cb);\n    }\n\n    /**\n     * Add callback: Raised after the access token has expired.\n     */\n    public addAccessTokenExpired(cb: AccessTokenCallback): () => void {\n        return this._expiredTimer.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised after the access token has expired.\n     */\n    public removeAccessTokenExpired(cb: AccessTokenCallback): void {\n        this._expiredTimer.removeHandler(cb);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\n\n/**\n * @internal\n */\nexport class CheckSessionIFrame {\n    private readonly _logger = new Logger(\"CheckSessionIFrame\");\n    private _frame_origin: string;\n    private _frame: HTMLIFrameElement;\n    private _timer: ReturnType<typeof setInterval> | null = null;\n    private _session_state: string | null = null;\n\n    public constructor(\n        private _callback: () => Promise<void>,\n        private _client_id: string,\n        url: string,\n        private _intervalInSeconds: number,\n        private _stopOnError: boolean,\n    ) {\n        const parsedUrl = new URL(url);\n        this._frame_origin = parsedUrl.origin;\n\n        this._frame = window.document.createElement(\"iframe\");\n\n        // shotgun approach\n        this._frame.style.visibility = \"hidden\";\n        this._frame.style.position = \"fixed\";\n        this._frame.style.left = \"-1000px\";\n        this._frame.style.top = \"0\";\n        this._frame.width = \"0\";\n        this._frame.height = \"0\";\n        this._frame.src = parsedUrl.href;\n    }\n\n    public load(): Promise<void> {\n        return new Promise<void>((resolve) => {\n            this._frame.onload = () => {\n                resolve();\n            };\n\n            window.document.body.appendChild(this._frame);\n            window.addEventListener(\"message\", this._message, false);\n        });\n    }\n\n    private _message = (e: MessageEvent<string>): void => {\n        if (e.origin === this._frame_origin &&\n            e.source === this._frame.contentWindow\n        ) {\n            if (e.data === \"error\") {\n                this._logger.error(\"error message from check session op iframe\");\n                if (this._stopOnError) {\n                    this.stop();\n                }\n            }\n            else if (e.data === \"changed\") {\n                this._logger.debug(\"changed message from check session op iframe\");\n                this.stop();\n                void this._callback();\n            }\n            else {\n                this._logger.debug(e.data + \" message from check session op iframe\");\n            }\n        }\n    };\n\n    public start(session_state: string): void {\n        if (this._session_state === session_state) {\n            return;\n        }\n\n        this._logger.create(\"start\");\n\n        this.stop();\n\n        this._session_state = session_state;\n\n        const send = () => {\n            if (!this._frame.contentWindow || !this._session_state) {\n                return;\n            }\n\n            this._frame.contentWindow.postMessage(this._client_id + \" \" + this._session_state, this._frame_origin);\n        };\n\n        // trigger now\n        send();\n\n        // and setup timer\n        this._timer = setInterval(send, this._intervalInSeconds * 1000);\n    }\n\n    public stop(): void {\n        this._logger.create(\"stop\");\n        this._session_state = null;\n\n        if (this._timer) {\n\n            clearInterval(this._timer);\n            this._timer = null;\n        }\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\n\n/**\n * @public\n */\nexport class InMemoryWebStorage implements Storage {\n    private readonly _logger = new Logger(\"InMemoryWebStorage\");\n    private _data: Record<string, string> = {};\n\n    public clear(): void {\n        this._logger.create(\"clear\");\n        this._data = {};\n    }\n\n    public getItem(key: string): string {\n        this._logger.create(`getItem('${key}')`);\n        return this._data[key];\n    }\n\n    public setItem(key: string, value: string): void {\n        this._logger.create(`setItem('${key}')`);\n        this._data[key] = value;\n    }\n\n    public removeItem(key: string): void {\n        this._logger.create(`removeItem('${key}')`);\n        delete this._data[key];\n    }\n\n    public get length(): number {\n        return Object.getOwnPropertyNames(this._data).length;\n    }\n\n    public key(index: number): string {\n        return Object.getOwnPropertyNames(this._data)[index];\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { ErrorResponse, ErrorTimeout } from \"./errors\";\nimport { Logger } from \"./utils\";\n\n/**\n * @internal\n */\nexport type JwtHandler = (text: string) => Promise<Record<string, unknown>>;\n\n/**\n * @internal\n */\nexport interface GetJsonOpts {\n    token?: string;\n    credentials?: RequestCredentials;\n}\n\n/**\n * @internal\n */\nexport interface PostFormOpts {\n    body: URLSearchParams;\n    basicAuth?: string;\n    timeoutInSeconds?: number;\n    initCredentials?: \"same-origin\" | \"include\" | \"omit\";\n}\n\n/**\n * @internal\n */\nexport class JsonService {\n    private readonly _logger = new Logger(\"JsonService\");\n\n    private _contentTypes: string[] = [];\n\n    public constructor(\n        additionalContentTypes: string[] = [],\n        private _jwtHandler: JwtHandler | null = null,\n    ) {\n        this._contentTypes.push(...additionalContentTypes, \"application/json\");\n        if (_jwtHandler) {\n            this._contentTypes.push(\"application/jwt\");\n        }\n    }\n\n    protected async fetchWithTimeout(input: RequestInfo, init: RequestInit & { timeoutInSeconds?: number } = {}) {\n        const { timeoutInSeconds, ...initFetch } = init;\n        if (!timeoutInSeconds) {\n            return await fetch(input, initFetch);\n        }\n\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), timeoutInSeconds * 1000);\n\n        try {\n            const response = await fetch(input, {\n                ...init,\n                signal: controller.signal,\n            });\n            return response;\n        }\n        catch (err) {\n            if (err instanceof DOMException && err.name === \"AbortError\") {\n                throw new ErrorTimeout(\"Network timed out\");\n            }\n            throw err;\n        }\n        finally {\n            clearTimeout(timeoutId);\n        }\n    }\n\n    public async getJson(url: string, {\n        token,\n        credentials,\n    }: GetJsonOpts = {}): Promise<Record<string, unknown>> {\n        const logger = this._logger.create(\"getJson\");\n        const headers: HeadersInit = {\n            \"Accept\": this._contentTypes.join(\", \"),\n        };\n        if (token) {\n            logger.debug(\"token passed, setting Authorization header\");\n            headers[\"Authorization\"] = \"Bearer \" + token;\n        }\n\n        let response: Response;\n        try {\n            logger.debug(\"url:\", url);\n            response = await this.fetchWithTimeout(url, { method: \"GET\", headers, credentials });\n        }\n        catch (err) {\n            logger.error(\"Network Error\");\n            throw err;\n        }\n\n        logger.debug(\"HTTP response received, status\", response.status);\n        const contentType = response.headers.get(\"Content-Type\");\n        if (contentType && !this._contentTypes.find(item => contentType.startsWith(item))) {\n            logger.throw(new Error(`Invalid response Content-Type: ${(contentType ?? \"undefined\")}, from URL: ${url}`));\n        }\n        if (response.ok && this._jwtHandler && contentType?.startsWith(\"application/jwt\")) {\n            return await this._jwtHandler(await response.text());\n        }\n        let json: Record<string, unknown>;\n        try {\n            json = await response.json();\n        }\n        catch (err) {\n            logger.error(\"Error parsing JSON response\", err);\n            if (response.ok) throw err;\n            throw new Error(`${response.statusText} (${response.status})`);\n        }\n        if (!response.ok) {\n            logger.error(\"Error from server:\", json);\n            if (json.error) {\n                throw new ErrorResponse(json);\n            }\n            throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n        }\n        return json;\n    }\n\n    public async postForm(url: string, {\n        body,\n        basicAuth,\n        timeoutInSeconds,\n        initCredentials,\n    }: PostFormOpts): Promise<Record<string, unknown>> {\n        const logger = this._logger.create(\"postForm\");\n        const headers: HeadersInit = {\n            \"Accept\": this._contentTypes.join(\", \"),\n            \"Content-Type\": \"application/x-www-form-urlencoded\",\n        };\n        if (basicAuth !== undefined) {\n            headers[\"Authorization\"] = \"Basic \" + basicAuth;\n        }\n\n        let response: Response;\n        try {\n            logger.debug(\"url:\", url);\n            response = await this.fetchWithTimeout(url, { method: \"POST\", headers, body, timeoutInSeconds, credentials: initCredentials });\n        }\n        catch (err) {\n            logger.error(\"Network error\");\n            throw err;\n        }\n\n        logger.debug(\"HTTP response received, status\", response.status);\n        const contentType = response.headers.get(\"Content-Type\");\n        if (contentType && !this._contentTypes.find(item => contentType.startsWith(item))) {\n            throw new Error(`Invalid response Content-Type: ${(contentType ?? \"undefined\")}, from URL: ${url}`);\n        }\n\n        const responseText = await response.text();\n\n        let json: Record<string, unknown> = {};\n        if (responseText) {\n            try {\n                json = JSON.parse(responseText);\n            }\n            catch (err) {\n                logger.error(\"Error parsing JSON response\", err);\n                if (response.ok) throw err;\n                throw new Error(`${response.statusText} (${response.status})`);\n            }\n        }\n\n        if (!response.ok) {\n            logger.error(\"Error from server:\", json);\n            if (json.error) {\n                throw new ErrorResponse(json, body);\n            }\n            throw new Error(`${response.statusText} (${response.status}): ${JSON.stringify(json)}`);\n        }\n\n        return json;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\nimport { JsonService } from \"./JsonService\";\nimport type { OidcClientSettingsStore, SigningKey } from \"./OidcClientSettings\";\nimport type { OidcMetadata } from \"./OidcMetadata\";\n\n/**\n * @public\n */\nexport class MetadataService {\n    private readonly _logger = new Logger(\"MetadataService\");\n    private readonly _jsonService = new JsonService([\"application/jwk-set+json\"]);\n\n    // cache\n    private _metadataUrl: string;\n    private _signingKeys: SigningKey[] | null = null;\n    private _metadata: Partial<OidcMetadata> | null = null;\n    private _fetchRequestCredentials: RequestCredentials | undefined;\n\n    public constructor(private readonly _settings: OidcClientSettingsStore) {\n        this._metadataUrl = this._settings.metadataUrl;\n\n        if (this._settings.signingKeys) {\n            this._logger.debug(\"using signingKeys from settings\");\n            this._signingKeys = this._settings.signingKeys;\n        }\n\n        if (this._settings.metadata) {\n            this._logger.debug(\"using metadata from settings\");\n            this._metadata = this._settings.metadata;\n        }\n\n        if (this._settings.fetchRequestCredentials) {\n            this._logger.debug(\"using fetchRequestCredentials from settings\");\n            this._fetchRequestCredentials = this._settings.fetchRequestCredentials;\n        }\n    }\n\n    public resetSigningKeys(): void {\n        this._signingKeys = null;\n    }\n\n    public async getMetadata(): Promise<Partial<OidcMetadata>> {\n        const logger = this._logger.create(\"getMetadata\");\n        if (this._metadata) {\n            logger.debug(\"using cached values\");\n            return this._metadata;\n        }\n\n        if (!this._metadataUrl) {\n            logger.throw(new Error(\"No authority or metadataUrl configured on settings\"));\n            throw null;\n        }\n\n        logger.debug(\"getting metadata from\", this._metadataUrl);\n        const metadata = await this._jsonService.getJson(this._metadataUrl, { credentials: this._fetchRequestCredentials });\n\n        logger.debug(\"merging remote JSON with seed metadata\");\n        this._metadata = Object.assign({}, this._settings.metadataSeed, metadata);\n        return this._metadata;\n    }\n\n    public getIssuer(): Promise<string> {\n        return this._getMetadataProperty(\"issuer\") as Promise<string>;\n    }\n\n    public getAuthorizationEndpoint(): Promise<string> {\n        return this._getMetadataProperty(\"authorization_endpoint\") as Promise<string>;\n    }\n\n    public getUserInfoEndpoint(): Promise<string> {\n        return this._getMetadataProperty(\"userinfo_endpoint\") as Promise<string>;\n    }\n\n    public getTokenEndpoint(optional: false): Promise<string>;\n    public getTokenEndpoint(optional?: true): Promise<string | undefined>;\n    public getTokenEndpoint(optional = true): Promise<string | undefined> {\n        return this._getMetadataProperty(\"token_endpoint\", optional) as Promise<string | undefined>;\n    }\n\n    public getCheckSessionIframe(): Promise<string | undefined> {\n        return this._getMetadataProperty(\"check_session_iframe\", true) as Promise<string | undefined>;\n    }\n\n    public getEndSessionEndpoint(): Promise<string | undefined> {\n        return this._getMetadataProperty(\"end_session_endpoint\", true) as Promise<string | undefined>;\n    }\n\n    public getRevocationEndpoint(optional: false): Promise<string>;\n    public getRevocationEndpoint(optional?: true): Promise<string | undefined>;\n    public getRevocationEndpoint(optional = true): Promise<string | undefined> {\n        return this._getMetadataProperty(\"revocation_endpoint\", optional) as Promise<string | undefined>;\n    }\n\n    public getKeysEndpoint(optional: false): Promise<string>;\n    public getKeysEndpoint(optional?: true): Promise<string | undefined>;\n    public getKeysEndpoint(optional = true): Promise<string | undefined> {\n        return this._getMetadataProperty(\"jwks_uri\", optional) as Promise<string | undefined>;\n    }\n\n    protected async _getMetadataProperty(name: keyof OidcMetadata, optional=false): Promise<string | boolean | string[] | undefined> {\n        const logger = this._logger.create(`_getMetadataProperty('${name}')`);\n\n        const metadata = await this.getMetadata();\n        logger.debug(\"resolved\");\n\n        if (metadata[name] === undefined) {\n            if (optional === true) {\n                logger.warn(\"Metadata does not contain optional property\");\n                return undefined;\n            }\n\n            logger.throw(new Error(\"Metadata does not contain property \" + name));\n        }\n\n        return metadata[name];\n    }\n\n    public async getSigningKeys(): Promise<SigningKey[] | null> {\n        const logger = this._logger.create(\"getSigningKeys\");\n        if (this._signingKeys) {\n            logger.debug(\"returning signingKeys from cache\");\n            return this._signingKeys;\n        }\n\n        const jwks_uri = await this.getKeysEndpoint(false);\n        logger.debug(\"got jwks_uri\", jwks_uri);\n\n        const keySet = await this._jsonService.getJson(jwks_uri);\n        logger.debug(\"got key set\", keySet);\n\n        if (!Array.isArray(keySet.keys)) {\n            logger.throw(new Error(\"Missing keys on keyset\"));\n            throw null; // https://github.com/microsoft/TypeScript/issues/46972\n        }\n\n        this._signingKeys = keySet.keys;\n        return this._signingKeys;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\nimport type { StateStore } from \"./StateStore\";\nimport type { AsyncStorage } from \"./AsyncStorage\";\n\n/**\n * @public\n */\nexport class WebStorageStateStore implements StateStore {\n    private readonly _logger = new Logger(\"WebStorageStateStore\");\n\n    private readonly _store: AsyncStorage | Storage;\n    private readonly _prefix: string;\n\n    public constructor({\n        prefix = \"oidc.\",\n        store = localStorage,\n    }: { prefix?: string; store?: AsyncStorage | Storage } = {}) {\n        this._store = store;\n        this._prefix = prefix;\n    }\n\n    public async set(key: string, value: string): Promise<void> {\n        this._logger.create(`set('${key}')`);\n\n        key = this._prefix + key;\n        await this._store.setItem(key, value);\n    }\n\n    public async get(key: string): Promise<string | null> {\n        this._logger.create(`get('${key}')`);\n\n        key = this._prefix + key;\n        const item = await this._store.getItem(key);\n        return item;\n    }\n\n    public async remove(key: string): Promise<string | null> {\n        this._logger.create(`remove('${key}')`);\n\n        key = this._prefix + key;\n        const item = await this._store.getItem(key);\n        await this._store.removeItem(key);\n        return item;\n    }\n\n    public async getAllKeys(): Promise<string[]> {\n        this._logger.create(\"getAllKeys\");\n        const len = await this._store.length;\n\n        const keys = [];\n        for (let index = 0; index < len; index++) {\n            const key = await this._store.key(index);\n            if (key && key.indexOf(this._prefix) === 0) {\n                keys.push(key.substr(this._prefix.length));\n            }\n        }\n        return keys;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { WebStorageStateStore } from \"./WebStorageStateStore\";\nimport type { OidcMetadata } from \"./OidcMetadata\";\nimport type { StateStore } from \"./StateStore\";\nimport { InMemoryWebStorage } from \"./InMemoryWebStorage\";\n\nconst DefaultResponseType = \"code\";\nconst DefaultScope = \"openid\";\nconst DefaultClientAuthentication = \"client_secret_post\";\nconst DefaultResponseMode = \"query\";\nconst DefaultStaleStateAgeInSeconds = 60 * 15;\nconst DefaultClockSkewInSeconds = 60 * 5;\n\n/**\n * @public\n */\nexport type SigningKey = Record<string, string | string[]>;\n\n/**\n * The settings used to configure the {@link OidcClient}.\n *\n * @public\n */\nexport interface OidcClientSettings {\n    /** The URL of the OIDC/OAuth2 provider */\n    authority: string;\n    metadataUrl?: string;\n    /** Provide metadata when authority server does not allow CORS on the metadata endpoint */\n    metadata?: Partial<OidcMetadata>;\n    /** Can be used to seed or add additional values to the results of the discovery request */\n    metadataSeed?: Partial<OidcMetadata>;\n    /** Provide signingKeys when authority server does not allow CORS on the jwks uri */\n    signingKeys?: SigningKey[];\n\n    /** Your client application's identifier as registered with the OIDC/OAuth2 */\n    client_id: string;\n    client_secret?: string;\n    /** The type of response desired from the OIDC/OAuth2 provider (default: \"code\") */\n    response_type?: string;\n    /** The scope being requested from the OIDC/OAuth2 provider (default: \"openid\") */\n    scope?: string;\n    /** The redirect URI of your client application to receive a response from the OIDC/OAuth2 provider */\n    redirect_uri: string;\n    /** The OIDC/OAuth2 post-logout redirect URI */\n    post_logout_redirect_uri?: string;\n\n    /**\n     * Client authentication method that is used to authenticate when using the token endpoint (default: \"client_secret_post\")\n     * - \"client_secret_basic\": using the HTTP Basic authentication scheme\n     * - \"client_secret_post\": including the client credentials in the request body\n     *\n     * See https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication\n     */\n    client_authentication?: \"client_secret_basic\" | \"client_secret_post\";\n\n    /** optional protocol param */\n    prompt?: string;\n    /** optional protocol param */\n    display?: string;\n    /** optional protocol param */\n    max_age?: number;\n    /** optional protocol param */\n    ui_locales?: string;\n    /** optional protocol param */\n    acr_values?: string;\n    /** optional protocol param */\n    resource?: string | string[];\n\n    /** optional protocol param (default: \"query\") */\n    response_mode?: \"query\" | \"fragment\";\n\n    /**\n     * Should optional OIDC protocol claims be removed from profile or specify the ones to be removed (default: true)\n     * When true, the following claims are removed by default: [\"nbf\", \"jti\", \"auth_time\", \"nonce\", \"acr\", \"amr\", \"azp\", \"at_hash\"]\n     * When specifying claims, the following claims are not allowed: [\"sub\", \"iss\", \"aud\", \"exp\", \"iat\"]\n    */\n    filterProtocolClaims?: boolean | string[];\n    /** Flag to control if additional identity data is loaded from the user info endpoint in order to populate the user's profile (default: false) */\n    loadUserInfo?: boolean;\n    /** Number (in seconds) indicating the age of state entries in storage for authorize requests that are considered abandoned and thus can be cleaned up (default: 900) */\n    staleStateAgeInSeconds?: number;\n\n    /** @deprecated Unused */\n    clockSkewInSeconds?: number;\n    /** @deprecated Unused */\n    userInfoJwtIssuer?: \"ANY\" | \"OP\" | string;\n\n    /**\n     * Indicates if objects returned from the user info endpoint as claims (e.g. `address`) are merged into the claims from the id token as a single object.\n     * Otherwise, they are added to an array as distinct objects for the claim type. (default: false)\n     */\n    mergeClaims?: boolean;\n\n    /**\n     * Storage object used to persist interaction state (default: window.localStorage, InMemoryWebStorage iff no window).\n     * E.g. `stateStore: new WebStorageStateStore({ store: window.localStorage })`\n     */\n    stateStore?: StateStore;\n\n    /**\n     * An object containing additional query string parameters to be including in the authorization request.\n     * E.g, when using Azure AD to obtain an access token an additional resource parameter is required. extraQueryParams: `{resource:\"some_identifier\"}`\n     */\n    extraQueryParams?: Record<string, string | number | boolean>;\n\n    extraTokenParams?: Record<string, unknown>;\n\n    /**\n     * @deprecated since version 2.1.0. Use fetchRequestCredentials instead.\n     */\n    refreshTokenCredentials?: \"same-origin\" | \"include\" | \"omit\";\n\n    /**\n     * Will check the content type header of the response of the revocation endpoint to match these passed values (default: [])\n     */\n    revokeTokenAdditionalContentTypes?: string[];\n\n    /**\n     * Sets the credentials for fetch requests. (default: \"same-origin\")\n     * Use this if you need to send cookies to the OIDC/OAuth2 provider or if you are using a proxy that requires cookies\n     */\n    fetchRequestCredentials?: RequestCredentials;\n\n    /**\n     * Only scopes in this list will be passed in the token refresh request.\n     */\n    refreshTokenAllowedScope?: string | undefined;\n}\n\n/**\n * The settings with defaults applied of the {@link OidcClient}.\n * @see {@link OidcClientSettings}\n *\n * @public\n */\nexport class OidcClientSettingsStore {\n    // metadata\n    public readonly authority: string;\n    public readonly metadataUrl: string;\n    public readonly metadata: Partial<OidcMetadata> | undefined;\n    public readonly metadataSeed: Partial<OidcMetadata> | undefined;\n    public readonly signingKeys: SigningKey[] | undefined;\n\n    // client config\n    public readonly client_id: string;\n    public readonly client_secret: string | undefined;\n    public readonly response_type: string;\n    public readonly scope: string;\n    public readonly redirect_uri: string;\n    public readonly post_logout_redirect_uri: string | undefined;\n    public readonly client_authentication: \"client_secret_basic\" | \"client_secret_post\";\n\n    // optional protocol params\n    public readonly prompt: string | undefined;\n    public readonly display: string | undefined;\n    public readonly max_age: number | undefined;\n    public readonly ui_locales: string | undefined;\n    public readonly acr_values: string | undefined;\n    public readonly resource: string | string[] | undefined;\n    public readonly response_mode: \"query\" | \"fragment\";\n\n    // behavior flags\n    public readonly filterProtocolClaims: boolean | string[];\n    public readonly loadUserInfo: boolean;\n    public readonly staleStateAgeInSeconds: number;\n    public readonly clockSkewInSeconds: number;\n    public readonly userInfoJwtIssuer: \"ANY\" | \"OP\" | string;\n    public readonly mergeClaims: boolean;\n\n    public readonly stateStore: StateStore;\n\n    // extra\n    public readonly extraQueryParams: Record<string, string | number | boolean>;\n    public readonly extraTokenParams: Record<string, unknown>;\n\n    public readonly revokeTokenAdditionalContentTypes?: string[];\n    public readonly fetchRequestCredentials: RequestCredentials;\n    public readonly refreshTokenAllowedScope: string | undefined;\n\n    public constructor({\n        // metadata related\n        authority, metadataUrl, metadata, signingKeys, metadataSeed,\n        // client related\n        client_id, client_secret, response_type = DefaultResponseType, scope = DefaultScope,\n        redirect_uri, post_logout_redirect_uri,\n        client_authentication = DefaultClientAuthentication,\n        // optional protocol\n        prompt, display, max_age, ui_locales, acr_values, resource, response_mode = DefaultResponseMode,\n        // behavior flags\n        filterProtocolClaims = true,\n        loadUserInfo = false,\n        staleStateAgeInSeconds = DefaultStaleStateAgeInSeconds,\n        clockSkewInSeconds = DefaultClockSkewInSeconds,\n        userInfoJwtIssuer = \"OP\",\n        mergeClaims = false,\n        // other behavior\n        stateStore,\n        refreshTokenCredentials,\n        revokeTokenAdditionalContentTypes,\n        fetchRequestCredentials,\n        refreshTokenAllowedScope,\n        // extra query params\n        extraQueryParams = {},\n        extraTokenParams = {},\n    }: OidcClientSettings) {\n\n        this.authority = authority;\n\n        if (metadataUrl) {\n            this.metadataUrl = metadataUrl;\n        } else {\n            this.metadataUrl = authority;\n            if (authority) {\n                if (!this.metadataUrl.endsWith(\"/\")) {\n                    this.metadataUrl += \"/\";\n                }\n                this.metadataUrl += \".well-known/openid-configuration\";\n            }\n        }\n\n        this.metadata = metadata;\n        this.metadataSeed = metadataSeed;\n        this.signingKeys = signingKeys;\n\n        this.client_id = client_id;\n        this.client_secret = client_secret;\n        this.response_type = response_type;\n        this.scope = scope;\n        this.redirect_uri = redirect_uri;\n        this.post_logout_redirect_uri = post_logout_redirect_uri;\n        this.client_authentication = client_authentication;\n\n        this.prompt = prompt;\n        this.display = display;\n        this.max_age = max_age;\n        this.ui_locales = ui_locales;\n        this.acr_values = acr_values;\n        this.resource = resource;\n        this.response_mode = response_mode;\n\n        this.filterProtocolClaims = filterProtocolClaims ?? true;\n        this.loadUserInfo = !!loadUserInfo;\n        this.staleStateAgeInSeconds = staleStateAgeInSeconds;\n        this.clockSkewInSeconds = clockSkewInSeconds;\n        this.userInfoJwtIssuer = userInfoJwtIssuer;\n        this.mergeClaims = !!mergeClaims;\n\n        this.revokeTokenAdditionalContentTypes = revokeTokenAdditionalContentTypes;\n\n        if (fetchRequestCredentials && refreshTokenCredentials) {\n            console.warn(\"Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used.\");\n        }\n        this.fetchRequestCredentials = fetchRequestCredentials ? fetchRequestCredentials\n            : refreshTokenCredentials ? refreshTokenCredentials : \"same-origin\";\n\n        if (stateStore) {\n            this.stateStore = stateStore;\n        }\n        else {\n            const store = typeof window !== \"undefined\" ? window.localStorage : new InMemoryWebStorage();\n            this.stateStore = new WebStorageStateStore({ store });\n        }\n\n        this.refreshTokenAllowedScope = refreshTokenAllowedScope;\n\n        this.extraQueryParams = extraQueryParams;\n        this.extraTokenParams = extraTokenParams;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, JwtUtils } from \"./utils\";\nimport { JsonService } from \"./JsonService\";\nimport type { MetadataService } from \"./MetadataService\";\nimport type { JwtClaims } from \"./Claims\";\nimport type { OidcClientSettingsStore } from \"./OidcClientSettings\";\n\n/**\n * @internal\n */\nexport class UserInfoService {\n    protected readonly _logger = new Logger(\"UserInfoService\");\n    private readonly _jsonService: JsonService;\n\n    public constructor(private readonly _settings: OidcClientSettingsStore,\n        private readonly _metadataService: MetadataService,\n    ) {\n        this._jsonService = new JsonService(undefined, this._getClaimsFromJwt);\n    }\n\n    public async getClaims(token: string): Promise<JwtClaims> {\n        const logger = this._logger.create(\"getClaims\");\n        if (!token) {\n            this._logger.throw(new Error(\"No token passed\"));\n        }\n\n        const url = await this._metadataService.getUserInfoEndpoint();\n        logger.debug(\"got userinfo url\", url);\n\n        const claims = await this._jsonService.getJson(url, {\n            token,\n            credentials: this._settings.fetchRequestCredentials,\n        });\n        logger.debug(\"got claims\", claims);\n\n        return claims;\n    }\n\n    protected _getClaimsFromJwt = async (responseText: string): Promise<JwtClaims> => {\n        const logger = this._logger.create(\"_getClaimsFromJwt\");\n        try {\n            const payload = JwtUtils.decode(responseText);\n            logger.debug(\"JWT decoding successful\");\n\n            return payload;\n        } catch (err) {\n            logger.error(\"Error parsing JWT response\");\n            throw err;\n        }\n    };\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { CryptoUtils, Logger } from \"./utils\";\nimport { JsonService } from \"./JsonService\";\nimport type { MetadataService } from \"./MetadataService\";\nimport type { OidcClientSettingsStore } from \"./OidcClientSettings\";\n\n/**\n * @internal\n */\nexport interface ExchangeCodeArgs {\n    client_id?: string;\n    client_secret?: string;\n    redirect_uri?: string;\n\n    grant_type?: string;\n    code: string;\n    code_verifier?: string;\n}\n\n/**\n * @internal\n */\nexport interface ExchangeCredentialsArgs {\n    client_id?: string;\n    client_secret?: string;\n\n    grant_type?: string;\n    scope?: string;\n\n    username: string;\n    password: string;\n}\n\n/**\n * @internal\n */\nexport interface ExchangeRefreshTokenArgs {\n    client_id?: string;\n    client_secret?: string;\n\n    grant_type?: string;\n    refresh_token: string;\n    scope?: string;\n\n    timeoutInSeconds?: number;\n}\n\n/**\n * @internal\n */\nexport interface RevokeArgs {\n    token: string;\n    token_type_hint?: \"access_token\" | \"refresh_token\";\n}\n\n/**\n * @internal\n */\nexport class TokenClient {\n    private readonly _logger = new Logger(\"TokenClient\");\n    private readonly _jsonService;\n\n    public constructor(\n        private readonly _settings: OidcClientSettingsStore,\n        private readonly _metadataService: MetadataService,\n    ) {\n        this._jsonService = new JsonService(this._settings.revokeTokenAdditionalContentTypes);\n    }\n\n    public async exchangeCode({\n        grant_type = \"authorization_code\",\n        redirect_uri = this._settings.redirect_uri,\n        client_id = this._settings.client_id,\n        client_secret = this._settings.client_secret,\n        ...args\n    }: ExchangeCodeArgs): Promise<Record<string, unknown>> {\n        const logger = this._logger.create(\"exchangeCode\");\n        if (!client_id) {\n            logger.throw(new Error(\"A client_id is required\"));\n        }\n        if (!redirect_uri) {\n            logger.throw(new Error(\"A redirect_uri is required\"));\n        }\n        if (!args.code) {\n            logger.throw(new Error(\"A code is required\"));\n        }\n        if (!args.code_verifier) {\n            logger.throw(new Error(\"A code_verifier is required\"));\n        }\n\n        const params = new URLSearchParams({ grant_type, redirect_uri });\n        for (const [key, value] of Object.entries(args)) {\n            if (value != null) {\n                params.set(key, value);\n            }\n        }\n        let basicAuth: string | undefined;\n        switch (this._settings.client_authentication) {\n            case \"client_secret_basic\":\n                if (!client_secret) {\n                    logger.throw(new Error(\"A client_secret is required\"));\n                    throw null; // https://github.com/microsoft/TypeScript/issues/46972\n                }\n                basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n                break;\n            case \"client_secret_post\":\n                params.append(\"client_id\", client_id);\n                if (client_secret) {\n                    params.append(\"client_secret\", client_secret);\n                }\n                break;\n        }\n\n        const url = await this._metadataService.getTokenEndpoint(false);\n        logger.debug(\"got token endpoint\");\n\n        const response = await this._jsonService.postForm(url, { body: params, basicAuth, initCredentials: this._settings.fetchRequestCredentials });\n        logger.debug(\"got response\");\n\n        return response;\n    }\n\n    public async exchangeCredentials({\n        grant_type = \"password\",\n        client_id = this._settings.client_id,\n        client_secret = this._settings.client_secret,\n        scope = this._settings.scope,\n        ...args\n    }: ExchangeCredentialsArgs): Promise<Record<string, unknown>> {\n        const logger = this._logger.create(\"exchangeCredentials\");\n\n        if (!client_id) {\n            logger.throw(new Error(\"A client_id is required\"));\n        }\n\n        const params = new URLSearchParams({ grant_type, scope });\n        for (const [key, value] of Object.entries(args)) {\n            if (value != null) {\n                params.set(key, value);\n            }\n        }\n\n        let basicAuth: string | undefined;\n        switch (this._settings.client_authentication) {\n            case \"client_secret_basic\":\n                if (!client_secret) {\n                    logger.throw(new Error(\"A client_secret is required\"));\n                    throw null; // https://github.com/microsoft/TypeScript/issues/46972\n                }\n                basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n                break;\n            case \"client_secret_post\":\n                params.append(\"client_id\", client_id);\n                if (client_secret) {\n                    params.append(\"client_secret\", client_secret);\n                }\n                break;\n        }\n\n        const url = await this._metadataService.getTokenEndpoint(false);\n        logger.debug(\"got token endpoint\");\n\n        const response = await this._jsonService.postForm(url, { body: params, basicAuth, initCredentials: this._settings.fetchRequestCredentials });\n        logger.debug(\"got response\");\n\n        return response;\n    }\n\n    public async exchangeRefreshToken({\n        grant_type = \"refresh_token\",\n        client_id = this._settings.client_id,\n        client_secret = this._settings.client_secret,\n        timeoutInSeconds,\n        ...args\n    }: ExchangeRefreshTokenArgs): Promise<Record<string, unknown>> {\n        const logger = this._logger.create(\"exchangeRefreshToken\");\n        if (!client_id) {\n            logger.throw(new Error(\"A client_id is required\"));\n        }\n        if (!args.refresh_token) {\n            logger.throw(new Error(\"A refresh_token is required\"));\n        }\n\n        const params = new URLSearchParams({ grant_type });\n        for (const [key, value] of Object.entries(args)) {\n            if (value != null) {\n                params.set(key, value);\n            }\n        }\n        let basicAuth: string | undefined;\n        switch (this._settings.client_authentication) {\n            case \"client_secret_basic\":\n                if (!client_secret) {\n                    logger.throw(new Error(\"A client_secret is required\"));\n                    throw null; // https://github.com/microsoft/TypeScript/issues/46972\n                }\n                basicAuth = CryptoUtils.generateBasicAuth(client_id, client_secret);\n                break;\n            case \"client_secret_post\":\n                params.append(\"client_id\", client_id);\n                if (client_secret) {\n                    params.append(\"client_secret\", client_secret);\n                }\n                break;\n        }\n\n        const url = await this._metadataService.getTokenEndpoint(false);\n        logger.debug(\"got token endpoint\");\n\n        const response = await this._jsonService.postForm(url, { body: params, basicAuth, timeoutInSeconds, initCredentials: this._settings.fetchRequestCredentials });\n        logger.debug(\"got response\");\n\n        return response;\n    }\n\n    /**\n     * Revoke an access or refresh token.\n     *\n     * @see https://datatracker.ietf.org/doc/html/rfc7009#section-2.1\n     */\n    public async revoke(args: RevokeArgs): Promise<void> {\n        const logger = this._logger.create(\"revoke\");\n        if (!args.token) {\n            logger.throw(new Error(\"A token is required\"));\n        }\n\n        const url = await this._metadataService.getRevocationEndpoint(false);\n\n        logger.debug(`got revocation endpoint, revoking ${args.token_type_hint ?? \"default token type\"}`);\n\n        const params = new URLSearchParams();\n        for (const [key, value] of Object.entries(args)) {\n            if (value != null) {\n                params.set(key, value);\n            }\n        }\n        params.set(\"client_id\", this._settings.client_id);\n        if (this._settings.client_secret) {\n            params.set(\"client_secret\", this._settings.client_secret);\n        }\n\n        await this._jsonService.postForm(url, { body: params });\n        logger.debug(\"got response\");\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, JwtUtils } from \"./utils\";\nimport { ErrorResponse } from \"./errors\";\nimport type { MetadataService } from \"./MetadataService\";\nimport { UserInfoService } from \"./UserInfoService\";\nimport { TokenClient } from \"./TokenClient\";\nimport type { OidcClientSettingsStore } from \"./OidcClientSettings\";\nimport type { SigninState } from \"./SigninState\";\nimport type { SigninResponse } from \"./SigninResponse\";\nimport type { State } from \"./State\";\nimport type { SignoutResponse } from \"./SignoutResponse\";\nimport type { UserProfile } from \"./User\";\nimport type { RefreshState } from \"./RefreshState\";\nimport type { JwtClaims, IdTokenClaims } from \"./Claims\";\n\n/**\n * Protocol claims that could be removed by default from profile.\n * Derived from the following sets of claims:\n * - {@link https://datatracker.ietf.org/doc/html/rfc7519.html#section-4.1}\n * - {@link https://openid.net/specs/openid-connect-core-1_0.html#IDToken}\n * - {@link https://openid.net/specs/openid-connect-core-1_0.html#CodeIDToken}\n *\n * @internal\n */\nconst DefaultProtocolClaims = [\n    \"nbf\",\n    \"jti\",\n    \"auth_time\",\n    \"nonce\",\n    \"acr\",\n    \"amr\",\n    \"azp\",\n    \"at_hash\", // https://openid.net/specs/openid-connect-core-1_0.html#CodeIDToken\n] as const;\n\n/**\n * Protocol claims that should never be removed from profile.\n * \"sub\" is needed internally and others should remain required as per the OIDC specs.\n *\n * @internal\n */\nconst InternalRequiredProtocolClaims = [\"sub\", \"iss\", \"aud\", \"exp\", \"iat\"];\n\n/**\n * @internal\n */\nexport class ResponseValidator {\n    protected readonly _logger = new Logger(\"ResponseValidator\");\n    protected readonly _userInfoService = new UserInfoService(this._settings, this._metadataService);\n    protected readonly _tokenClient = new TokenClient(this._settings, this._metadataService);\n\n    public constructor(\n        protected readonly _settings: OidcClientSettingsStore,\n        protected readonly _metadataService: MetadataService,\n    ) {}\n\n    public async validateSigninResponse(response: SigninResponse, state: SigninState): Promise<void> {\n        const logger = this._logger.create(\"validateSigninResponse\");\n\n        this._processSigninState(response, state);\n        logger.debug(\"state processed\");\n\n        await this._processCode(response, state);\n        logger.debug(\"code processed\");\n\n        if (response.isOpenId) {\n            this._validateIdTokenAttributes(response);\n        }\n        logger.debug(\"tokens validated\");\n\n        await this._processClaims(response, state?.skipUserInfo, response.isOpenId);\n        logger.debug(\"claims processed\");\n    }\n\n    public async validateCredentialsResponse(response: SigninResponse, skipUserInfo: boolean): Promise<void> {\n        const logger = this._logger.create(\"validateCredentialsResponse\");\n\n        if (response.isOpenId) {\n            this._validateIdTokenAttributes(response);\n        }\n        logger.debug(\"tokens validated\");\n\n        await this._processClaims(response, skipUserInfo, response.isOpenId);\n        logger.debug(\"claims processed\");\n    }\n\n    public async validateRefreshResponse(response: SigninResponse, state: RefreshState): Promise<void> {\n        const logger = this._logger.create(\"validateRefreshResponse\");\n\n        response.userState = state.data;\n        // if there's no session_state on the response, copy over session_state from original request\n        response.session_state ??= state.session_state;\n        // if there's no scope on the response, then assume all scopes granted (per-spec) and copy over scopes from original request\n        response.scope ??= state.scope;\n\n        // OpenID Connect Core 1.0 says that id_token is optional in refresh response:\n        // https://openid.net/specs/openid-connect-core-1_0.html#RefreshTokenResponse\n        if (response.isOpenId && !!response.id_token) {\n            this._validateIdTokenAttributes(response, state.id_token);\n            logger.debug(\"ID Token validated\");\n        }\n\n        if (!response.id_token) {\n            // if there's no id_token on the response, copy over id_token from original request\n            response.id_token = state.id_token;\n            // and decoded part too\n            response.profile = state.profile;\n        }\n\n        const hasIdToken = response.isOpenId && !!response.id_token;\n        await this._processClaims(response, false, hasIdToken);\n        logger.debug(\"claims processed\");\n    }\n\n    public validateSignoutResponse(response: SignoutResponse, state: State): void {\n        const logger = this._logger.create(\"validateSignoutResponse\");\n        if (state.id !== response.state) {\n            logger.throw(new Error(\"State does not match\"));\n        }\n\n        // now that we know the state matches, take the stored data\n        // and set it into the response so callers can get their state\n        // this is important for both success & error outcomes\n        logger.debug(\"state validated\");\n        response.userState = state.data;\n\n        if (response.error) {\n            logger.warn(\"Response was error\", response.error);\n            throw new ErrorResponse(response);\n        }\n    }\n\n    protected _processSigninState(response: SigninResponse, state: SigninState): void {\n        const logger = this._logger.create(\"_processSigninState\");\n        if (state.id !== response.state) {\n            logger.throw(new Error(\"State does not match\"));\n        }\n\n        if (!state.client_id) {\n            logger.throw(new Error(\"No client_id on state\"));\n        }\n\n        if (!state.authority) {\n            logger.throw(new Error(\"No authority on state\"));\n        }\n\n        // ensure we're using the correct authority\n        if (this._settings.authority !== state.authority) {\n            logger.throw(new Error(\"authority mismatch on settings vs. signin state\"));\n        }\n        if (this._settings.client_id && this._settings.client_id !== state.client_id) {\n            logger.throw(new Error(\"client_id mismatch on settings vs. signin state\"));\n        }\n\n        // now that we know the state matches, take the stored data\n        // and set it into the response so callers can get their state\n        // this is important for both success & error outcomes\n        logger.debug(\"state validated\");\n        response.userState = state.data;\n        // if there's no scope on the response, then assume all scopes granted (per-spec) and copy over scopes from original request\n        response.scope ??= state.scope;\n\n        if (response.error) {\n            logger.warn(\"Response was error\", response.error);\n            throw new ErrorResponse(response);\n        }\n\n        if (state.code_verifier && !response.code) {\n            logger.throw(new Error(\"Expected code in response\"));\n        }\n\n        if (!state.code_verifier && response.code) {\n            logger.throw(new Error(\"Unexpected code in response\"));\n        }\n    }\n\n    protected async _processClaims(response: SigninResponse, skipUserInfo = false, validateSub = true): Promise<void> {\n        const logger = this._logger.create(\"_processClaims\");\n        response.profile = this._filterProtocolClaims(response.profile);\n\n        if (skipUserInfo || !this._settings.loadUserInfo || !response.access_token) {\n            logger.debug(\"not loading user info\");\n            return;\n        }\n\n        logger.debug(\"loading user info\");\n        const claims = await this._userInfoService.getClaims(response.access_token);\n        logger.debug(\"user info claims received from user info endpoint\");\n\n        if (validateSub && claims.sub !== response.profile.sub) {\n            logger.throw(new Error(\"subject from UserInfo response does not match subject in ID Token\"));\n        }\n\n        response.profile = this._mergeClaims(response.profile, this._filterProtocolClaims(claims as IdTokenClaims));\n        logger.debug(\"user info claims received, updated profile:\", response.profile);\n    }\n\n    protected _mergeClaims(claims1: UserProfile, claims2: JwtClaims): UserProfile {\n        const result = { ...claims1 };\n\n        for (const [claim, values] of Object.entries(claims2)) {\n            for (const value of Array.isArray(values) ? values : [values]) {\n                const previousValue = result[claim];\n                if (!previousValue) {\n                    result[claim] = value;\n                }\n                else if (Array.isArray(previousValue)) {\n                    if (!previousValue.includes(value)) {\n                        previousValue.push(value);\n                    }\n                }\n                else if (result[claim] !== value) {\n                    if (typeof value === \"object\" && this._settings.mergeClaims) {\n                        result[claim] = this._mergeClaims(previousValue as UserProfile, value);\n                    }\n                    else {\n                        result[claim] = [previousValue, value];\n                    }\n                }\n            }\n        }\n\n        return result;\n    }\n\n    protected _filterProtocolClaims(claims: UserProfile): UserProfile {\n        const result = { ...claims };\n\n        if (this._settings.filterProtocolClaims) {\n            let protocolClaims;\n            if (Array.isArray(this._settings.filterProtocolClaims)) {\n                protocolClaims = this._settings.filterProtocolClaims;\n            } else {\n                protocolClaims = DefaultProtocolClaims;\n            }\n\n            for (const claim of protocolClaims) {\n                if (!InternalRequiredProtocolClaims.includes(claim)) {\n                    delete result[claim];\n                }\n            }\n        }\n\n        return result;\n    }\n\n    protected async _processCode(response: SigninResponse, state: SigninState): Promise<void> {\n        const logger = this._logger.create(\"_processCode\");\n        if (response.code) {\n            logger.debug(\"Validating code\");\n            const tokenResponse = await this._tokenClient.exchangeCode({\n                client_id: state.client_id,\n                client_secret: state.client_secret,\n                code: response.code,\n                redirect_uri: state.redirect_uri,\n                code_verifier: state.code_verifier,\n                ...state.extraTokenParams,\n            });\n            Object.assign(response, tokenResponse);\n        } else {\n            logger.debug(\"No code to process\");\n        }\n    }\n\n    protected _validateIdTokenAttributes(response: SigninResponse, currentToken?: string): void {\n        const logger = this._logger.create(\"_validateIdTokenAttributes\");\n\n        logger.debug(\"decoding ID Token JWT\");\n        const profile = JwtUtils.decode(response.id_token ?? \"\");\n\n        if (!profile.sub) {\n            logger.throw(new Error(\"ID Token is missing a subject claim\"));\n        }\n\n        if (currentToken) {\n            const current = JwtUtils.decode(currentToken);\n            if (current.sub !== profile.sub) {\n                logger.throw(new Error(\"sub in id_token does not match current sub\"));\n            }\n            if (current.auth_time && current.auth_time !== profile.auth_time) {\n                logger.throw(new Error(\"auth_time in id_token does not match original auth_time\"));\n            }\n            if (current.azp && current.azp !== profile.azp) {\n                logger.throw(new Error(\"azp in id_token does not match original azp\"));\n            }\n            if (!current.azp && profile.azp) {\n                logger.throw(new Error(\"azp not in id_token, but present in original id_token\"));\n            }\n        }\n\n        response.profile = profile as UserProfile;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, CryptoUtils, Timer } from \"./utils\";\nimport type { StateStore } from \"./StateStore\";\n\n/**\n * @public\n */\nexport class State {\n    public readonly id: string;\n    public readonly created: number;\n    public readonly request_type: string | undefined;\n\n    /** custom \"state\", which can be used by a caller to have \"data\" round tripped */\n    public readonly data: unknown | undefined;\n\n    public constructor(args: {\n        id?: string;\n        data?: unknown;\n        created?: number;\n        request_type?: string;\n    }) {\n        this.id = args.id || CryptoUtils.generateUUIDv4();\n        this.data = args.data;\n\n        if (args.created && args.created > 0) {\n            this.created = args.created;\n        }\n        else {\n            this.created = Timer.getEpochTime();\n        }\n        this.request_type = args.request_type;\n    }\n\n    public toStorageString(): string {\n        new Logger(\"State\").create(\"toStorageString\");\n        return JSON.stringify({\n            id: this.id,\n            data: this.data,\n            created: this.created,\n            request_type: this.request_type,\n        });\n    }\n\n    public static fromStorageString(storageString: string): State {\n        Logger.createStatic(\"State\", \"fromStorageString\");\n        return new State(JSON.parse(storageString));\n    }\n\n    public static async clearStaleState(storage: StateStore, age: number): Promise<void> {\n        const logger = Logger.createStatic(\"State\", \"clearStaleState\");\n        const cutoff = Timer.getEpochTime() - age;\n\n        const keys = await storage.getAllKeys();\n        logger.debug(\"got keys\", keys);\n\n        for (let i = 0; i < keys.length; i++) {\n            const key = keys[i];\n            const item = await storage.get(key);\n            let remove = false;\n\n            if (item) {\n                try {\n                    const state = State.fromStorageString(item);\n\n                    logger.debug(\"got item from key:\", key, state.created);\n                    if (state.created <= cutoff) {\n                        remove = true;\n                    }\n                }\n                catch (err) {\n                    logger.error(\"Error parsing state for key:\", key, err);\n                    remove = true;\n                }\n            }\n            else {\n                logger.debug(\"no item in storage for key:\", key);\n                remove = true;\n            }\n\n            if (remove) {\n                logger.debug(\"removed item for key:\", key);\n                void storage.remove(key);\n            }\n        }\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, CryptoUtils } from \"./utils\";\nimport { State } from \"./State\";\n\n/**\n * @public\n */\nexport class SigninState extends State {\n    // isCode\n    /** The same code_verifier that was used to obtain the authorization_code via PKCE. */\n    public readonly code_verifier: string | undefined;\n    /** Used to secure authorization code grants via Proof Key for Code Exchange (PKCE). */\n    public readonly code_challenge: string | undefined;\n\n    // to ensure state still matches settings\n    /** @see {@link OidcClientSettings.authority} */\n    public readonly authority: string;\n    /** @see {@link OidcClientSettings.client_id} */\n    public readonly client_id: string;\n    /** @see {@link OidcClientSettings.redirect_uri} */\n    public readonly redirect_uri: string;\n    /** @see {@link OidcClientSettings.scope} */\n    public readonly scope: string;\n    /** @see {@link OidcClientSettings.client_secret} */\n    public readonly client_secret: string | undefined;\n    /** @see {@link OidcClientSettings.extraTokenParams} */\n    public readonly extraTokenParams: Record<string, unknown> | undefined;\n    /** @see {@link OidcClientSettings.response_mode} */\n    public readonly response_mode: \"query\" | \"fragment\" | undefined;\n\n    public readonly skipUserInfo: boolean | undefined;\n\n    public constructor(args: {\n        id?: string;\n        data?: unknown;\n        created?: number;\n        request_type?: string;\n\n        code_verifier?: string | boolean;\n        authority: string;\n        client_id: string;\n        redirect_uri: string;\n        scope: string;\n        client_secret?: string;\n        extraTokenParams?: Record<string, unknown>;\n        response_mode?: \"query\" | \"fragment\";\n        skipUserInfo?: boolean;\n    }) {\n        super(args);\n\n        if (args.code_verifier === true) {\n            this.code_verifier = CryptoUtils.generateCodeVerifier();\n        }\n        else if (args.code_verifier) {\n            this.code_verifier = args.code_verifier;\n        }\n\n        if (this.code_verifier) {\n            this.code_challenge = CryptoUtils.generateCodeChallenge(this.code_verifier);\n        }\n\n        this.authority = args.authority;\n        this.client_id = args.client_id;\n        this.redirect_uri = args.redirect_uri;\n        this.scope = args.scope;\n        this.client_secret = args.client_secret;\n        this.extraTokenParams = args.extraTokenParams;\n\n        this.response_mode = args.response_mode;\n        this.skipUserInfo = args.skipUserInfo;\n    }\n\n    public toStorageString(): string {\n        new Logger(\"SigninState\").create(\"toStorageString\");\n        return JSON.stringify({\n            id: this.id,\n            data: this.data,\n            created: this.created,\n            request_type: this.request_type,\n\n            code_verifier: this.code_verifier,\n            authority: this.authority,\n            client_id: this.client_id,\n            redirect_uri: this.redirect_uri,\n            scope: this.scope,\n            client_secret: this.client_secret,\n            extraTokenParams : this.extraTokenParams,\n            response_mode: this.response_mode,\n            skipUserInfo: this.skipUserInfo,\n        });\n    }\n\n    public static fromStorageString(storageString: string): SigninState {\n        Logger.createStatic(\"SigninState\", \"fromStorageString\");\n        const data = JSON.parse(storageString);\n        return new SigninState(data);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\nimport { SigninState } from \"./SigninState\";\n\n/**\n * @public\n */\nexport interface SigninRequestArgs {\n    // mandatory\n    url: string;\n    authority: string;\n    client_id: string;\n    redirect_uri: string;\n    response_type: string;\n    scope: string;\n\n    // optional\n    prompt?: string;\n    display?: string;\n    max_age?: number;\n    ui_locales?: string;\n    id_token_hint?: string;\n    login_hint?: string;\n    acr_values?: string;\n    resource?: string | string[];\n    response_mode?: \"query\" | \"fragment\" ;\n    request?: string;\n    request_uri?: string;\n    extraQueryParams?: Record<string, string | number | boolean>;\n    request_type?: string;\n    client_secret?: string;\n    extraTokenParams?: Record<string, unknown>;\n    skipUserInfo?: boolean;\n    nonce?: string;\n\n    /** custom \"state\", which can be used by a caller to have \"data\" round tripped */\n    state_data?: unknown;\n}\n\n/**\n * @public\n */\nexport class SigninRequest {\n    private readonly _logger = new Logger(\"SigninRequest\");\n\n    public readonly url: string;\n    public readonly state: SigninState;\n\n    public constructor({\n        // mandatory\n        url, authority, client_id, redirect_uri, response_type, scope,\n        // optional\n        state_data, response_mode, request_type, client_secret, nonce,\n        resource,\n        skipUserInfo,\n        extraQueryParams,\n        extraTokenParams,\n        ...optionalParams\n    }: SigninRequestArgs) {\n        if (!url) {\n            this._logger.error(\"ctor: No url passed\");\n            throw new Error(\"url\");\n        }\n        if (!client_id) {\n            this._logger.error(\"ctor: No client_id passed\");\n            throw new Error(\"client_id\");\n        }\n        if (!redirect_uri) {\n            this._logger.error(\"ctor: No redirect_uri passed\");\n            throw new Error(\"redirect_uri\");\n        }\n        if (!response_type) {\n            this._logger.error(\"ctor: No response_type passed\");\n            throw new Error(\"response_type\");\n        }\n        if (!scope) {\n            this._logger.error(\"ctor: No scope passed\");\n            throw new Error(\"scope\");\n        }\n        if (!authority) {\n            this._logger.error(\"ctor: No authority passed\");\n            throw new Error(\"authority\");\n        }\n\n        this.state = new SigninState({\n            data: state_data,\n            request_type,\n            code_verifier: true,\n            client_id, authority, redirect_uri,\n            response_mode,\n            client_secret, scope, extraTokenParams,\n            skipUserInfo,\n        });\n\n        const parsedUrl = new URL(url);\n        parsedUrl.searchParams.append(\"client_id\", client_id);\n        parsedUrl.searchParams.append(\"redirect_uri\", redirect_uri);\n        parsedUrl.searchParams.append(\"response_type\", response_type);\n        parsedUrl.searchParams.append(\"scope\", scope);\n        if (nonce) {\n            parsedUrl.searchParams.append(\"nonce\", nonce);\n        }\n\n        parsedUrl.searchParams.append(\"state\", this.state.id);\n        if (this.state.code_challenge) {\n            parsedUrl.searchParams.append(\"code_challenge\", this.state.code_challenge);\n            parsedUrl.searchParams.append(\"code_challenge_method\", \"S256\");\n        }\n\n        if (resource) {\n            // https://datatracker.ietf.org/doc/html/rfc8707\n            const resources = Array.isArray(resource) ? resource : [resource];\n            resources\n                .forEach(r => parsedUrl.searchParams.append(\"resource\", r));\n        }\n\n        for (const [key, value] of Object.entries({ response_mode, ...optionalParams, ...extraQueryParams })) {\n            if (value != null) {\n                parsedUrl.searchParams.append(key, value.toString());\n            }\n        }\n\n        this.url = parsedUrl.href;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Timer } from \"./utils\";\nimport type { UserProfile } from \"./User\";\n\nconst OidcScope = \"openid\";\n\n/**\n * @public\n */\nexport class SigninResponse {\n    // props present in the initial callback response regardless of success\n    public readonly state: string | null;\n    /** @see {@link User.session_state} */\n    public session_state: string | null;\n\n    // error props\n    /** @see {@link ErrorResponse.error} */\n    public readonly error: string | null;\n    /** @see {@link ErrorResponse.error_description} */\n    public readonly error_description: string | null;\n    /** @see {@link ErrorResponse.error_uri} */\n    public readonly error_uri: string | null;\n\n    // success props\n    public readonly code: string | null;\n\n    // props set after validation\n    /** @see {@link User.id_token} */\n    public id_token?: string;\n    /** @see {@link User.access_token} */\n    public access_token = \"\";\n    /** @see {@link User.token_type} */\n    public token_type = \"\";\n    /** @see {@link User.refresh_token} */\n    public refresh_token?: string;\n    /** @see {@link User.scope} */\n    public scope?: string;\n    /** @see {@link User.expires_at} */\n    public expires_at?: number;\n\n    /** custom state data set during the initial signin request */\n    public userState: unknown;\n\n    /** @see {@link User.profile} */\n    public profile: UserProfile = {} as UserProfile;\n\n    public constructor(params: URLSearchParams) {\n        this.state = params.get(\"state\");\n        this.session_state = params.get(\"session_state\");\n\n        this.error = params.get(\"error\");\n        this.error_description = params.get(\"error_description\");\n        this.error_uri = params.get(\"error_uri\");\n\n        this.code = params.get(\"code\");\n    }\n\n    public get expires_in(): number | undefined {\n        if (this.expires_at === undefined) {\n            return undefined;\n        }\n        return this.expires_at - Timer.getEpochTime();\n    }\n    public set expires_in(value: number | undefined) {\n        // spec expects a number, but normalize here just in case\n        if (typeof value === \"string\") value = Number(value);\n        if (value !== undefined && value >= 0) {\n            this.expires_at = Math.floor(value) + Timer.getEpochTime();\n        }\n    }\n\n    public get isOpenId(): boolean {\n        return this.scope?.split(\" \").includes(OidcScope) || !!this.id_token;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\nimport { State } from \"./State\";\n\n/**\n * @public\n */\nexport interface SignoutRequestArgs {\n    // mandatory\n    url: string;\n\n    // optional\n    state_data?: unknown;\n    id_token_hint?: string;\n    post_logout_redirect_uri?: string;\n    extraQueryParams?: Record<string, string | number | boolean>;\n    request_type?: string;\n}\n\n/**\n * @public\n */\nexport class SignoutRequest {\n    private readonly _logger = new Logger(\"SignoutRequest\");\n\n    public readonly url: string;\n    public readonly state?: State;\n\n    public constructor({\n        url,\n        state_data, id_token_hint, post_logout_redirect_uri, extraQueryParams, request_type,\n    }: SignoutRequestArgs) {\n        if (!url) {\n            this._logger.error(\"ctor: No url passed\");\n            throw new Error(\"url\");\n        }\n\n        const parsedUrl = new URL(url);\n        if (id_token_hint) {\n            parsedUrl.searchParams.append(\"id_token_hint\", id_token_hint);\n        }\n\n        if (post_logout_redirect_uri) {\n            parsedUrl.searchParams.append(\"post_logout_redirect_uri\", post_logout_redirect_uri);\n\n            if (state_data) {\n                this.state = new State({ data: state_data, request_type });\n\n                parsedUrl.searchParams.append(\"state\", this.state.id);\n            }\n        }\n\n        for (const [key, value] of Object.entries({ ...extraQueryParams })) {\n            if (value != null) {\n                parsedUrl.searchParams.append(key, value.toString());\n            }\n        }\n\n        this.url = parsedUrl.href;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\n/**\n * @public\n */\nexport class SignoutResponse {\n    public readonly state: string | null;\n\n    // error props\n    /** @see {@link ErrorResponse.error} */\n    public error: string | null;\n    /** @see {@link ErrorResponse.error_description} */\n    public error_description: string | null;\n    /** @see {@link ErrorResponse.error_uri} */\n    public error_uri: string | null;\n\n    /** custom state data set during the initial signin request */\n    public userState: unknown;\n\n    public constructor(params: URLSearchParams) {\n        this.state = params.get(\"state\");\n\n        this.error = params.get(\"error\");\n        this.error_description = params.get(\"error_description\");\n        this.error_uri = params.get(\"error_uri\");\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, UrlUtils } from \"./utils\";\nimport { ErrorResponse } from \"./errors\";\nimport { OidcClientSettings, OidcClientSettingsStore } from \"./OidcClientSettings\";\nimport { ResponseValidator } from \"./ResponseValidator\";\nimport { MetadataService } from \"./MetadataService\";\nimport type { RefreshState } from \"./RefreshState\";\nimport { SigninRequest } from \"./SigninRequest\";\nimport { SigninResponse } from \"./SigninResponse\";\nimport { SignoutRequest, SignoutRequestArgs } from \"./SignoutRequest\";\nimport { SignoutResponse } from \"./SignoutResponse\";\nimport { SigninState } from \"./SigninState\";\nimport { State } from \"./State\";\nimport { TokenClient } from \"./TokenClient\";\n\n/**\n * @public\n */\nexport interface CreateSigninRequestArgs {\n    redirect_uri?: string;\n    response_type?: string;\n    scope?: string;\n    nonce?: string;\n\n    /** custom \"state\", which can be used by a caller to have \"data\" round tripped */\n    state?: unknown;\n\n    prompt?: string;\n    display?: string;\n    max_age?: number;\n    ui_locales?: string;\n    id_token_hint?: string;\n    login_hint?: string;\n    acr_values?: string;\n    resource?: string | string[];\n    response_mode?: \"query\" | \"fragment\";\n    request?: string;\n    request_uri?: string;\n    extraQueryParams?: Record<string, string | number | boolean>;\n    request_type?: string;\n    client_secret?: string;\n    extraTokenParams?: Record<string, unknown>;\n    skipUserInfo?: boolean;\n}\n\n/**\n * @public\n */\nexport interface UseRefreshTokenArgs {\n    state: RefreshState;\n    timeoutInSeconds?: number;\n}\n\n/**\n * @public\n */\nexport type CreateSignoutRequestArgs = Omit<SignoutRequestArgs, \"url\" | \"state_data\"> & { state?: unknown };\n\n/**\n * @public\n */\nexport type ProcessResourceOwnerPasswordCredentialsArgs = {\n    username: string;\n    password: string;\n    skipUserInfo?: boolean;\n    extraTokenParams?: Record<string, unknown>;\n};\n\n/**\n * Provides the raw OIDC/OAuth2 protocol support for the authorization endpoint and the end session endpoint in the\n * authorization server. It provides a bare-bones protocol implementation and is used by the UserManager class.\n * Only use this class if you simply want protocol support without the additional management features of the\n * UserManager class.\n *\n * @public\n */\nexport class OidcClient {\n    public readonly settings: OidcClientSettingsStore;\n    protected readonly _logger = new Logger(\"OidcClient\");\n\n    public readonly metadataService: MetadataService;\n    protected readonly _validator: ResponseValidator;\n    protected readonly _tokenClient: TokenClient;\n\n    public constructor(settings: OidcClientSettings) {\n        this.settings = new OidcClientSettingsStore(settings);\n\n        this.metadataService = new MetadataService(this.settings);\n        this._validator = new ResponseValidator(this.settings, this.metadataService);\n        this._tokenClient = new TokenClient(this.settings, this.metadataService);\n    }\n\n    public async createSigninRequest({\n        state,\n        request,\n        request_uri,\n        request_type,\n        id_token_hint,\n        login_hint,\n        skipUserInfo,\n        nonce,\n        response_type = this.settings.response_type,\n        scope = this.settings.scope,\n        redirect_uri = this.settings.redirect_uri,\n        prompt = this.settings.prompt,\n        display = this.settings.display,\n        max_age = this.settings.max_age,\n        ui_locales = this.settings.ui_locales,\n        acr_values = this.settings.acr_values,\n        resource = this.settings.resource,\n        response_mode = this.settings.response_mode,\n        extraQueryParams = this.settings.extraQueryParams,\n        extraTokenParams = this.settings.extraTokenParams,\n    }: CreateSigninRequestArgs): Promise<SigninRequest> {\n        const logger = this._logger.create(\"createSigninRequest\");\n\n        if (response_type !== \"code\") {\n            throw new Error(\"Only the Authorization Code flow (with PKCE) is supported\");\n        }\n\n        const url = await this.metadataService.getAuthorizationEndpoint();\n        logger.debug(\"Received authorization endpoint\", url);\n\n        const signinRequest = new SigninRequest({\n            url,\n            authority: this.settings.authority,\n            client_id: this.settings.client_id,\n            redirect_uri,\n            response_type,\n            scope,\n            state_data: state,\n            prompt, display, max_age, ui_locales, id_token_hint, login_hint, acr_values,\n            resource, request, request_uri, extraQueryParams, extraTokenParams, request_type, response_mode,\n            client_secret: this.settings.client_secret,\n            skipUserInfo,\n            nonce,\n        });\n\n        // house cleaning\n        await this.clearStaleState();\n\n        const signinState = signinRequest.state;\n        await this.settings.stateStore.set(signinState.id, signinState.toStorageString());\n        return signinRequest;\n    }\n\n    public async readSigninResponseState(url: string, removeState = false): Promise<{ state: SigninState; response: SigninResponse }> {\n        const logger = this._logger.create(\"readSigninResponseState\");\n\n        const response = new SigninResponse(UrlUtils.readParams(url, this.settings.response_mode));\n        if (!response.state) {\n            logger.throw(new Error(\"No state in response\"));\n            // need to throw within this function's body for type narrowing to work\n            throw null; // https://github.com/microsoft/TypeScript/issues/46972\n        }\n\n        const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n        if (!storedStateString) {\n            logger.throw(new Error(\"No matching state found in storage\"));\n            throw null; // https://github.com/microsoft/TypeScript/issues/46972\n        }\n\n        const state = SigninState.fromStorageString(storedStateString);\n        return { state, response };\n    }\n\n    public async processSigninResponse(url: string): Promise<SigninResponse> {\n        const logger = this._logger.create(\"processSigninResponse\");\n\n        const { state, response } = await this.readSigninResponseState(url, true);\n        logger.debug(\"received state from storage; validating response\");\n        await this._validator.validateSigninResponse(response, state);\n        return response;\n    }\n\n    public async processResourceOwnerPasswordCredentials({\n        username,\n        password,\n        skipUserInfo = false,\n        extraTokenParams = {},\n    }: ProcessResourceOwnerPasswordCredentialsArgs): Promise<SigninResponse> {\n        const tokenResponse: Record<string, unknown> = await this._tokenClient.exchangeCredentials({ username, password, ...extraTokenParams });\n        const signinResponse: SigninResponse = new SigninResponse(new URLSearchParams());\n        Object.assign(signinResponse, tokenResponse);\n        await this._validator.validateCredentialsResponse(signinResponse, skipUserInfo);\n        return signinResponse;\n    }\n\n    public async useRefreshToken({\n        state,\n        timeoutInSeconds,\n    }: UseRefreshTokenArgs): Promise<SigninResponse> {\n        const logger = this._logger.create(\"useRefreshToken\");\n\n        // https://github.com/authts/oidc-client-ts/issues/695\n        // In some cases (e.g. AzureAD), not all granted scopes are allowed on token refresh requests.\n        // Therefore, we filter all granted scopes by a list of allowable scopes.\n        let scope;\n        if (this.settings.refreshTokenAllowedScope === undefined) {\n            scope = state.scope;\n        } else {\n            const allowableScopes = this.settings.refreshTokenAllowedScope.split(\" \");\n            const providedScopes = state.scope?.split(\" \") || [];\n\n            scope = providedScopes.filter(s => allowableScopes.includes(s)).join(\" \");\n        }\n\n        const result = await this._tokenClient.exchangeRefreshToken({\n            refresh_token: state.refresh_token,\n            // provide the (possible filtered) scope list\n            scope,\n            timeoutInSeconds,\n        });\n        const response = new SigninResponse(new URLSearchParams());\n        Object.assign(response, result);\n        logger.debug(\"validating response\", response);\n        await this._validator.validateRefreshResponse(response, {\n            ...state,\n            // overide the scope in the state handed over to the validator\n            // so it can set the granted scope to the requested scope in case none is included in the response\n            scope,\n        });\n        return response;\n    }\n\n    public async createSignoutRequest({\n        state,\n        id_token_hint,\n        request_type,\n        post_logout_redirect_uri = this.settings.post_logout_redirect_uri,\n        extraQueryParams = this.settings.extraQueryParams,\n    }: CreateSignoutRequestArgs = {}): Promise<SignoutRequest> {\n        const logger = this._logger.create(\"createSignoutRequest\");\n\n        const url = await this.metadataService.getEndSessionEndpoint();\n        if (!url) {\n            logger.throw(new Error(\"No end session endpoint\"));\n            throw null; // https://github.com/microsoft/TypeScript/issues/46972\n        }\n\n        logger.debug(\"Received end session endpoint\", url);\n\n        const request = new SignoutRequest({\n            url,\n            id_token_hint,\n            post_logout_redirect_uri,\n            state_data: state,\n            extraQueryParams,\n            request_type,\n        });\n\n        // house cleaning\n        await this.clearStaleState();\n\n        const signoutState = request.state;\n        if (signoutState) {\n            logger.debug(\"Signout request has state to persist\");\n            await this.settings.stateStore.set(signoutState.id, signoutState.toStorageString());\n        }\n\n        return request;\n    }\n\n    public async readSignoutResponseState(url: string, removeState = false): Promise<{ state: State | undefined; response: SignoutResponse }> {\n        const logger = this._logger.create(\"readSignoutResponseState\");\n\n        const response = new SignoutResponse(UrlUtils.readParams(url, this.settings.response_mode));\n        if (!response.state) {\n            logger.debug(\"No state in response\");\n\n            if (response.error) {\n                logger.warn(\"Response was error:\", response.error);\n                throw new ErrorResponse(response);\n            }\n\n            return { state: undefined, response };\n        }\n\n        const storedStateString = await this.settings.stateStore[removeState ? \"remove\" : \"get\"](response.state);\n        if (!storedStateString) {\n            logger.throw(new Error(\"No matching state found in storage\"));\n            throw null; // https://github.com/microsoft/TypeScript/issues/46972\n        }\n\n        const state = State.fromStorageString(storedStateString);\n        return { state, response };\n    }\n\n    public async processSignoutResponse(url: string): Promise<SignoutResponse> {\n        const logger = this._logger.create(\"processSignoutResponse\");\n\n        const { state, response } = await this.readSignoutResponseState(url, true);\n        if (state) {\n            logger.debug(\"Received state from storage; validating response\");\n            this._validator.validateSignoutResponse(response, state);\n        } else {\n            logger.debug(\"No state from storage; skipping response validation\");\n        }\n\n        return response;\n    }\n\n    public clearStaleState(): Promise<void> {\n        this._logger.create(\"clearStaleState\");\n        return State.clearStaleState(this.settings.stateStore, this.settings.staleStateAgeInSeconds);\n    }\n\n    public async revokeToken(token: string, type?: \"access_token\" | \"refresh_token\"): Promise<void> {\n        this._logger.create(\"revokeToken\");\n        return await this._tokenClient.revoke({\n            token,\n            token_type_hint: type,\n        });\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\nimport { CheckSessionIFrame } from \"./CheckSessionIFrame\";\nimport type { UserManager } from \"./UserManager\";\nimport type { User } from \"./User\";\n\n/**\n * @public\n */\nexport class SessionMonitor {\n    private readonly _logger = new Logger(\"SessionMonitor\");\n\n    private _sub: string | undefined;\n    private _sid: string | undefined;\n    private _checkSessionIFrame?: CheckSessionIFrame;\n\n    public constructor(private readonly _userManager: UserManager) {\n        if (!_userManager) {\n            this._logger.throw(new Error(\"No user manager passed\"));\n        }\n\n        this._userManager.events.addUserLoaded(this._start);\n        this._userManager.events.addUserUnloaded(this._stop);\n\n        this._init().catch((err: unknown) => {\n            // catch to suppress errors since we're in a ctor\n            this._logger.error(err);\n        });\n    }\n\n    protected async _init(): Promise<void> {\n        this._logger.create(\"_init\");\n        const user = await this._userManager.getUser();\n        // doing this manually here since calling getUser\n        // doesn't trigger load event.\n        if (user) {\n            void this._start(user);\n        }\n        else if (this._userManager.settings.monitorAnonymousSession) {\n            const session = await this._userManager.querySessionStatus();\n            if (session) {\n                const tmpUser = {\n                    session_state: session.session_state,\n                    profile: session.sub && session.sid ? {\n                        sub: session.sub,\n                        sid: session.sid,\n                    } : null,\n                };\n                void this._start(tmpUser);\n            }\n        }\n    }\n\n    protected _start = async (\n        user: User | {\n            session_state: string;\n            profile: { sub: string; sid: string } | null;\n        },\n    ): Promise<void> => {\n        const session_state = user.session_state;\n        if (!session_state) {\n            return;\n        }\n        const logger = this._logger.create(\"_start\");\n\n        if (user.profile) {\n            this._sub = user.profile.sub;\n            this._sid = user.profile.sid;\n            logger.debug(\"session_state\", session_state, \", sub\", this._sub);\n        }\n        else {\n            this._sub = undefined;\n            this._sid = undefined;\n            logger.debug(\"session_state\", session_state, \", anonymous user\");\n        }\n\n        if (this._checkSessionIFrame) {\n            this._checkSessionIFrame.start(session_state);\n            return;\n        }\n\n        try {\n            const url = await this._userManager.metadataService.getCheckSessionIframe();\n            if (url) {\n                logger.debug(\"initializing check session iframe\");\n\n                const client_id = this._userManager.settings.client_id;\n                const intervalInSeconds = this._userManager.settings.checkSessionIntervalInSeconds;\n                const stopOnError = this._userManager.settings.stopCheckSessionOnError;\n\n                const checkSessionIFrame = new CheckSessionIFrame(this._callback, client_id, url, intervalInSeconds, stopOnError);\n                await checkSessionIFrame.load();\n                this._checkSessionIFrame = checkSessionIFrame;\n                checkSessionIFrame.start(session_state);\n            }\n            else {\n                logger.warn(\"no check session iframe found in the metadata\");\n            }\n        }\n        catch (err) {\n            // catch to suppress errors since we're in non-promise callback\n            logger.error(\"Error from getCheckSessionIframe:\", err instanceof Error ? err.message : err);\n        }\n    };\n\n    protected _stop = (): void => {\n        const logger = this._logger.create(\"_stop\");\n        this._sub = undefined;\n        this._sid = undefined;\n\n        if (this._checkSessionIFrame) {\n            this._checkSessionIFrame.stop();\n        }\n\n        if (this._userManager.settings.monitorAnonymousSession) {\n            // using a timer to delay re-initialization to avoid race conditions during signout\n            // TODO rewrite to use promise correctly\n            // eslint-disable-next-line @typescript-eslint/no-misused-promises\n            const timerHandle = setInterval(async () => {\n                clearInterval(timerHandle);\n\n                try {\n                    const session = await this._userManager.querySessionStatus();\n                    if (session) {\n                        const tmpUser = {\n                            session_state: session.session_state,\n                            profile: session.sub && session.sid ? {\n                                sub: session.sub,\n                                sid: session.sid,\n                            } : null,\n                        };\n                        void this._start(tmpUser);\n                    }\n                }\n                catch (err) {\n                    // catch to suppress errors since we're in a callback\n                    logger.error(\"error from querySessionStatus\", err instanceof Error ? err.message : err);\n                }\n            }, 1000);\n        }\n    };\n\n    protected _callback = async (): Promise<void> => {\n        const logger = this._logger.create(\"_callback\");\n        try {\n            const session = await this._userManager.querySessionStatus();\n            let raiseEvent = true;\n\n            if (session && this._checkSessionIFrame) {\n                if (session.sub === this._sub) {\n                    raiseEvent = false;\n                    this._checkSessionIFrame.start(session.session_state);\n\n                    if (session.sid === this._sid) {\n                        logger.debug(\"same sub still logged in at OP, restarting check session iframe; session_state\", session.session_state);\n                    }\n                    else {\n                        logger.debug(\"same sub still logged in at OP, session state has changed, restarting check session iframe; session_state\", session.session_state);\n                        this._userManager.events._raiseUserSessionChanged();\n                    }\n                }\n                else {\n                    logger.debug(\"different subject signed into OP\", session.sub);\n                }\n            }\n            else {\n                logger.debug(\"subject no longer signed into OP\");\n            }\n\n            if (raiseEvent) {\n                if (this._sub) {\n                    this._userManager.events._raiseUserSignedOut();\n                }\n                else {\n                    this._userManager.events._raiseUserSignedIn();\n                }\n            } else {\n                logger.debug(\"no change in session detected, no event to raise\");\n            }\n        }\n        catch (err) {\n            if (this._sub) {\n                logger.debug(\"Error calling queryCurrentSigninSession; raising signed out event\", err);\n                this._userManager.events._raiseUserSignedOut();\n            }\n        }\n    };\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, Timer } from \"./utils\";\nimport type { IdTokenClaims } from \"./Claims\";\n\n/**\n * Holds claims represented by a combination of the `id_token` and the user info endpoint.\n * @public\n */\nexport type UserProfile = IdTokenClaims;\n\n/**\n * @public\n */\nexport class User {\n    /**\n     * A JSON Web Token (JWT). Only provided if `openid` scope was requested.\n     * The application can access the data decoded by using the `profile` property.\n     */\n    public id_token?: string;\n\n    /** The session state value returned from the OIDC provider. */\n    public session_state: string | null;\n\n    /**\n     * The requested access token returned from the OIDC provider. The application can use this token to\n     * authenticate itself to the secured resource.\n     */\n    public access_token: string;\n\n    /**\n     * An OAuth 2.0 refresh token. The app can use this token to acquire additional access tokens after the\n     * current access token expires. Refresh tokens are long-lived and can be used to maintain access to resources\n     * for extended periods of time.\n     */\n    public refresh_token?: string;\n\n    /** Typically \"Bearer\" */\n    public token_type: string;\n\n    /** The scopes that the requested access token is valid for. */\n    public scope?: string;\n\n    /** The claims represented by a combination of the `id_token` and the user info endpoint. */\n    public profile: UserProfile;\n\n    /** The expires at returned from the OIDC provider. */\n    public expires_at?: number;\n\n    /** custom state data set during the initial signin request */\n    public readonly state: unknown;\n\n    public constructor(args: {\n        id_token?: string;\n        session_state?: string | null;\n        access_token: string;\n        refresh_token?: string;\n        token_type: string;\n        scope?: string;\n        profile: UserProfile;\n        expires_at?: number;\n        userState?: unknown;\n    }) {\n        this.id_token = args.id_token;\n        this.session_state = args.session_state ?? null;\n        this.access_token = args.access_token;\n        this.refresh_token = args.refresh_token;\n\n        this.token_type = args.token_type;\n        this.scope = args.scope;\n        this.profile = args.profile;\n        this.expires_at = args.expires_at;\n        this.state = args.userState;\n    }\n\n    /** Computed number of seconds the access token has remaining. */\n    public get expires_in(): number | undefined {\n        if (this.expires_at === undefined) {\n            return undefined;\n        }\n        return this.expires_at - Timer.getEpochTime();\n    }\n\n    public set expires_in(value: number | undefined) {\n        if (value !== undefined) {\n            this.expires_at = Math.floor(value) + Timer.getEpochTime();\n        }\n    }\n\n    /** Computed value indicating if the access token is expired. */\n    public get expired(): boolean | undefined {\n        const expires_in = this.expires_in;\n        if (expires_in === undefined) {\n            return undefined;\n        }\n        return expires_in <= 0;\n    }\n\n    /** Array representing the parsed values from the `scope`. */\n    public get scopes(): string[] {\n        return this.scope?.split(\" \") ?? [];\n    }\n\n    public toStorageString(): string {\n        new Logger(\"User\").create(\"toStorageString\");\n        return JSON.stringify({\n            id_token: this.id_token,\n            session_state: this.session_state,\n            access_token: this.access_token,\n            refresh_token: this.refresh_token,\n            token_type: this.token_type,\n            scope: this.scope,\n            profile: this.profile,\n            expires_at: this.expires_at,\n        });\n    }\n\n    public static fromStorageString(storageString: string): User {\n        Logger.createStatic(\"User\", \"fromStorageString\");\n        return new User(JSON.parse(storageString));\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Event, Logger, UrlUtils } from \"../utils\";\nimport type { IWindow, NavigateParams, NavigateResponse } from \"./IWindow\";\n\nconst messageSource = \"oidc-client\";\n\ninterface MessageData {\n    source: string;\n    url: string;\n    keepOpen: boolean;\n}\n\n/**\n * Window implementation which resolves via communication from a child window\n * via the `Window.postMessage()` interface.\n *\n * @internal\n */\nexport abstract class AbstractChildWindow implements IWindow {\n    protected abstract readonly _logger: Logger;\n    protected readonly _abort = new Event<[reason: Error]>(\"Window navigation aborted\");\n    protected readonly _disposeHandlers = new Set<() => void>();\n\n    protected _window: WindowProxy | null = null;\n\n    public async navigate(params: NavigateParams): Promise<NavigateResponse> {\n        const logger = this._logger.create(\"navigate\");\n        if (!this._window) {\n            throw new Error(\"Attempted to navigate on a disposed window\");\n        }\n\n        logger.debug(\"setting URL in window\");\n        this._window.location.replace(params.url);\n\n        const { url, keepOpen } = await new Promise<MessageData>((resolve, reject) => {\n            const listener = (e: MessageEvent) => {\n                const data: MessageData | undefined = e.data;\n                const origin = params.scriptOrigin ?? window.location.origin;\n                if (e.origin !== origin || data?.source !== messageSource) {\n                    // silently discard events not intended for us\n                    return;\n                }\n                try {\n                    const state = UrlUtils.readParams(data.url, params.response_mode).get(\"state\");\n                    if (!state) {\n                        logger.warn(\"no state found in response url\");\n                    }\n                    if (e.source !== this._window && state !== params.state) {\n                        // MessageEvent source is a relatively modern feature, we can't rely on it\n                        // so we also inspect the payload for a matching state key as an alternative\n                        return;\n                    }\n                }\n                catch (err) {\n                    this._dispose();\n                    reject(new Error(\"Invalid response from window\"));\n                }\n                resolve(data);\n            };\n            window.addEventListener(\"message\", listener, false);\n            this._disposeHandlers.add(() => window.removeEventListener(\"message\", listener, false));\n            this._disposeHandlers.add(this._abort.addHandler((reason) => {\n                this._dispose();\n                reject(reason);\n            }));\n        });\n        logger.debug(\"got response from window\");\n        this._dispose();\n\n        if (!keepOpen) {\n            this.close();\n        }\n\n        return { url };\n    }\n\n    public abstract close(): void;\n\n    private _dispose(): void {\n        this._logger.create(\"_dispose\");\n\n        for (const dispose of this._disposeHandlers) {\n            dispose();\n        }\n        this._disposeHandlers.clear();\n    }\n\n    protected static _notifyParent(parent: Window, url: string, keepOpen = false, targetOrigin = window.location.origin): void {\n        parent.postMessage({\n            source: messageSource,\n            url,\n            keepOpen,\n        } as MessageData, targetOrigin);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { OidcClientSettings, OidcClientSettingsStore } from \"./OidcClientSettings\";\nimport type { PopupWindowFeatures } from \"./utils/PopupUtils\";\nimport { WebStorageStateStore } from \"./WebStorageStateStore\";\nimport { InMemoryWebStorage } from \"./InMemoryWebStorage\";\n\nexport const DefaultPopupWindowFeatures: PopupWindowFeatures = {\n    location: false,\n    toolbar: false,\n    height: 640,\n};\nexport const DefaultPopupTarget = \"_blank\";\nconst DefaultAccessTokenExpiringNotificationTimeInSeconds = 60;\nconst DefaultCheckSessionIntervalInSeconds = 2;\nexport const DefaultSilentRequestTimeoutInSeconds = 10;\n\n/**\n * The settings used to configure the {@link UserManager}.\n *\n * @public\n */\nexport interface UserManagerSettings extends OidcClientSettings {\n    /** The URL for the page containing the call to signinPopupCallback to handle the callback from the OIDC/OAuth2 */\n    popup_redirect_uri?: string;\n    popup_post_logout_redirect_uri?: string;\n    /**\n     * The features parameter to window.open for the popup signin window. By default, the popup is\n     * placed centered in front of the window opener.\n     * (default: \\{ location: false, menubar: false, height: 640 \\})\n     */\n    popupWindowFeatures?: PopupWindowFeatures;\n    /** The target parameter to window.open for the popup signin window (default: \"_blank\") */\n    popupWindowTarget?: string;\n    /** The methods window.location method used to redirect (default: \"assign\") */\n    redirectMethod?: \"replace\" | \"assign\";\n    /** The methods target window being redirected (default: \"self\") */\n    redirectTarget?: \"top\" | \"self\";\n\n    /** The target to pass while calling postMessage inside iframe for callback (default: window.location.origin) */\n    iframeNotifyParentOrigin?: string;\n\n    /** The script origin to check during 'message' callback execution while performing silent auth via iframe (default: window.location.origin) */\n    iframeScriptOrigin?: string;\n\n    /** The URL for the page containing the code handling the silent renew */\n    silent_redirect_uri?: string;\n    /** Number of seconds to wait for the silent renew to return before assuming it has failed or timed out (default: 10) */\n    silentRequestTimeoutInSeconds?: number;\n    /** Flag to indicate if there should be an automatic attempt to renew the access token prior to its expiration (default: true) */\n    automaticSilentRenew?: boolean;\n    /** Flag to validate user.profile.sub in silent renew calls (default: true) */\n    validateSubOnSilentRenew?: boolean;\n    /** Flag to control if id_token is included as id_token_hint in silent renew calls (default: false) */\n    includeIdTokenInSilentRenew?: boolean;\n\n    /** Will raise events for when user has performed a signout at the OP (default: false) */\n    monitorSession?: boolean;\n    monitorAnonymousSession?: boolean;\n    /** Interval in seconds to check the user's session (default: 2) */\n    checkSessionIntervalInSeconds?: number;\n    query_status_response_type?: string;\n    stopCheckSessionOnError?: boolean;\n\n    /**\n     * The `token_type_hint`s to pass to the authority server by default (default: [\"access_token\", \"refresh_token\"])\n     *\n     * Token types will be revoked in the same order as they are given here.\n     */\n    revokeTokenTypes?: (\"access_token\" | \"refresh_token\")[];\n    /** Will invoke the revocation endpoint on signout if there is an access token for the user (default: false) */\n    revokeTokensOnSignout?: boolean;\n    /** Flag to control if id_token is included as id_token_hint in silent signout calls (default: false) */\n    includeIdTokenInSilentSignout?: boolean;\n\n    /** The number of seconds before an access token is to expire to raise the accessTokenExpiring event (default: 60) */\n    accessTokenExpiringNotificationTimeInSeconds?: number;\n\n    /**\n     * Storage object used to persist User for currently authenticated user (default: window.sessionStorage, InMemoryWebStorage iff no window).\n     *  E.g. `userStore: new WebStorageStateStore({ store: window.localStorage })`\n     */\n    userStore?: WebStorageStateStore;\n}\n\n/**\n * The settings with defaults applied of the {@link UserManager}.\n * @see {@link UserManagerSettings}\n *\n * @public\n */\nexport class UserManagerSettingsStore extends OidcClientSettingsStore {\n    public readonly popup_redirect_uri: string;\n    public readonly popup_post_logout_redirect_uri: string | undefined;\n    public readonly popupWindowFeatures: PopupWindowFeatures;\n    public readonly popupWindowTarget: string;\n    public readonly redirectMethod: \"replace\" | \"assign\";\n    public readonly redirectTarget: \"top\" | \"self\";\n\n    public readonly iframeNotifyParentOrigin: string | undefined;\n    public readonly iframeScriptOrigin: string | undefined;\n\n    public readonly silent_redirect_uri: string;\n    public readonly silentRequestTimeoutInSeconds: number;\n    public readonly automaticSilentRenew: boolean;\n    public readonly validateSubOnSilentRenew: boolean;\n    public readonly includeIdTokenInSilentRenew: boolean;\n\n    public readonly monitorSession: boolean;\n    public readonly monitorAnonymousSession: boolean;\n    public readonly checkSessionIntervalInSeconds: number;\n    public readonly query_status_response_type: string;\n    public readonly stopCheckSessionOnError: boolean;\n\n    public readonly revokeTokenTypes: (\"access_token\" | \"refresh_token\")[];\n    public readonly revokeTokensOnSignout: boolean;\n    public readonly includeIdTokenInSilentSignout: boolean;\n\n    public readonly accessTokenExpiringNotificationTimeInSeconds: number;\n\n    public readonly userStore: WebStorageStateStore;\n\n    public constructor(args: UserManagerSettings) {\n        const {\n            popup_redirect_uri = args.redirect_uri,\n            popup_post_logout_redirect_uri = args.post_logout_redirect_uri,\n            popupWindowFeatures = DefaultPopupWindowFeatures,\n            popupWindowTarget = DefaultPopupTarget,\n            redirectMethod = \"assign\",\n            redirectTarget = \"self\",\n\n            iframeNotifyParentOrigin = args.iframeNotifyParentOrigin,\n            iframeScriptOrigin = args.iframeScriptOrigin,\n\n            silent_redirect_uri = args.redirect_uri,\n            silentRequestTimeoutInSeconds = DefaultSilentRequestTimeoutInSeconds,\n            automaticSilentRenew = true,\n            validateSubOnSilentRenew = true,\n            includeIdTokenInSilentRenew = false,\n\n            monitorSession = false,\n            monitorAnonymousSession = false,\n            checkSessionIntervalInSeconds = DefaultCheckSessionIntervalInSeconds,\n            query_status_response_type = \"code\",\n            stopCheckSessionOnError = true,\n\n            revokeTokenTypes = [\"access_token\", \"refresh_token\"],\n            revokeTokensOnSignout = false,\n            includeIdTokenInSilentSignout = false,\n\n            accessTokenExpiringNotificationTimeInSeconds = DefaultAccessTokenExpiringNotificationTimeInSeconds,\n\n            userStore,\n        } = args;\n\n        super(args);\n\n        this.popup_redirect_uri = popup_redirect_uri;\n        this.popup_post_logout_redirect_uri = popup_post_logout_redirect_uri;\n        this.popupWindowFeatures = popupWindowFeatures;\n        this.popupWindowTarget = popupWindowTarget;\n        this.redirectMethod = redirectMethod;\n        this.redirectTarget = redirectTarget;\n\n        this.iframeNotifyParentOrigin = iframeNotifyParentOrigin;\n        this.iframeScriptOrigin = iframeScriptOrigin;\n\n        this.silent_redirect_uri = silent_redirect_uri;\n        this.silentRequestTimeoutInSeconds = silentRequestTimeoutInSeconds;\n        this.automaticSilentRenew = automaticSilentRenew;\n        this.validateSubOnSilentRenew = validateSubOnSilentRenew;\n        this.includeIdTokenInSilentRenew = includeIdTokenInSilentRenew;\n\n        this.monitorSession = monitorSession;\n        this.monitorAnonymousSession = monitorAnonymousSession;\n        this.checkSessionIntervalInSeconds = checkSessionIntervalInSeconds;\n        this.stopCheckSessionOnError = stopCheckSessionOnError;\n        this.query_status_response_type = query_status_response_type;\n\n        this.revokeTokenTypes = revokeTokenTypes;\n        this.revokeTokensOnSignout = revokeTokensOnSignout;\n        this.includeIdTokenInSilentSignout = includeIdTokenInSilentSignout;\n\n        this.accessTokenExpiringNotificationTimeInSeconds = accessTokenExpiringNotificationTimeInSeconds;\n\n        if (userStore) {\n            this.userStore = userStore;\n        }\n        else {\n            const store = typeof window !== \"undefined\" ? window.sessionStorage : new InMemoryWebStorage();\n            this.userStore = new WebStorageStateStore({ store });\n        }\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"../utils\";\nimport { ErrorTimeout } from \"../errors\";\nimport type { NavigateParams, NavigateResponse } from \"./IWindow\";\nimport { AbstractChildWindow } from \"./AbstractChildWindow\";\nimport { DefaultSilentRequestTimeoutInSeconds } from \"../UserManagerSettings\";\n\n/**\n * @public\n */\nexport interface IFrameWindowParams {\n    silentRequestTimeoutInSeconds?: number;\n}\n\n/**\n * @internal\n */\nexport class IFrameWindow extends AbstractChildWindow {\n    protected readonly _logger = new Logger(\"IFrameWindow\");\n    private _frame: HTMLIFrameElement | null;\n    private _timeoutInSeconds: number;\n\n    public constructor({\n        silentRequestTimeoutInSeconds = DefaultSilentRequestTimeoutInSeconds,\n    }: IFrameWindowParams) {\n        super();\n        this._timeoutInSeconds = silentRequestTimeoutInSeconds;\n\n        this._frame = IFrameWindow.createHiddenIframe();\n        this._window = this._frame.contentWindow;\n    }\n\n    private static createHiddenIframe(): HTMLIFrameElement {\n        const iframe = window.document.createElement(\"iframe\");\n\n        // shotgun approach\n        iframe.style.visibility = \"hidden\";\n        iframe.style.position = \"fixed\";\n        iframe.style.left = \"-1000px\";\n        iframe.style.top = \"0\";\n        iframe.width = \"0\";\n        iframe.height = \"0\";\n        iframe.setAttribute(\"sandbox\", \"allow-scripts allow-same-origin allow-forms\");\n\n        window.document.body.appendChild(iframe);\n        return iframe;\n    }\n\n    public async navigate(params: NavigateParams): Promise<NavigateResponse> {\n        this._logger.debug(\"navigate: Using timeout of:\", this._timeoutInSeconds);\n        const timer = setTimeout(() => this._abort.raise(new ErrorTimeout(\"IFrame timed out without a response\")), this._timeoutInSeconds * 1000);\n        this._disposeHandlers.add(() => clearTimeout(timer));\n\n        return await super.navigate(params);\n    }\n\n    public close(): void {\n        if (this._frame) {\n            if (this._frame.parentNode) {\n                this._frame.addEventListener(\"load\", (ev) => {\n                    const frame = ev.target as HTMLIFrameElement;\n                    frame.parentNode?.removeChild(frame);\n                    this._abort.raise(new Error(\"IFrame removed from DOM\"));\n                }, true);\n                this._frame.contentWindow?.location.replace(\"about:blank\");\n            }\n            this._frame = null;\n        }\n        this._window = null;\n    }\n\n    public static notifyParent(url: string, targetOrigin?: string): void {\n        return super._notifyParent(window.parent, url, false, targetOrigin);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"../utils\";\nimport type { UserManagerSettingsStore } from \"../UserManagerSettings\";\nimport { IFrameWindow, IFrameWindowParams } from \"./IFrameWindow\";\nimport type { INavigator } from \"./INavigator\";\n\n/**\n * @internal\n */\nexport class IFrameNavigator implements INavigator {\n    private readonly _logger = new Logger(\"IFrameNavigator\");\n\n    constructor(private _settings: UserManagerSettingsStore) {}\n\n    public async prepare({\n        silentRequestTimeoutInSeconds = this._settings.silentRequestTimeoutInSeconds,\n    }: IFrameWindowParams): Promise<IFrameWindow> {\n        return new IFrameWindow({ silentRequestTimeoutInSeconds });\n    }\n\n    public async callback(url: string): Promise<void> {\n        this._logger.create(\"callback\");\n        IFrameWindow.notifyParent(url, this._settings.iframeNotifyParentOrigin);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, PopupUtils, PopupWindowFeatures } from \"../utils\";\nimport { DefaultPopupWindowFeatures, DefaultPopupTarget } from \"../UserManagerSettings\";\nimport { AbstractChildWindow } from \"./AbstractChildWindow\";\nimport type { NavigateParams, NavigateResponse } from \"./IWindow\";\n\nconst checkForPopupClosedInterval = 500;\n\n/**\n * @public\n */\nexport interface PopupWindowParams {\n    popupWindowFeatures?: PopupWindowFeatures;\n    popupWindowTarget?: string;\n}\n\n/**\n * @internal\n */\nexport class PopupWindow extends AbstractChildWindow {\n    protected readonly _logger = new Logger(\"PopupWindow\");\n\n    protected _window: WindowProxy | null;\n\n    public constructor({\n        popupWindowTarget = DefaultPopupTarget,\n        popupWindowFeatures = {},\n    }: PopupWindowParams) {\n        super();\n        const centeredPopup = PopupUtils.center({ ...DefaultPopupWindowFeatures, ...popupWindowFeatures });\n        this._window = window.open(undefined, popupWindowTarget, PopupUtils.serialize(centeredPopup));\n    }\n\n    public async navigate(params: NavigateParams): Promise<NavigateResponse> {\n        this._window?.focus();\n\n        const popupClosedInterval = setInterval(() => {\n            if (!this._window || this._window.closed) {\n                this._abort.raise(new Error(\"Popup closed by user\"));\n            }\n        }, checkForPopupClosedInterval);\n        this._disposeHandlers.add(() => clearInterval(popupClosedInterval));\n\n        return await super.navigate(params);\n    }\n\n    public close(): void {\n        if (this._window) {\n            if (!this._window.closed) {\n                this._window.close();\n                this._abort.raise(new Error(\"Popup closed\"));\n            }\n        }\n        this._window = null;\n    }\n\n    public static notifyOpener(url: string, keepOpen: boolean): void {\n        if (!window.opener) {\n            throw new Error(\"No window.opener. Can't complete notification.\");\n        }\n        return super._notifyParent(window.opener, url, keepOpen);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"../utils\";\nimport { PopupWindow, PopupWindowParams } from \"./PopupWindow\";\nimport type { INavigator } from \"./INavigator\";\nimport type { UserManagerSettingsStore } from \"../UserManagerSettings\";\n\n/**\n * @internal\n */\nexport class PopupNavigator implements INavigator {\n    private readonly _logger = new Logger(\"PopupNavigator\");\n\n    constructor(private _settings: UserManagerSettingsStore) {}\n\n    public async prepare({\n        popupWindowFeatures = this._settings.popupWindowFeatures,\n        popupWindowTarget = this._settings.popupWindowTarget,\n    }: PopupWindowParams): Promise<PopupWindow> {\n        return new PopupWindow({ popupWindowFeatures, popupWindowTarget });\n    }\n\n    public async callback(url: string, keepOpen = false): Promise<void> {\n        this._logger.create(\"callback\");\n\n        PopupWindow.notifyOpener(url, keepOpen);\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"../utils\";\nimport type { UserManagerSettingsStore } from \"../UserManagerSettings\";\nimport type { INavigator } from \"./INavigator\";\nimport type { IWindow } from \"./IWindow\";\n\n/**\n * @public\n */\nexport interface RedirectParams {\n    redirectMethod?: \"replace\" | \"assign\";\n    redirectTarget?: \"top\" | \"self\";\n}\n\n/**\n * @internal\n */\nexport class RedirectNavigator implements INavigator {\n    private readonly _logger = new Logger(\"RedirectNavigator\");\n\n    constructor(private _settings: UserManagerSettingsStore) {}\n\n    public async prepare({\n        redirectMethod = this._settings.redirectMethod,\n        redirectTarget = this._settings.redirectTarget,\n    }: RedirectParams): Promise<IWindow> {\n        this._logger.create(\"prepare\");\n        let targetWindow = window.self as Window;\n\n        if (redirectTarget === \"top\") {\n            targetWindow = window.top ?? window.self;\n        }\n    \n        const redirect = targetWindow.location[redirectMethod].bind(targetWindow.location) as (url: string) => never;\n        let abort: (reason: Error) => void;\n        return {\n            navigate: async (params): Promise<never> => {\n                this._logger.create(\"navigate\");\n                // We use a promise that never resolves to block the caller\n                const promise = new Promise((resolve, reject) => {\n                    abort = reject;\n                });\n                redirect(params.url);\n                return await (promise as Promise<never>);\n            },\n            close: () => {\n                this._logger.create(\"close\");\n                abort?.(new Error(\"Redirect aborted\"));\n                targetWindow.stop();\n            },\n        };\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, Event } from \"./utils\";\nimport { AccessTokenEvents } from \"./AccessTokenEvents\";\nimport type { UserManagerSettingsStore } from \"./UserManagerSettings\";\nimport type { User } from \"./User\";\n\n/**\n * @public\n */\nexport type UserLoadedCallback = (user: User) => Promise<void> | void;\n/**\n * @public\n */\nexport type UserUnloadedCallback = () => Promise<void> | void;\n/**\n * @public\n */\nexport type SilentRenewErrorCallback = (error: Error) => Promise<void> | void;\n/**\n * @public\n */\nexport type UserSignedInCallback = () => Promise<void> | void;\n/**\n * @public\n */\nexport type UserSignedOutCallback = () => Promise<void> | void;\n/**\n * @public\n */\nexport type UserSessionChangedCallback = () => Promise<void> | void;\n\n/**\n * @public\n */\nexport class UserManagerEvents extends AccessTokenEvents {\n    protected readonly _logger = new Logger(\"UserManagerEvents\");\n\n    private readonly _userLoaded = new Event<[User]>(\"User loaded\");\n    private readonly _userUnloaded = new Event<[]>(\"User unloaded\");\n    private readonly _silentRenewError = new Event<[Error]>(\"Silent renew error\");\n    private readonly _userSignedIn = new Event<[]>(\"User signed in\");\n    private readonly _userSignedOut = new Event<[]>(\"User signed out\");\n    private readonly _userSessionChanged = new Event<[]>(\"User session changed\");\n\n    public constructor(settings: UserManagerSettingsStore) {\n        super({ expiringNotificationTimeInSeconds: settings.accessTokenExpiringNotificationTimeInSeconds });\n    }\n\n    public load(user: User, raiseEvent=true): void {\n        super.load(user);\n        if (raiseEvent) {\n            this._userLoaded.raise(user);\n        }\n    }\n    public unload(): void {\n        super.unload();\n        this._userUnloaded.raise();\n    }\n\n    /**\n     * Add callback: Raised when a user session has been established (or re-established).\n     */\n    public addUserLoaded(cb: UserLoadedCallback): () => void {\n        return this._userLoaded.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when a user session has been established (or re-established).\n     */\n    public removeUserLoaded(cb: UserLoadedCallback): void {\n        return this._userLoaded.removeHandler(cb);\n    }\n\n    /**\n     * Add callback: Raised when a user session has been terminated.\n     */\n    public addUserUnloaded(cb: UserUnloadedCallback): () => void {\n        return this._userUnloaded.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when a user session has been terminated.\n     */\n    public removeUserUnloaded(cb: UserUnloadedCallback): void {\n        return this._userUnloaded.removeHandler(cb);\n    }\n\n    /**\n     * Add callback: Raised when the automatic silent renew has failed.\n     */\n    public addSilentRenewError(cb: SilentRenewErrorCallback): () => void {\n        return this._silentRenewError.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the automatic silent renew has failed.\n     */\n    public removeSilentRenewError(cb: SilentRenewErrorCallback): void {\n        return this._silentRenewError.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n    public _raiseSilentRenewError(e: Error): void {\n        this._silentRenewError.raise(e);\n    }\n\n    /**\n     * Add callback: Raised when the user is signed in (when `monitorSession` is set).\n     * @see {@link UserManagerSettings.monitorSession}\n     */\n    public addUserSignedIn(cb: UserSignedInCallback): () => void {\n        return this._userSignedIn.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the user is signed in (when `monitorSession` is set).\n     */\n    public removeUserSignedIn(cb: UserSignedInCallback): void {\n        this._userSignedIn.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n    public _raiseUserSignedIn(): void {\n        this._userSignedIn.raise();\n    }\n\n    /**\n     * Add callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n     * @see {@link UserManagerSettings.monitorSession}\n     */\n    public addUserSignedOut(cb: UserSignedOutCallback): () => void {\n        return this._userSignedOut.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the user's sign-in status at the OP has changed (when `monitorSession` is set).\n     */\n    public removeUserSignedOut(cb: UserSignedOutCallback): void {\n        this._userSignedOut.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n    public _raiseUserSignedOut(): void {\n        this._userSignedOut.raise();\n    }\n\n    /**\n     * Add callback: Raised when the user session changed (when `monitorSession` is set).\n     * @see {@link UserManagerSettings.monitorSession}\n     */\n    public addUserSessionChanged(cb: UserSessionChangedCallback): () => void {\n        return this._userSessionChanged.addHandler(cb);\n    }\n    /**\n     * Remove callback: Raised when the user session changed (when `monitorSession` is set).\n     */\n    public removeUserSessionChanged(cb: UserSessionChangedCallback): void {\n        this._userSessionChanged.removeHandler(cb);\n    }\n    /**\n     * @internal\n     */\n    public _raiseUserSessionChanged(): void {\n        this._userSessionChanged.raise();\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger, Timer } from \"./utils\";\nimport { ErrorTimeout } from \"./errors\";\nimport type { UserManager } from \"./UserManager\";\nimport type { AccessTokenCallback } from \"./AccessTokenEvents\";\n\n/**\n * @internal\n */\nexport class SilentRenewService {\n    protected _logger = new Logger(\"SilentRenewService\");\n    private _isStarted = false;\n    private readonly _retryTimer = new Timer(\"Retry Silent Renew\");\n\n    public constructor(private _userManager: UserManager) {}\n\n    public async start(): Promise<void> {\n        const logger = this._logger.create(\"start\");\n        if (!this._isStarted) {\n            this._isStarted = true;\n            this._userManager.events.addAccessTokenExpiring(this._tokenExpiring);\n            this._retryTimer.addHandler(this._tokenExpiring);\n\n            // this will trigger loading of the user so the expiring events can be initialized\n            try {\n                await this._userManager.getUser();\n                // deliberate nop\n            }\n            catch (err) {\n                // catch to suppress errors since we're in a ctor\n                logger.error(\"getUser error\", err);\n            }\n        }\n    }\n\n    public stop(): void {\n        if (this._isStarted) {\n            this._retryTimer.cancel();\n            this._retryTimer.removeHandler(this._tokenExpiring);\n            this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring);\n            this._isStarted = false;\n        }\n    }\n\n    protected _tokenExpiring: AccessTokenCallback = async () => {\n        const logger = this._logger.create(\"_tokenExpiring\");\n        try {\n            await this._userManager.signinSilent();\n            logger.debug(\"silent token renewal successful\");\n        }\n        catch (err) {\n            if (err instanceof ErrorTimeout) {\n                // no response from authority server, e.g. IFrame timeout, ...\n                logger.warn(\"ErrorTimeout from signinSilent:\", err, \"retry in 5s\");\n                this._retryTimer.init(5);\n                return;\n            }\n\n            logger.error(\"Error from signinSilent:\", err);\n            this._userManager.events._raiseSilentRenewError(err as Error);\n        }\n    };\n}\n","// Copyright (C) AuthTS Contributors\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport type { UserProfile } from \"./User\";\n\n/**\n * Fake state store implementation necessary for validating refresh token requests.\n *\n * @internal\n */\nexport class RefreshState {\n    /** custom \"state\", which can be used by a caller to have \"data\" round tripped */\n    public readonly data: unknown | undefined;\n\n    public readonly refresh_token: string;\n    public readonly id_token?: string;\n    public readonly session_state: string | null;\n    public readonly scope?: string;\n    public readonly profile: UserProfile;\n\n    constructor(args: {\n        refresh_token: string;\n        id_token?: string;\n        session_state: string | null;\n        scope?: string;\n        profile: UserProfile;\n\n        state?: unknown;\n    }) {\n        this.refresh_token = args.refresh_token;\n        this.id_token = args.id_token;\n        this.session_state = args.session_state;\n        this.scope = args.scope;\n        this.profile = args.profile;\n\n        this.data = args.state;\n    }\n}\n","// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\n\nimport { Logger } from \"./utils\";\nimport { ErrorResponse } from \"./errors\";\nimport { IFrameNavigator, NavigateResponse, PopupNavigator, RedirectNavigator, PopupWindowParams,\n    IWindow, IFrameWindowParams, RedirectParams } from \"./navigators\";\nimport { OidcClient, CreateSigninRequestArgs, CreateSignoutRequestArgs, ProcessResourceOwnerPasswordCredentialsArgs } from \"./OidcClient\";\nimport { UserManagerSettings, UserManagerSettingsStore } from \"./UserManagerSettings\";\nimport { User } from \"./User\";\nimport { UserManagerEvents } from \"./UserManagerEvents\";\nimport { SilentRenewService } from \"./SilentRenewService\";\nimport { SessionMonitor } from \"./SessionMonitor\";\nimport type { SessionStatus } from \"./SessionStatus\";\nimport type { SignoutResponse } from \"./SignoutResponse\";\nimport type { MetadataService } from \"./MetadataService\";\nimport { RefreshState } from \"./RefreshState\";\nimport type { SigninResponse } from \"./SigninResponse\";\n\n/**\n * @public\n */\nexport type ExtraSigninRequestArgs = Pick<CreateSigninRequestArgs, \"nonce\" | \"extraQueryParams\" | \"extraTokenParams\" | \"state\" | \"redirect_uri\" | \"prompt\" | \"acr_values\">;\n/**\n * @public\n */\nexport type ExtraSignoutRequestArgs = Pick<CreateSignoutRequestArgs, \"extraQueryParams\" | \"state\" | \"id_token_hint\" | \"post_logout_redirect_uri\">;\n\n/**\n * @public\n */\nexport type RevokeTokensTypes = UserManagerSettings[\"revokeTokenTypes\"];\n\n/**\n * @public\n */\nexport type SigninRedirectArgs = RedirectParams & ExtraSigninRequestArgs;\n\n/**\n * @public\n */\nexport type SigninPopupArgs = PopupWindowParams & ExtraSigninRequestArgs;\n\n/**\n * @public\n */\nexport type SigninSilentArgs = IFrameWindowParams & ExtraSigninRequestArgs;\n\n/**\n * @public\n */\nexport type SigninResourceOwnerCredentialsArgs = ProcessResourceOwnerPasswordCredentialsArgs;\n\n/**\n * @public\n */\nexport type QuerySessionStatusArgs = IFrameWindowParams & ExtraSigninRequestArgs;\n\n/**\n * @public\n */\nexport type SignoutRedirectArgs = RedirectParams & ExtraSignoutRequestArgs;\n\n/**\n * @public\n */\nexport type SignoutPopupArgs = PopupWindowParams & ExtraSignoutRequestArgs;\n\n/**\n * @public\n */\nexport type SignoutSilentArgs = IFrameWindowParams & ExtraSignoutRequestArgs;\n\n/**\n * Provides a higher level API for signing a user in, signing out, managing the user's claims returned from the OIDC provider,\n * and managing an access token returned from the OIDC/OAuth2 provider.\n *\n * @public\n */\nexport class UserManager {\n    /** Returns the settings used to configure the `UserManager`. */\n    public readonly settings: UserManagerSettingsStore;\n    protected readonly _logger = new Logger(\"UserManager\");\n\n    protected readonly _client: OidcClient;\n    protected readonly _redirectNavigator: RedirectNavigator;\n    protected readonly _popupNavigator: PopupNavigator;\n    protected readonly _iframeNavigator: IFrameNavigator;\n    protected readonly _events: UserManagerEvents;\n    protected readonly _silentRenewService: SilentRenewService;\n    protected readonly _sessionMonitor: SessionMonitor | null;\n\n    public constructor(settings: UserManagerSettings) {\n        this.settings = new UserManagerSettingsStore(settings);\n\n        this._client = new OidcClient(settings);\n\n        this._redirectNavigator = new RedirectNavigator(this.settings);\n        this._popupNavigator = new PopupNavigator(this.settings);\n        this._iframeNavigator = new IFrameNavigator(this.settings);\n\n        this._events = new UserManagerEvents(this.settings);\n        this._silentRenewService = new SilentRenewService(this);\n\n        // order is important for the following properties; these services depend upon the events.\n        if (this.settings.automaticSilentRenew) {\n            this.startSilentRenew();\n        }\n\n        this._sessionMonitor = null;\n        if (this.settings.monitorSession) {\n            this._sessionMonitor = new SessionMonitor(this);\n        }\n\n    }\n\n    /** Returns an object used to register for events raised by the `UserManager`. */\n    public get events(): UserManagerEvents {\n        return this._events;\n    }\n\n    /** Returns an object used to access the metadata configuration of the OIDC provider. */\n    public get metadataService(): MetadataService {\n        return this._client.metadataService;\n    }\n\n    /**\n     * Returns promise to load the `User` object for the currently authenticated user.\n     */\n    public async getUser(): Promise<User | null> {\n        const logger = this._logger.create(\"getUser\");\n        const user = await this._loadUser();\n        if (user) {\n            logger.info(\"user loaded\");\n            this._events.load(user, false);\n            return user;\n        }\n\n        logger.info(\"user not found in storage\");\n        return null;\n    }\n\n    /**\n     * Returns promise to remove from any storage the currently authenticated user.\n     */\n    public async removeUser(): Promise<void> {\n        const logger = this._logger.create(\"removeUser\");\n        await this.storeUser(null);\n        logger.info(\"user removed from storage\");\n        this._events.unload();\n    }\n\n    /**\n     * Returns promise to trigger a redirect of the current window to the authorization endpoint.\n     */\n    public async signinRedirect(args: SigninRedirectArgs = {}): Promise<void> {\n        this._logger.create(\"signinRedirect\");\n        const {\n            redirectMethod,\n            ...requestArgs\n        } = args;\n        const handle = await this._redirectNavigator.prepare({ redirectMethod });\n        await this._signinStart({\n            request_type: \"si:r\",\n            ...requestArgs,\n        }, handle);\n    }\n\n    /**\n     * Returns promise to process response from the authorization endpoint. The result of the promise is the authenticated `User`.\n     */\n    public async signinRedirectCallback(url = window.location.href): Promise<User> {\n        const logger = this._logger.create(\"signinRedirectCallback\");\n        const user = await this._signinEnd(url);\n        if (user.profile && user.profile.sub) {\n            logger.info(\"success, signed in subject\", user.profile.sub);\n        }\n        else {\n            logger.info(\"no subject\");\n        }\n\n        return user;\n    }\n\n    /**\n     * Returns promise to process the signin with user/password. The result of the promise is the authenticated `User`.\n     *\n     * Throws an ErrorResponse in case of wrong authentication.\n     */\n    public async signinResourceOwnerCredentials({\n        username,\n        password,\n        skipUserInfo = false,\n    }: SigninResourceOwnerCredentialsArgs ) {\n        const logger = this._logger.create(\"signinResourceOwnerCredential\");\n\n        const signinResponse = await this._client.processResourceOwnerPasswordCredentials({ username, password, skipUserInfo, extraTokenParams: this.settings.extraTokenParams });\n        logger.debug(\"got signin response\");\n\n        const user = await this._buildUser(signinResponse);\n        if (user.profile && user.profile.sub) {\n            logger.info(\"success, signed in subject\", user.profile.sub);\n        } else {\n            logger.info(\"no subject\");\n        }\n        return user;\n    }\n\n    /**\n     * Returns promise to trigger a request (via a popup window) to the authorization endpoint. The result of the promise is the authenticated `User`.\n     */\n    public async signinPopup(args: SigninPopupArgs = {}): Promise<User> {\n        const logger = this._logger.create(\"signinPopup\");\n        const {\n            popupWindowFeatures,\n            popupWindowTarget,\n            ...requestArgs\n        } = args;\n        const url = this.settings.popup_redirect_uri;\n        if (!url) {\n            logger.throw(new Error(\"No popup_redirect_uri configured\"));\n        }\n\n        const handle = await this._popupNavigator.prepare({ popupWindowFeatures, popupWindowTarget });\n        const user = await this._signin({\n            request_type: \"si:p\",\n            redirect_uri: url,\n            display: \"popup\",\n            ...requestArgs,\n        }, handle);\n        if (user) {\n            if (user.profile && user.profile.sub) {\n                logger.info(\"success, signed in subject\", user.profile.sub);\n            }\n            else {\n                logger.info(\"no subject\");\n            }\n        }\n\n        return user;\n    }\n    /**\n     * Returns promise to notify the opening window of response from the authorization endpoint.\n     */\n    public async signinPopupCallback(url = window.location.href, keepOpen = false): Promise<void> {\n        const logger = this._logger.create(\"signinPopupCallback\");\n        await this._popupNavigator.callback(url, keepOpen);\n        logger.info(\"success\");\n    }\n\n    /**\n     * Returns promise to trigger a silent request (via an iframe) to the authorization endpoint.\n     * The result of the promise is the authenticated `User`.\n     */\n    public async signinSilent(args: SigninSilentArgs = {}): Promise<User | null> {\n        const logger = this._logger.create(\"signinSilent\");\n        const {\n            silentRequestTimeoutInSeconds,\n            ...requestArgs\n        } = args;\n        // first determine if we have a refresh token, or need to use iframe\n        let user = await this._loadUser();\n        if (user?.refresh_token) {\n            logger.debug(\"using refresh token\");\n            const state = new RefreshState(user as Required<User>);\n            return await this._useRefreshToken(state);\n        }\n\n        const url = this.settings.silent_redirect_uri;\n        if (!url) {\n            logger.throw(new Error(\"No silent_redirect_uri configured\"));\n        }\n\n        let verifySub: string | undefined;\n        if (user && this.settings.validateSubOnSilentRenew) {\n            logger.debug(\"subject prior to silent renew:\", user.profile.sub);\n            verifySub = user.profile.sub;\n        }\n\n        const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n        user = await this._signin({\n            request_type: \"si:s\",\n            redirect_uri: url,\n            prompt: \"none\",\n            id_token_hint: this.settings.includeIdTokenInSilentRenew ? user?.id_token : undefined,\n            ...requestArgs,\n        }, handle, verifySub);\n        if (user) {\n            if (user.profile?.sub) {\n                logger.info(\"success, signed in subject\", user.profile.sub);\n            }\n            else {\n                logger.info(\"no subject\");\n            }\n        }\n\n        return user;\n    }\n\n    protected async _useRefreshToken(state: RefreshState): Promise<User> {\n        const response = await this._client.useRefreshToken({\n            state,\n            timeoutInSeconds: this.settings.silentRequestTimeoutInSeconds,\n        });\n        const user = new User({ ...state, ...response });\n\n        await this.storeUser(user);\n        this._events.load(user);\n        return user;\n    }\n\n    /**\n     * Returns promise to notify the parent window of response from the authorization endpoint.\n     */\n    public async signinSilentCallback(url = window.location.href): Promise<void> {\n        const logger = this._logger.create(\"signinSilentCallback\");\n        await this._iframeNavigator.callback(url);\n        logger.info(\"success\");\n    }\n\n    public async signinCallback(url = window.location.href): Promise<User | void> {\n        const { state } = await this._client.readSigninResponseState(url);\n        switch (state.request_type) {\n            case \"si:r\":\n                return await this.signinRedirectCallback(url);\n            case \"si:p\":\n                return await this.signinPopupCallback(url);\n            case \"si:s\":\n                return await this.signinSilentCallback(url);\n            default:\n                throw new Error(\"invalid response_type in state\");\n        }\n    }\n\n    public async signoutCallback(url = window.location.href, keepOpen = false): Promise<void> {\n        const { state } = await this._client.readSignoutResponseState(url);\n        if (!state) {\n            return;\n        }\n\n        switch (state.request_type) {\n            case \"so:r\":\n                await this.signoutRedirectCallback(url);\n                break;\n            case \"so:p\":\n                await this.signoutPopupCallback(url, keepOpen);\n                break;\n            case \"so:s\":\n                await this.signoutSilentCallback(url);\n                break;\n            default:\n                throw new Error(\"invalid response_type in state\");\n        }\n    }\n\n    /**\n     * Returns promise to query OP for user's current signin status. Returns object with session_state and subject identifier.\n     */\n    public async querySessionStatus(args: QuerySessionStatusArgs = {}): Promise<SessionStatus | null> {\n        const logger = this._logger.create(\"querySessionStatus\");\n        const {\n            silentRequestTimeoutInSeconds,\n            ...requestArgs\n        } = args;\n        const url = this.settings.silent_redirect_uri;\n        if (!url) {\n            logger.throw(new Error(\"No silent_redirect_uri configured\"));\n        }\n\n        const user = await this._loadUser();\n        const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n        const navResponse = await this._signinStart({\n            request_type: \"si:s\", // this acts like a signin silent\n            redirect_uri: url,\n            prompt: \"none\",\n            id_token_hint: this.settings.includeIdTokenInSilentRenew ? user?.id_token : undefined,\n            response_type: this.settings.query_status_response_type,\n            scope: \"openid\",\n            skipUserInfo: true,\n            ...requestArgs,\n        }, handle);\n        try {\n            const signinResponse = await this._client.processSigninResponse(navResponse.url);\n            logger.debug(\"got signin response\");\n\n            if (signinResponse.session_state && signinResponse.profile.sub) {\n                logger.info(\"success for subject\", signinResponse.profile.sub);\n                return {\n                    session_state: signinResponse.session_state,\n                    sub: signinResponse.profile.sub,\n                    sid: signinResponse.profile.sid,\n                };\n            }\n\n            logger.info(\"success, user not authenticated\");\n            return null;\n        }\n        catch (err) {\n            if (this.settings.monitorAnonymousSession && err instanceof ErrorResponse) {\n                switch (err.error) {\n                    case \"login_required\":\n                    case \"consent_required\":\n                    case \"interaction_required\":\n                    case \"account_selection_required\":\n                        logger.info(\"success for anonymous user\");\n                        return {\n                            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                            session_state: err.session_state!,\n                        };\n                }\n            }\n            throw err;\n        }\n    }\n\n    protected async _signin(args: CreateSigninRequestArgs, handle: IWindow, verifySub?: string): Promise<User> {\n        const navResponse = await this._signinStart(args, handle);\n        return await this._signinEnd(navResponse.url, verifySub);\n    }\n    protected async _signinStart(args: CreateSigninRequestArgs, handle: IWindow): Promise<NavigateResponse> {\n        const logger = this._logger.create(\"_signinStart\");\n\n        try {\n            const signinRequest = await this._client.createSigninRequest(args);\n            logger.debug(\"got signin request\");\n\n            return await handle.navigate({\n                url: signinRequest.url,\n                state: signinRequest.state.id,\n                response_mode: signinRequest.state.response_mode,\n                scriptOrigin: this.settings.iframeScriptOrigin,\n            });\n        }\n        catch (err) {\n            logger.debug(\"error after preparing navigator, closing navigator window\");\n            handle.close();\n            throw err;\n        }\n    }\n    protected async _signinEnd(url: string, verifySub?: string): Promise<User> {\n        const logger = this._logger.create(\"_signinEnd\");\n        const signinResponse = await this._client.processSigninResponse(url);\n        logger.debug(\"got signin response\");\n\n        const user = await this._buildUser(signinResponse, verifySub);\n        return user;\n    }\n\n    protected async _buildUser(signinResponse: SigninResponse, verifySub?: string) {\n        const logger = this._logger.create(\"_buildUser\");\n        const user = new User(signinResponse);\n        if (verifySub) {\n            if (verifySub !== user.profile.sub) {\n                logger.debug(\"current user does not match user returned from signin. sub from signin:\", user.profile.sub);\n                throw new ErrorResponse({ ...signinResponse, error: \"login_required\" });\n            }\n            logger.debug(\"current user matches user returned from signin\");\n        }\n\n        await this.storeUser(user);\n        logger.debug(\"user stored\");\n        this._events.load(user);\n\n        return user;\n    }\n\n    /**\n     * Returns promise to trigger a redirect of the current window to the end session endpoint.\n     */\n    public async signoutRedirect(args: SignoutRedirectArgs = {}): Promise<void> {\n        const logger = this._logger.create(\"signoutRedirect\");\n        const {\n            redirectMethod,\n            ...requestArgs\n        } = args;\n        const handle = await this._redirectNavigator.prepare({ redirectMethod });\n        await this._signoutStart({\n            request_type: \"so:r\",\n            post_logout_redirect_uri: this.settings.post_logout_redirect_uri,\n            ...requestArgs,\n        }, handle);\n        logger.info(\"success\");\n    }\n\n    /**\n     * Returns promise to process response from the end session endpoint.\n     */\n    public async signoutRedirectCallback(url = window.location.href): Promise<SignoutResponse> {\n        const logger = this._logger.create(\"signoutRedirectCallback\");\n        const response = await this._signoutEnd(url);\n        logger.info(\"success\");\n        return response;\n    }\n\n    /**\n     * Returns promise to trigger a redirect of a popup window window to the end session endpoint.\n     */\n    public async signoutPopup(args: SignoutPopupArgs = {}): Promise<void> {\n        const logger = this._logger.create(\"signoutPopup\");\n        const {\n            popupWindowFeatures,\n            popupWindowTarget,\n            ...requestArgs\n        } = args;\n        const url = this.settings.popup_post_logout_redirect_uri;\n\n        const handle = await this._popupNavigator.prepare({ popupWindowFeatures, popupWindowTarget });\n        await this._signout({\n            request_type: \"so:p\",\n            post_logout_redirect_uri: url,\n            // we're putting a dummy entry in here because we\n            // need a unique id from the state for notification\n            // to the parent window, which is necessary if we\n            // plan to return back to the client after signout\n            // and so we can close the popup after signout\n            state: url == null ? undefined : {},\n            ...requestArgs,\n        }, handle);\n        logger.info(\"success\");\n    }\n\n    /**\n     * Returns promise to process response from the end session endpoint from a popup window.\n     */\n    public async signoutPopupCallback(url = window.location.href, keepOpen = false): Promise<void> {\n        const logger = this._logger.create(\"signoutPopupCallback\");\n        await this._popupNavigator.callback(url, keepOpen);\n        logger.info(\"success\");\n    }\n\n    protected async _signout(args: CreateSignoutRequestArgs, handle: IWindow): Promise<SignoutResponse> {\n        const navResponse = await this._signoutStart(args, handle);\n        return await this._signoutEnd(navResponse.url);\n    }\n    protected async _signoutStart(args: CreateSignoutRequestArgs = {}, handle: IWindow): Promise<NavigateResponse> {\n        const logger = this._logger.create(\"_signoutStart\");\n\n        try {\n            const user = await this._loadUser();\n            logger.debug(\"loaded current user from storage\");\n\n            if (this.settings.revokeTokensOnSignout) {\n                await this._revokeInternal(user);\n            }\n\n            const id_token = args.id_token_hint || user && user.id_token;\n            if (id_token) {\n                logger.debug(\"setting id_token_hint in signout request\");\n                args.id_token_hint = id_token;\n            }\n\n            await this.removeUser();\n            logger.debug(\"user removed, creating signout request\");\n\n            const signoutRequest = await this._client.createSignoutRequest(args);\n            logger.debug(\"got signout request\");\n\n            return await handle.navigate({\n                url: signoutRequest.url,\n                state: signoutRequest.state?.id,\n            });\n        }\n        catch (err) {\n            logger.debug(\"error after preparing navigator, closing navigator window\");\n            handle.close();\n            throw err;\n        }\n    }\n    protected async _signoutEnd(url: string): Promise<SignoutResponse> {\n        const logger = this._logger.create(\"_signoutEnd\");\n        const signoutResponse = await this._client.processSignoutResponse(url);\n        logger.debug(\"got signout response\");\n\n        return signoutResponse;\n    }\n\n    /**\n     * Returns promise to trigger a silent request (via an iframe) to the end session endpoint.\n     */\n    public async signoutSilent(args: SignoutSilentArgs = {}): Promise<void> {\n        const logger = this._logger.create(\"signoutSilent\");\n        const {\n            silentRequestTimeoutInSeconds,\n            ...requestArgs\n        } = args;\n\n        const id_token_hint = this.settings.includeIdTokenInSilentSignout\n            ? (await this._loadUser())?.id_token\n            : undefined;\n\n        const url = this.settings.popup_post_logout_redirect_uri;\n        const handle = await this._iframeNavigator.prepare({ silentRequestTimeoutInSeconds });\n        await this._signout({\n            request_type: \"so:s\",\n            post_logout_redirect_uri: url,\n            id_token_hint: id_token_hint,\n            ...requestArgs,\n        }, handle);\n\n        logger.info(\"success\");\n    }\n\n    /**\n     * Returns promise to notify the parent window of response from the end session endpoint.\n     */\n    public async signoutSilentCallback(url = window.location.href): Promise<void> {\n        const logger = this._logger.create(\"signoutSilentCallback\");\n        await this._iframeNavigator.callback(url);\n        logger.info(\"success\");\n    }\n\n    public async revokeTokens(types?: RevokeTokensTypes): Promise<void> {\n        const user = await this._loadUser();\n        await this._revokeInternal(user, types);\n    }\n\n    protected async _revokeInternal(user: User | null, types = this.settings.revokeTokenTypes): Promise<void> {\n        const logger = this._logger.create(\"_revokeInternal\");\n        if (!user) return;\n\n        const typesPresent = types.filter(type => typeof user[type] === \"string\");\n\n        if (!typesPresent.length) {\n            logger.debug(\"no need to revoke due to no token(s)\");\n            return;\n        }\n\n        // don't Promise.all, order matters\n        for (const type of typesPresent) {\n            await this._client.revokeToken(\n                user[type]!, // eslint-disable-line @typescript-eslint/no-non-null-assertion\n                type,\n            );\n            logger.info(`${type} revoked successfully`);\n            if (type !== \"access_token\") {\n                user[type] = null as never;\n            }\n        }\n\n        await this.storeUser(user);\n        logger.debug(\"user stored\");\n        this._events.load(user);\n    }\n\n    /**\n     * Enables silent renew for the `UserManager`.\n     */\n    public startSilentRenew(): void {\n        this._logger.create(\"startSilentRenew\");\n        void this._silentRenewService.start();\n    }\n\n    /**\n     * Disables silent renew for the `UserManager`.\n     */\n    public stopSilentRenew(): void {\n        this._silentRenewService.stop();\n    }\n\n    protected get _userStoreKey(): string {\n        return `user:${this.settings.authority}:${this.settings.client_id}`;\n    }\n\n    protected async _loadUser(): Promise<User | null> {\n        const logger = this._logger.create(\"_loadUser\");\n        const storageString = await this.settings.userStore.get(this._userStoreKey);\n        if (storageString) {\n            logger.debug(\"user storageString loaded\");\n            return User.fromStorageString(storageString);\n        }\n\n        logger.debug(\"no user storageString\");\n        return null;\n    }\n\n    public async storeUser(user: User | null): Promise<void> {\n        const logger = this._logger.create(\"storeUser\");\n        if (user) {\n            logger.debug(\"storing user\");\n            const storageString = user.toStorageString();\n            await this.settings.userStore.set(this._userStoreKey, storageString);\n        }\n        else {\n            this._logger.debug(\"removing user\");\n            await this.settings.userStore.remove(this._userStoreKey);\n        }\n    }\n\n    /**\n     * Removes stale state entries in storage for incomplete authorize requests.\n     */\n    public async clearStaleState(): Promise<void> {\n        await this._client.clearStaleState();\n    }\n}\n","{\n  \"name\": \"oidc-client-ts\",\n  \"version\": \"2.2.1\",\n  \"description\": \"OpenID Connect (OIDC) & OAuth2 client library\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com:authts/oidc-client-ts.git\"\n  },\n  \"homepage\": \"https://github.com/authts/oidc-client-ts#readme\",\n  \"license\": \"Apache-2.0\",\n  \"main\": \"dist/umd/oidc-client-ts.js\",\n  \"types\": \"dist/types/oidc-client-ts.d.ts\",\n  \"exports\": {\n    \".\": {\n      \"types\": \"./dist/types/oidc-client-ts.d.ts\",\n      \"import\": \"./dist/esm/oidc-client-ts.js\",\n      \"require\": \"./dist/umd/oidc-client-ts.js\"\n    },\n    \"./package.json\": \"./package.json\"\n  },\n  \"files\": [\n    \"dist\"\n  ],\n  \"keywords\": [\n    \"authentication\",\n    \"oauth2\",\n    \"oidc\",\n    \"openid\",\n    \"OpenID Connect\"\n  ],\n  \"scripts\": {\n    \"build\": \"node scripts/build.js && npm run build-types\",\n    \"build-types\": \"tsc -p tsconfig.build.json && api-extractor run\",\n    \"clean\": \"git clean -fdX dist lib *.tsbuildinfo\",\n    \"prepack\": \"npm run build\",\n    \"test\": \"tsc && jest\",\n    \"typedoc\": \"typedoc\",\n    \"lint\": \"eslint --max-warnings=0 --cache .\",\n    \"prepare\": \"husky install\"\n  },\n  \"dependencies\": {\n    \"crypto-js\": \"^4.1.1\",\n    \"jwt-decode\": \"^3.1.2\"\n  },\n  \"devDependencies\": {\n    \"@microsoft/api-extractor\": \"^7.18.10\",\n    \"@testing-library/jest-dom\": \"^5.16.5\",\n    \"@types/crypto-js\": \"^4.0.2\",\n    \"@types/jest\": \"^29.2.3\",\n    \"@typescript-eslint/eslint-plugin\": \"^5.8.0\",\n    \"@typescript-eslint/parser\": \"^5.8.0\",\n    \"esbuild\": \"^0.17.0\",\n    \"eslint\": \"^8.5.0\",\n    \"eslint-plugin-testing-library\": \"^5.0.1\",\n    \"http-proxy-middleware\": \"^2.0.1\",\n    \"husky\": \"^8.0.1\",\n    \"jest\": \"^29.3.1\",\n    \"jest-environment-jsdom\": \"^29.3.1\",\n    \"jest-mock\": \"^29.3.1\",\n    \"lint-staged\": \"^13.0.0\",\n    \"ts-jest\": \"^29.0.3\",\n    \"typedoc\": \"^0.23.2\",\n    \"typescript\": \"~4.8.4\",\n    \"yn\": \"^5.0.0\"\n  },\n  \"engines\": {\n    \"node\": \">=12.13.0\"\n  },\n  \"lint-staged\": {\n    \"*.{js,jsx,ts,tsx}\": \"eslint --cache --fix\"\n  }\n}\n","// @ts-expect-error avoid enabling resolveJsonModule to keep build process simple\nimport { version } from \"../package.json\";\n\n/**\n * @public\n */\nexport const Version: string = version;\n"]},"metadata":{},"sourceType":"script"}